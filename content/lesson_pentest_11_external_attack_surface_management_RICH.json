{
  "lesson_id": "d7595278-8401-44bb-b56f-eacf27379fe4",
  "domain": "pentest",
  "title": "External Attack Surface Management Labs",
  "subtitle": "Shodan, Censys, and recon automation for responsible testing",
  "difficulty": 2,
  "estimated_time": 55,
  "order_index": 11,
  "prerequisites": [
    "Penetration Testing Methodology",
    "Reconnaissance Techniques"
  ],
  "concepts": [
    "Attack surface inventory",
    "Shodan and Censys querying",
    "Certificate transparency hunting",
    "Subdomain enumeration pipelines",
    "Asset tagging and ownership",
    "Risk scoring and prioritisation",
    "Responsible disclosure workflows",
    "Recon automation with Python and Bash",
    "Reporting to stakeholders",
    "Continuous monitoring integrations"
  ],
  "learning_objectives": [
    "Build repeatable attack surface discovery pipelines using public search engines",
    "Correlate certificate, DNS, and IP data to map external assets",
    "Prioritise findings based on exposure, business context, and risk",
    "Automate data collection while respecting legal and ethical boundaries",
    "Communicate findings through responsible disclosure channels",
    "Integrate attack surface monitoring into continuous penetration testing practice"
  ],
  "content_blocks": [
    {
      "block_id": "9b164659-bb33-4717-b9e6-72a0c9dde6e2",
      "type": "mindset_coach",
      "title": "Reconnaissance With Responsibility",
      "content": {
        "text": "Attack surface management is reconnaissance at scale. Your credibility depends on pairing automation with strict ethical guardrails."
      },
      "simplified_explanation": "Scale your recon, but keep ethics front and centre.",
      "memory_aids": [
        "Scale + ethics = trust"
      ],
      "real_world_connection": "Mature red teams enforce strict logging and approval before scanning production assets.",
      "reflection_prompt": "What approval process do you follow before starting external recon?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "ea456b46-0679-42d0-957d-3eb665886fcb",
      "type": "explanation",
      "title": "Discovery Pipeline",
      "content": {
        "text": "## M.A.P.S.\n- **M**ap domains and subdomains.\n- **A**nalyse certificates for additional hosts.\n- **P**robe with search engines (Shodan, Censys).\n- **S**core exposure for prioritisation."
      },
      "simplified_explanation": "MAPS keeps your attack surface workflow structured.",
      "memory_aids": [
        "Map → Analyse → Probe → Score"
      ],
      "real_world_connection": "Purple-team operations rely on MAPS-like pipelines to inform defenders.",
      "reflection_prompt": "Which MAPS step currently lacks automation in your toolkit?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "93642379-207e-4d44-8a7b-13863bd265d1",
      "type": "video",
      "title": "Shodan & Censys Recon Tutorial",
      "content": {
        "resources": "Learn how to pivot across Shodan, Censys, and certificate transparency data.\n\n**Video**: [Shodan for Ethical Hackers](https://www.youtube.com/watch?v=1hc3e8DqRL8)\n\nLog the query operators and API usage demonstrated."
      },
      "simplified_explanation": "Visualise the recon workflow before running it in your lab.",
      "memory_aids": [
        "Capture favourite queries in a cheatsheet"
      ],
      "real_world_connection": "This approach is common in OSINT-based pentests.",
      "reflection_prompt": "What query will you automate after the video?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "57639b84-7b7b-4ae4-85ff-1e18db322b57",
      "type": "memory_aid",
      "title": "SAFE-RECON",
      "content": {
        "text": "### S.A.F.E.-R.E.C.O.N.\n- **S**cope approvals logged.\n- **A**PI keys secured.\n- **F**requency limits respected.\n- **E**vidence stored securely.\n- **R**isk scoring rubric defined.\n- **E**scalation contacts listed.\n- **C**ompliance requirements documented.\n- **O**wnership identified for each asset.\n- **N**otify stakeholders promptly."
      },
      "simplified_explanation": "SAFE-RECON makes sure automation stays above board.",
      "memory_aids": [
        "Follow SAFE-RECON every run"
      ],
      "real_world_connection": "Consultancies use similar checklists to satisfy legal teams.",
      "reflection_prompt": "Which SAFE-RECON item needs improvement in your current process?",
      "is_interactive": false,
      "xp_reward": 5
    },
    {
      "block_id": "c09d2822-94b1-480b-a6a3-ad378704fbf8",
      "type": "real_world",
      "title": "Field Example: Shadow IT Discovery",
      "content": {
        "text": "A SaaS company used automated recon to discover forgotten VPN gateways. The findings triggered a responsible disclosure process internally, leading to quick decommissioning and improved asset tagging."
      },
      "simplified_explanation": "Recon exposed risk and improved asset management.",
      "memory_aids": [
        "Discovery → Disclosure → Decommission"
      ],
      "real_world_connection": "Scenario adapted from a public bug bounty post-mortem.",
      "reflection_prompt": "How will you ensure discovered assets reach the right owners quickly?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "7df76daa-7d24-4ea0-ab43-dda0d04e6185",
      "type": "simulation",
      "title": "Build an Attack Surface Pipeline",
      "content": {
        "text": "1. Choose a lab domain with permission (e.g., your own sandbox).\n2. Run MAPS: enumerate subdomains, check certificates, query Shodan/Censys.\n3. Score exposure based on service type, authentication, and data sensitivity.\n4. Draft a responsible disclosure report with remediation suggestions."
      },
      "simplified_explanation": "Practise the entire workflow from discovery to reporting.",
      "memory_aids": [
        "Discover → Score → Report"
      ],
      "real_world_connection": "External attack surface teams repeat this exercise weekly.",
      "reflection_prompt": "What automation or scripting will speed up this pipeline?",
      "is_interactive": true,
      "xp_reward": 25
    },
    {
      "block_id": "7df76daa-7d24-4ea0-ab43-dda0d04e6186",
      "type": "reflection",
      "title": "Teach Back the Recon",
      "content": {
        "text": "### Reflect & Teach\n- Present your findings to a stakeholder, emphasising SAFE-RECON.\n- List two metrics you will track (assets discovered, remediation rate).\n- Identify one integration (ticketing, SOAR, ASM platform) to pursue."
      },
      "simplified_explanation": "Teaching reinforces the pipeline and sets next steps.",
      "memory_aids": [
        "Explain → Measure → Integrate"
      ],
      "real_world_connection": "Attack surface teams report these metrics to risk committees.",
      "reflection_prompt": "Who needs to hear about your recon improvements this month?",
      "is_interactive": false,
      "xp_reward": 5
    }
  ],
  "pre_assessment": null,
  "post_assessment": [
    {
      "question_id": "q1",
      "type": "multiple_choice",
      "question": "Why is asset ownership critical during attack surface discovery?",
      "options": [
        "Ownership is optional if scans are automated",
        "It ensures findings reach responsible teams for remediation",
        "It allows unrestricted scanning without approvals",
        "It eliminates the need for reporting"
      ],
      "correct_answer": 1,
      "explanation": "Without ownership, discovered exposures may go unaddressed; ownership connects findings to remediation.",
      "difficulty": 2,
      "memory_aid": "Ownership drives action",
      "points": 10
    },
    {
      "question_id": "q2",
      "type": "multiple_choice",
      "question": "How do certificate transparency logs aid recon?",
      "options": [
        "They hide subdomains from attackers",
        "They reveal domains and subdomains covered by issued certificates",
        "They replace DNS records",
        "They only list expired certificates"
      ],
      "correct_answer": 1,
      "explanation": "Certificate transparency logs expose hostnames included in certificates, expanding discovery.",
      "difficulty": 2,
      "memory_aid": "Cert logs expose hidden hosts",
      "points": 10
    },
    {
      "question_id": "q3",
      "type": "multiple_choice",
      "question": "What is a key benefit of throttling automated recon requests?",
      "options": [
        "It guarantees faster results",
        "It prevents rate limits and respects provider usage policies",
        "It hides activity from stakeholders",
        "It reduces logging requirements"
      ],
      "correct_answer": 1,
      "explanation": "Throttling keeps automation compliant with provider terms and avoids blocking or legal issues.",
      "difficulty": 2,
      "memory_aid": "Throttle to stay compliant",
      "points": 10
    }
  ],
  "mastery_threshold": 80,
  "jim_kwik_principles": [
    "active_learning",
    "minimum_effective_dose",
    "teach_like_im_10",
    "memory_hooks",
    "meta_learning",
    "connect_to_what_i_know",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "base_xp_reward": 130,
  "badge_unlock": null,
  "is_core_concept": false,
  "created_at": "2025-10-28T15:44:00",
  "updated_at": "2025-10-28T15:44:00",
  "author": "CyberLearn Advanced Curriculum Team",
  "version": "2.1"
}
