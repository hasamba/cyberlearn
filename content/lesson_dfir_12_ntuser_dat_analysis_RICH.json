{
  "lesson_id": "4d11da99-62c8-4449-a205-875b9369421b",
  "domain": "dfir",
  "title": "NTUSER.DAT Analysis",
  "difficulty": 2,
  "order_index": 12,
  "prerequisites": [
    "93389b7b-e0c3-4d6b-9243-8ae49b8c509f"
  ],
  "concepts": [
    "User registry hive structure",
    "MRU (Most Recently Used) lists",
    "UserAssist analysis",
    "Typed paths and Run keys",
    "Registry timeline reconstruction"
  ],
  "estimated_time": 45,
  "learning_objectives": [
    "Understand the structure and forensic value of NTUSER.DAT hives",
    "Extract and analyze MRU lists to track user activity",
    "Decode UserAssist entries to identify program execution",
    "Correlate registry artifacts with other forensic evidence",
    "Build timelines from registry timestamps and transaction logs"
  ],
  "post_assessment": [
    {
      "question": "Which registry artifact provides ROT-13 encoded records of GUI program execution with timestamps and run counts?",
      "options": [
        "UserAssist under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist",
        "MRUList under HKCU\\Software\\Microsoft\\Windows\\Recent",
        "TypedPaths under HKCU\\Software\\Microsoft\\Windows\\Explorer\\TypedPaths",
        "Run keys under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
      ],
      "correct_answer": 0,
      "difficulty": 2,
      "type": "multiple_choice",
      "question_id": "3d397681-06fd-4b0b-89e2-69046f0627e3",
      "explanation": "UserAssist stores ROT-13 encoded GUIDs that track GUI application execution, including timestamps, run counts, and focus time. This is invaluable for proving what programs a user ran."
    },
    {
      "question": "An attacker deleted files after exfiltration. Which NTUSER.DAT artifact might still show the file paths they accessed?",
      "options": [
        "RecentDocs and OpenSaveMRU lists that cache recently accessed files",
        "Windows Defender exclusion lists",
        "Network adapter configuration settings",
        "Desktop wallpaper preferences"
      ],
      "correct_answer": 0,
      "difficulty": 2,
      "type": "multiple_choice",
      "question_id": "e24d03a8-887c-44a0-8882-938e6a9b2066",
      "explanation": "MRU (Most Recently Used) lists including RecentDocs and OpenSaveMRU preserve records of files the user accessed through Explorer or application dialogs, even after the files are deleted from disk."
    },
    {
      "question": "You find a suspicious executable in UserAssist but no matching Prefetch file. What's the most likely explanation?",
      "options": [
        "The executable was run from a network share or removable media (no Prefetch created)",
        "The executable deleted itself and all forensic traces",
        "UserAssist contains false positive entries",
        "Windows Defender quarantined the Prefetch file"
      ],
      "correct_answer": 0,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "07c817b8-7b08-490b-8a0c-17dcb2f62e18",
      "explanation": "Prefetch files are only created for executables run from local fixed disks. Programs executed from network shares, USB drives, or CD/DVD drives won't generate Prefetch but will still appear in UserAssist, creating this apparent discrepancy."
    }
  ],
  "jim_kwik_principles": [
    "teach_like_im_10",
    "memory_hooks",
    "connect_to_what_i_know",
    "active_learning",
    "meta_learning",
    "minimum_effective_dose",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "content_blocks": [
    {
      "type": "explanation",
      "content": {
        "text": "# NTUSER.DAT Analysis: Windows User Activity Goldmine\n\n### Why This Lesson Matters\n\nEvery Windows user leaves a detailed trail of their activity encoded in their personal registry hive: **NTUSER.DAT**. This file captures what programs they ran, which files they opened, what folders they browsed, what they typed into Explorer address bars, and much more. For incident responders investigating insider threats, malware infections, or unauthorized access, NTUSER.DAT is often the difference between **\"we think something happened\"** and **\"here's exactly what the attacker did, with timestamps.\"**\n\nUnlike event logs that can be cleared or Prefetch files that can be deleted, registry hives are locked while Windows runs, making them harder for attackers to manipulate without specialized tools. The hive also contains transaction logs (.LOG1, .LOG2) that provide additional forensic value even when the main hive appears corrupted.\n\n**Real-world impact**: The 2017 NotPetya investigation relied heavily on registry Run keys to reconstruct how the malware established persistence. The 2020 SolarWinds incident analysis used MRU lists to identify which administrators had accessed compromised systems. In ransomware cases, TypedPaths often reveals the network shares the attacker enumerated before deploying payloads.\n\n## Understanding NTUSER.DAT Structure\n\n**NTUSER.DAT** is the on-disk storage for the **HKEY_CURRENT_USER (HKCU)** registry hive. When a user logs in, Windows loads their NTUSER.DAT from `C:\\Users\\<username>\\NTUSER.DAT` and mounts it as HKCU. This hive contains:\n\n- **User preferences**: Desktop settings, application configurations, color schemes\n- **Program execution records**: UserAssist, MUICache, RecentApps\n- **File/folder access**: RecentDocs, OpenSaveMRU, TypedPaths, LastVisitedPidlMRU\n- **Persistence mechanisms**: Run keys, load keys, startup items\n- **Network activity**: Mapped drives, recent network locations\n- **Application-specific data**: Office recent files, Adobe preferences, browser settings\n\nEach user on the system has their own NTUSER.DAT, so on a server with 50 user profiles, you'll have 50 separate hives to analyze.\n\n### Transaction Logs: Your Backup Evidence\n\nWindows maintains **transaction logs** (NTUSER.DAT.LOG1 and NTUSER.DAT.LOG2) that store pending changes before they're committed to the main hive. These logs:\n\n- Provide **resilience against corruption** if the system crashes mid-write\n- May contain **recent activity** not yet flushed to the main hive\n- Can sometimes be **recovered** even when NTUSER.DAT is damaged\n- Show the **sequence of changes**, helping reconstruct attack timelines\n\nTools like Eric Zimmerman's **Registry Explorer** and Maxim Suhanov's **regipy** can parse transaction logs automatically, merging the data to give you the most complete picture.\n\n### Registry Timestamps: Understanding Last Write Time\n\nEvery registry key has a **LastWriteTime** timestamp showing when it was last modified. This is crucial for timeline analysis:\n\n```\nKey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nLastWriteTime: 2025-11-02 14:32:18 UTC\n```\n\nIf this Run key was modified at 14:32, that's when persistence was likely established. Correlate this with:\n\n- **Event logs** (4688 process creation around that time)\n- **Prefetch** (malware executable first run)\n- **SRUM** (network activity spike)\n- **File system timestamps** (malware file creation)\n\n**Important caveat**: Modifying ANY value under a key updates the key's LastWriteTime. If a key has 10 values and you change one, the entire key timestamp updates. This means you know *something* changed at that time, but not necessarily *which* value. Tools like RegRipper can help narrow this down by showing all values under the key.\n\n## Memory Aid: The NTUSER Treasure Map\n\nThink of NTUSER.DAT as a **treasure map** with five major landmarks:\n\n**M-U-R-P-T**:\n- **M**RU lists (Most Recently Used files and folders)\n- **U**serAssist (GUI program execution)\n- **R**un keys (persistence mechanisms)\n- **P**aths typed (Explorer address bar history)\n- **T**imestamps (last write times for timeline correlation)\n\nEach landmark reveals a different aspect of user behavior. MRU shows *what they accessed*. UserAssist shows *what they ran*. Run keys show *what persisted*. Typed paths show *where they navigated*. Timestamps show *when it all happened*.\n\n## Why Attackers Struggle to Hide from NTUSER.DAT\n\nSophisticated attackers know to clear event logs, delete Prefetch files, and timestomp executables. But NTUSER.DAT is harder to manipulate:\n\n1. **Locked during logon**: The hive is locked by the Windows kernel while the user is logged in, preventing deletion or wholesale replacement\n2. **Distributed across keys**: Activity is recorded in dozens of different registry paths (UserAssist, MRU, TypedPaths, etc.), making complete sanitization difficult\n3. **Transaction logs**: Even if an attacker modifies the main hive offline, transaction logs may preserve original data\n4. **System restore backups**: Windows keeps registry hive backups in System Restore points (`C:\\System Volume Information`) and RegBack (`C:\\Windows\\System32\\config\\RegBack`)\n\nAttackers who try to cover their tracks often make mistakes:\n- Deleting individual MRU entries creates **gaps in MRU numbering** (MRU list goes 0, 1, 3, 4 — where's 2?)\n- Clearing entire keys updates **LastWriteTime to the deletion timestamp**, creating a suspicious timeline anomaly\n- Modifying the hive offline may **break the transaction log chain**, making tampering detectable\n\n**Pro tip**: Compare NTUSER.DAT from the live system with copies from Volume Shadow Copies (VSS) to detect unauthorized modifications. If the current Run key shows malware but VSS from yesterday doesn't, you know exactly when persistence was added.\n\nIn the next sections, we'll dive deep into the specific artifacts inside NTUSER.DAT that make it invaluable for investigations."
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Deep Dive: NTUSER.DAT Forensic Artifacts\n\n## 1. UserAssist: GUI Program Execution Records\n\n**UserAssist** is one of the most valuable artifacts for proving program execution. Located at:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{GUID}\\Count\n```\n\nUserAssist tracks GUI applications launched through Windows Explorer, Start Menu, or desktop shortcuts. Each entry includes:\n\n- **Program path** (ROT-13 encoded)\n- **Last execution timestamp**\n- **Run count** (how many times executed)\n- **Focus count** (how many times the window gained focus)\n- **Focus time** (total time in milliseconds the window was in focus)\n\nThere are two main GUIDs:\n- `{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}`: Executable file execution (.exe, .com, .bat)\n- `{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}`: Shortcut file execution (.lnk)\n\n### ROT-13 Encoding: A Simple Obfuscation\n\nUserAssist entries are encoded with **ROT-13**, a simple letter substitution cipher where each letter is replaced by the letter 13 positions after it in the alphabet:\n\n```\nA → N, B → O, C → P ... M → Z, N → A, O → B ... Z → M\n```\n\nExample:\n```\nEncoded: HRZR_PGYFRFFVATF{0SS1PR2014}\\JVAQBJF\\flfgrz32\\pzq.rkr\nDecoded: UEME_PGYCSRFFVATF{0SS1PR2014}\\WINDOWS\\system32\\cmd.exe\n```\n\nThis isn't encryption — it's trivial to reverse. Microsoft uses it to prevent casual browsing from revealing program names, but forensic tools decode it automatically.\n\n### Parsing UserAssist with RegRipper\n\n**RegRipper** is the industry-standard tool for automated registry analysis:\n\n```powershell\n# Run UserAssist plugin on NTUSER.DAT\nrip.exe -r C:\\Evidence\\NTUSER.DAT -p userassist\n```\n\nOutput:\n```\n2025-10-31 14:23:45 UTC | Microsoft.Windows.Explorer | C:\\Windows\\explorer.exe | Count: 187\n2025-10-31 08:12:33 UTC | C:\\Users\\Bob\\Desktop\\mimikatz.exe | Count: 3\n2025-10-30 22:45:12 UTC | C:\\Temp\\payload.exe | Count: 1\n```\n\nNotice `mimikatz.exe` on the desktop — that's suspicious. Three executions suggest deliberate use, not accidental double-clicking.\n\n### Forensic Value of Run Counts and Timestamps\n\n- **Run count = 1**: Likely initial reconnaissance or one-time tool execution\n- **Run count = 3-10**: Deliberate, repeated use (attacker refining their commands)\n- **Run count = 100+**: Legitimate application or persistence mechanism\n- **Focus time = 0**: Program ran but never received user interaction (possibly automated/scripted)\n- **Last execution matches incident window**: Strong temporal correlation\n\n**Case study**: In a 2019 insider threat case, UserAssist showed an employee ran **WinRAR** 47 times over two weeks, always between 2-4 AM. Further analysis revealed they were compressing sensitive files for exfiltration. The unusual access time and repetitive behavior flagged the activity.\n\n## 2. MRU Lists: Most Recently Used Files and Folders\n\n**MRU (Most Recently Used)** lists cache recently accessed files, folders, and locations across Windows and applications. Key MRU locations:\n\n### RecentDocs (General File Access)\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\n```\n\nTracks files opened through Explorer, regardless of application. Stores:\n- **File name** (binary format)\n- **File extension** (separate subkeys for .pdf, .docx, .xlsx, etc.)\n- **Access order** (MRUListEx value shows sequence)\n\nExample RecentDocs:\n```\n.pdf → 2025_Financial_Report.pdf, Confidential_Merger.pdf, Passwords.pdf\n.docx → Resignation_Letter.docx, Manager_Complaints.docx\n```\n\nIf `Confidential_Merger.pdf` appears in RecentDocs but isn't in the user's recent file access logs (Event ID 4663), they may have accessed it from a USB drive or network share that wasn't monitored.\n\n### OpenSaveMRU (Application Dialog History)\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSaveMRU\n```\n\nRecords files accessed through **Open/Save dialogs** in applications (Word, Excel, Notepad, etc.). More granular than RecentDocs because it shows *which application* was used:\n\n```\nOpenSaveMRU\\docx → C:\\Projects\\Q4_Budget.docx (opened in Word)\nOpenSaveMRU\\txt → C:\\Users\\Bob\\passwords.txt (opened in Notepad)\n```\n\n**Attack scenario**: An attacker uses `notepad.exe` to open a stolen credential file. Even if they delete the file, OpenSaveMRU preserves the path under the `.txt` subkey.\n\n### LastVisitedPidlMRU (Cross-Application Navigation)\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU\n```\n\nLinks **applications** to the **folders** they accessed via Open/Save dialogs. Shows which program touched which directory:\n\n```\nApplication: notepad.exe → Folder: C:\\Users\\Bob\\Desktop\\Malware\nApplication: cmd.exe → Folder: C:\\Windows\\System32\n```\n\nThis is powerful for proving an executable interacted with a specific folder, even if individual files were deleted.\n\n### TypedPaths (Explorer Address Bar)\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\n```\n\nCaptures **manually typed** paths in Windows Explorer's address bar. If a user types `\\\\fileserver\\finance\\` to browse a network share, it's recorded here.\n\n**Forensic significance**: TypedPaths shows **intentional navigation**, not just files that were auto-opened. If you see an attacker typing paths like:\n\n```\nurl1: \\\\DC01\\SYSVOL\nurl2: \\\\DC01\\C$\\Windows\\NTDS\nurl3: \\\\BACKUP\\Veeam\n```\n\nThey're manually enumerating Active Directory and backup systems — clear signs of reconnaissance.\n\n## 3. Run Keys: Persistence Mechanisms\n\n**Run keys** are the classic Windows persistence mechanism. Programs listed here execute automatically at user logon:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\n```\n\nExample malicious entry:\n```\nName: \"Windows Update Agent\"\nData: \"C:\\Users\\Bob\\AppData\\Local\\Temp\\svchost.exe\"\n```\n\nLegitimate Windows Update runs from `C:\\Windows\\System32`, not a user's Temp folder. This is obvious malware persistence.\n\n### Other HKCU Persistence Locations\n\nAttackers use lesser-known keys to evade detection:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows (load value)\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon (Shell value)\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\n```\n\nTools like **AutorunsC** (Sysinternals) check all known persistence locations automatically:\n\n```powershell\nautorunsc.exe -a -c -h -s -m -accepteula > autoruns_output.csv\n```\n\n**Pro tip**: Export Run keys from NTUSER.DAT and compare against a known-good baseline. Any new entries are potential indicators of compromise (IOCs).\n\n## 4. Application-Specific MRU Lists\n\n### Microsoft Office Recent Files\n```\nHKCU\\Software\\Microsoft\\Office\\<version>\\<app>\\User MRU\\LiveID_<ID>\\File MRU\n```\n\nTracks recent Word, Excel, PowerPoint documents with full paths and server names. Crucial for data exfiltration investigations.\n\n### Windows Media Player Recent Playlists\n```\nHKCU\\Software\\Microsoft\\MediaPlayer\\Player\\RecentFileList\n```\n\nShows video/audio files played — sometimes reveals USB drive letters or network shares.\n\n### Adobe Acrobat Recent Documents\n```\nHKCU\\Software\\Adobe\\Adobe Acrobat\\<version>\\AVGeneral\\cRecentFiles\n```\n\nTracks PDF files, often including sensitive documents like financial reports or legal contracts.\n\n**Case study**: In a 2021 data breach investigation, Adobe Acrobat MRU revealed that an employee had opened `Customer_Database_Export.pdf` from a USB drive (E:\\) the same day data appeared on a dark web forum. The MRU provided the smoking gun linking the employee to the exfiltration.\n\n## Timeline Correlation: Putting It All Together\n\nNTUSER.DAT artifacts gain power when **correlated** with other evidence sources:\n\n| Time | NTUSER.DAT Artifact | Corroborating Evidence |\n|------|---------------------|------------------------|\n| 14:32 | UserAssist: mimikatz.exe executed | Event 4688: mimikatz.exe process creation |\n| 14:33 | RecentDocs: dump.dmp created | File system: dump.dmp created in C:\\Temp |\n| 14:35 | TypedPaths: \\\\\\\\DC01\\C$ typed | Event 5140: Network share access to DC01 |\n| 14:37 | Run key: backdoor.exe added | Prefetch: backdoor.exe first execution |\n\nThis timeline shows an attacker dumping credentials, accessing a domain controller, and establishing persistence — all provable through NTUSER.DAT combined with other artifacts.\n\n**Next**: We'll explore hands-on tools and automation techniques for parsing NTUSER.DAT at scale."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "# Hands-On: Parsing NTUSER.DAT with Industry Tools\n\n## Tool 1: RegRipper (Eric Zimmerman Suite)\n\n**RegRipper** automates extraction of hundreds of registry artifacts. Install it from GitHub or as part of the KAPE package.\n\n### Basic Usage\n\n```powershell\n# Parse NTUSER.DAT with all user-focused plugins\nrip.exe -r \"C:\\Evidence\\Users\\Bob\\NTUSER.DAT\" -p userassist,recentdocs,typedpaths\n\n# Output to file for reporting\nrip.exe -r \"C:\\Evidence\\Users\\Bob\\NTUSER.DAT\" -p userassist > userassist_results.txt\n\n# Run ALL plugins (comprehensive analysis)\nrip.exe -r \"C:\\Evidence\\Users\\Bob\\NTUSER.DAT\" -a\n```\n\n### Custom Plugin: Extract All MRU Lists\n\n```powershell\n# Use the compdesc plugin to find MRU keys\nrip.exe -r \"C:\\Evidence\\Users\\Bob\\NTUSER.DAT\" -p compdesc | Select-String \"MRU\"\n```\n\n## Tool 2: Registry Explorer (Eric Zimmerman)\n\n**Registry Explorer** provides a GUI for interactive hive analysis with transaction log support.\n\n### Loading a Hive\n\n```powershell\n# Launch Registry Explorer (RegistryExplorer.exe)\n# File → Load Hive → Select NTUSER.DAT\n# Tool automatically loads .LOG1 and .LOG2 for complete data\n```\n\nKey features:\n- **Search**: Full-text search across keys and values\n- **Bookmarks**: Save frequently accessed keys\n- **Dirty flag**: Shows keys modified but not yet committed\n- **Timeline view**: Browse by timestamp\n\n### Pro Tip: Comparing Hives\n\n```powershell\n# Load two versions of NTUSER.DAT (e.g., from different VSS snapshots)\n# Tools → Compare Hives\n# Highlights keys that changed between versions\n```\n\nThis reveals what the attacker modified — new Run keys, deleted MRU entries, etc.\n\n## Tool 3: Python Automation with python-registry\n\n### Installation\n\n```bash\npip install python-registry\n```\n\n### Script: Extract UserAssist Entries\n\n```python\nfrom Registry import Registry\nimport struct\nimport codecs\n\ndef rot13(s):\n    \"\"\"Decode ROT-13 encoded strings\"\"\"\n    return codecs.decode(s, 'rot_13')\n\ndef parse_userassist(hive_path):\n    reg = Registry.Registry(hive_path)\n    \n    # Navigate to UserAssist key\n    ua_path = r\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\"\n    ua_key = reg.open(ua_path)\n    \n    for guid in ua_key.subkeys():\n        count_key = guid.subkey(\"Count\")\n        \n        for value in count_key.values():\n            # Decode ROT-13 program name\n            program = rot13(value.name())\n            \n            # Parse binary data (varies by Windows version)\n            data = value.value()\n            if len(data) >= 72:  # Windows 7+\n                run_count = struct.unpack('<I', data[4:8])[0]\n                last_exec = struct.unpack('<Q', data[60:68])[0]\n                \n                print(f\"Program: {program}\")\n                print(f\"Run Count: {run_count}\")\n                print(f\"Last Execution: {last_exec}\")\n                print(\"-\" * 60)\n\n# Usage\nparse_userassist(\"C:\\\\Evidence\\\\NTUSER.DAT\")\n```\n\n### Script: Find All Run Key Persistence\n\n```python\nfrom Registry import Registry\n\ndef find_run_keys(hive_path):\n    reg = Registry.Registry(hive_path)\n    \n    run_locations = [\n        r\"Software\\Microsoft\\Windows\\CurrentVersion\\Run\",\n        r\"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\",\n        r\"Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"\n    ]\n    \n    for location in run_locations:\n        try:\n            key = reg.open(location)\n            print(f\"\\n[{location}]\")\n            print(f\"Last Write: {key.timestamp()}\")\n            \n            for value in key.values():\n                print(f\"  {value.name()} = {value.value()}\")\n        except Registry.RegistryKeyNotFoundException:\n            continue\n\nfind_run_keys(\"C:\\\\Evidence\\\\NTUSER.DAT\")\n```\n\nOutput:\n```\n[Software\\Microsoft\\Windows\\CurrentVersion\\Run]\nLast Write: 2025-10-31 14:32:18\n  OneDrive = \"C:\\Users\\Bob\\AppData\\Local\\Microsoft\\OneDrive\\OneDrive.exe\" /background\n  SecurityHealth = \"C:\\Windows\\system32\\SecurityHealthSystray.exe\"\n  Backdoor = \"C:\\Users\\Bob\\AppData\\Roaming\\svchost.exe\"  <-- SUSPICIOUS!\n```\n\n## Tool 4: KAPE (Kroll Artifact Parser and Extractor)\n\n**KAPE** is an enterprise-scale collection and parsing framework.\n\n### Collecting NTUSER.DAT from Live System\n\n```powershell\n# Collect all NTUSER.DAT hives from all users\nkape.exe --tsource C: --tdest D:\\Evidence --target RegistryHivesUser\n\n# Also collect transaction logs\nkape.exe --tsource C: --tdest D:\\Evidence --target RegistryHivesUser,RegistryHivesSystem\n```\n\n### Parsing Collected Hives\n\n```powershell\n# Parse with multiple modules\nkape.exe --msource D:\\Evidence --mdest D:\\Parsed --module RegistryASEPsUser,MRU,UserAssist\n\n# Output formats: CSV, JSON, HTML\n```\n\nKAPE integrates RegRipper, Registry Explorer, and other tools into automated workflows.\n\n## Tool 5: RegShot (Before/After Comparison)\n\n**RegShot** captures registry snapshots and compares them to detect changes.\n\n### Detecting Persistence Installation\n\n```powershell\n# 1. Take snapshot before running suspicious executable\nRegShot.exe /1st /outdir:C:\\Analysis\n\n# 2. Execute suspicious program (in sandbox!)\n.\\suspicious.exe\n\n# 3. Take second snapshot\nRegShot.exe /2nd /compare /outdir:C:\\Analysis\n```\n\nOutput shows:\n- **Keys added**: New Run keys, autostart entries\n- **Values modified**: Changed timestamps, new persistence\n- **Keys deleted**: Cleared MRU entries (anti-forensics)\n\n## Real-World Workflow Example\n\n### Scenario: Investigate Suspected Data Exfiltration\n\n```powershell\n# Step 1: Collect NTUSER.DAT from suspect workstation\nkape.exe --tsource C:\\Users\\Alice --tdest E:\\Evidence\\Alice --target RegistryHivesUser\n\n# Step 2: Parse for file access patterns\nrip.exe -r \"E:\\Evidence\\Alice\\NTUSER.DAT\" -p recentdocs,opensavemru > file_access.txt\n\n# Step 3: Check for USB device usage (indicates potential exfiltration vector)\nrip.exe -r \"E:\\Evidence\\Alice\\NTUSER.DAT\" -p usb > usb_devices.txt\n\n# Step 4: Extract UserAssist to see if WinRAR/7-Zip was used (compression for exfil)\nrip.exe -r \"E:\\Evidence\\Alice\\NTUSER.DAT\" -p userassist | Select-String \"WinRAR|7-Zip|compress\"\n\n# Step 5: Timeline correlation\n# Import file_access.txt, usb_devices.txt into timeline analysis tool (Plaso/Log2Timeline)\n```\n\n### Findings:\n\n```\n2025-10-30 15:23:12 | RecentDocs | Customer_List.xlsx accessed\n2025-10-30 15:24:45 | OpenSaveMRU | E:\\Backup\\exfil.7z saved via 7-Zip\n2025-10-30 15:25:01 | UserAssist | 7zFM.exe (7-Zip GUI) executed - Count: 1\n2025-10-30 15:26:33 | TypedPaths | E:\\ typed in Explorer\n```\n\n**Conclusion**: Alice opened a customer list, immediately compressed it with 7-Zip to a USB drive (E:\\), then browsed the USB drive manually. Timeline shows deliberate exfiltration behavior.\n\n## Practice Exercise\n\n**Download the practice NTUSER.DAT** from: https://github.com/EricZimmerman/KapeFiles/tree/master/Targets\n\n**Your task**:\n1. Extract all UserAssist entries and identify the top 5 most-run programs\n2. Find any Run keys indicating persistence\n3. Identify typed paths showing network share enumeration\n4. Correlate timestamps to build a 1-hour activity timeline\n5. Write a one-paragraph summary suitable for a non-technical manager\n\n**Deliverable**: A CSV file with columns: `Timestamp | Artifact Type | Program/File | Forensic Significance`"
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "# Real-World NTUSER.DAT Investigations\n\n## Case 1: NotPetya Ransomware (2017)\n\n**Incident**: Global ransomware attack disguised as software update, causing $10 billion in damages.\n\n**NTUSER.DAT Role**: Responders from Microsoft and CrowdStrike analyzed NTUSER.DAT Run keys across hundreds of infected machines. They discovered that NotPetya added persistence via:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nValue: \"Perfc\" → C:\\Windows\\perfc.dat\n```\n\nThe malware used a generic-sounding name (\"Perfc\" mimics legitimate performance counter files). By correlating Run key LastWriteTime timestamps with event logs, investigators reconstructed the exact minute each machine was compromised, allowing them to trace the attack's lateral movement through the network.\n\n**Lesson**: Run keys provide persistence timestamps that event logs might miss (if logs were cleared or not configured).\n\n## Case 2: SolarWinds Supply Chain Attack (2020)\n\n**Incident**: Nation-state attackers compromised SolarWinds Orion updates, infecting 18,000+ organizations.\n\n**NTUSER.DAT Role**: During incident response at affected government agencies, DFIR teams examined administrator NTUSER.DAT hives to determine which privileged accounts had interacted with compromised Orion servers. Key findings:\n\n- **TypedPaths** showed admins manually typing `\\\\solarwinds-prod\\C$\\` into Explorer\n- **RecentDocs** revealed access to malicious DLL files on the Orion server\n- **OpenSaveMRU** confirmed administrators had downloaded log files from compromised systems\n\nThis proved that specific admin accounts had *knowingly interacted* with the compromised infrastructure, not just accessed it via automated scripts. Legal teams used this to establish timelines for breach notification requirements.\n\n**Lesson**: MRU lists prove intentional human interaction, not just automated system activity.\n\n## Case 3: FIN7 Point-of-Sale Attacks (2018-2019)\n\n**Incident**: Cybercrime group targeted restaurant chains, stealing millions of credit card numbers.\n\n**NTUSER.DAT Role**: FBI forensic analysts examining compromised point-of-sale terminals found critical evidence in NTUSER.DAT:\n\n```\nUserAssist: mstsc.exe (Remote Desktop) - Run Count: 47\nTypedPaths: \\\\192.168.1.250\\POS_Config\nRecentDocs: cc_dump_20190315.txt\n```\n\nThe attackers had used Remote Desktop (mstsc.exe) 47 times to connect to POS terminals, manually browsed to a network share containing configuration files, and accessed text files containing dumped credit card data. Even though the attackers deleted the cc_dump files, **RecentDocs preserved the filenames**, proving the data exfiltration occurred.\n\n**Lesson**: RecentDocs survives file deletion, providing evidence of files that no longer exist on disk.\n\n## Case 4: Insider Threat at Healthcare Provider (2021)\n\n**Incident**: Hospital employee suspected of stealing patient records for identity theft.\n\n**NTUSER.DAT Role**: Internal security team analyzed the suspect's NTUSER.DAT:\n\n```\nOpenSaveMRU\\csv:\n  - Patient_Export_10232021.csv\n  - SSN_List.csv\n  - Insurance_Data.csv\n\nUserAssist:\n  - WinRAR.exe - Run Count: 23, Last Exec: 2021-10-23 03:15:22 (3 AM!)\n  \nLastVisitedPidlMRU:\n  - Application: WinRAR.exe → Folder: E:\\USB_BACKUP\n```\n\nThe evidence showed the employee:\n1. Exported patient data to CSV files via the hospital's database application\n2. Ran WinRAR 23 times (compressing files for transport)\n3. Worked at 3 AM (outside normal shift hours)\n4. Accessed a USB drive (E:\\) with WinRAR\n\n**Outcome**: Employee confessed when presented with the NTUSER.DAT timeline showing the exact files accessed, compression timestamps, and USB drive usage. The registry evidence was irrefutable.\n\n**Lesson**: LastVisitedPidlMRU links applications to folders, proving which tool touched which location.\n\n## Case 5: Ransomware Pre-Deployment Reconnaissance (2022)\n\n**Incident**: Enterprise network infiltrated; attackers spent 3 weeks mapping infrastructure before deploying ransomware.\n\n**NTUSER.DAT Role**: Post-incident forensics examined domain admin NTUSER.DAT from the initial breach point:\n\n```\nTypedPaths (chronological order):\n  url1: \\\\DC01\\SYSVOL\n  url2: \\\\DC01\\C$\\Windows\\NTDS\n  url3: \\\\FileServer01\\Backups\n  url4: \\\\FileServer02\\Veeam\n  url5: \\\\EXCH01\\C$\\Program Files\\Microsoft\\Exchange Server\n```\n\nThis TypedPaths sequence revealed the attacker's reconnaissance pattern:\n1. Enumerated domain controllers (DC01)\n2. Located Active Directory database (NTDS)\n3. Identified backup servers (FileServer01, FileServer02)\n4. Found Exchange server (email repository)\n\nThe attacker manually typed each path over several days, mapping critical infrastructure before deploying ransomware. This evidence:\n- Proved **manual, intentional** reconnaissance (not automated malware)\n- Established **attack sophistication** (knowledge of Active Directory, backup systems)\n- Supported **cyber insurance claim** (demonstrated coordinated human attack, not random malware)\n\n**Lesson**: TypedPaths reveal attacker thought processes and reconnaissance patterns, distinguishing sophisticated human operators from automated malware.\n\n## Case 6: Anti-Forensics Detection (2023)\n\n**Incident**: Attacker attempted to cover tracks by clearing registry MRU lists.\n\n**NTUSER.DAT Role**: DFIR team noticed anomalies in MRU list structure:\n\n```\nRecentDocs MRUListEx:\n  Normal:  0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n  Suspect: 0, 1, 4, 5, 8, 9  <-- Missing 2, 3, 6, 7!\n```\n\nThe gaps indicated **selective deletion** of MRU entries. The team then:\n1. Checked Volume Shadow Copies (VSS) for earlier NTUSER.DAT versions\n2. Compared current hive with VSS snapshots\n3. Recovered deleted entries showing access to `\\\\ExfilServer\\Stolen_Data`\n\n**Outcome**: The attacker's anti-forensics efforts actually *highlighted* the suspicious activity. The selective deletions drew attention to the exact time period and files the attacker wanted to hide.\n\n**Lesson**: Anti-forensic tampering often leaves detectable artifacts. Always compare current registry hives with VSS/backup copies.\n\n## Takeaways for Your Investigations\n\n1. **NTUSER.DAT survives deletion**: MRU lists preserve file/folder names even after files are removed from disk\n2. **Timestamps drive timelines**: LastWriteTime on keys correlates with other evidence sources\n3. **TypedPaths reveal intent**: Manual typing shows deliberate reconnaissance, not accidental access\n4. **Run keys prove persistence**: Critical for proving malware wasn't one-time execution\n5. **UserAssist confirms GUI interaction**: Differentiates human-operated attacks from automated malware\n6. **Compare with baselines**: VSS snapshots and system restore points detect unauthorized modifications\n7. **Multi-source correlation**: NTUSER.DAT + Event Logs + Prefetch + SRUM = comprehensive timeline\n\nEvery major breach investigation from the past decade has leveraged NTUSER.DAT in some capacity. Master this artifact, and you'll have one of the most reliable evidence sources in Windows forensics."
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "# Memory Hooks for NTUSER.DAT Analysis\n\n## The M-U-R-P-T Framework\n\nRemember the five treasure landmarks in NTUSER.DAT:\n\n**M** - **MRU** lists (Most Recently Used)\n- RecentDocs, OpenSaveMRU, LastVisitedPidlMRU\n- *Mnemonic*: \"MRU = Memory Remains Undeleted\" (MRU survives file deletion)\n\n**U** - **UserAssist** (GUI program execution)\n- ROT-13 encoded program paths with run counts and timestamps\n- *Mnemonic*: \"UserAssist = Users Always Suspect Tools\" (tracks every GUI program)\n\n**R** - **Run keys** (persistence mechanisms)\n- AutoStart locations: Run, RunOnce, Policies\\Run\n- *Mnemonic*: \"Run keys = Rogue Utilities Never quit\" (malware persistence)\n\n**P** - **Paths typed** (Explorer address bar)\n- TypedPaths show manual network share enumeration\n- *Mnemonic*: \"Paths = Purposeful Attacker Typing Here\" (intentional navigation)\n\n**T** - **Timestamps** (LastWriteTime)\n- Every key has LastWriteTime for timeline correlation\n- *Mnemonic*: \"Timestamps = Timeline Truth\" (when did it happen?)\n\n## ROT-13 Quick Reference\n\nROT-13 alphabet shift:\n```\nA B C D E F G H I J K L M N O P Q R S T U V W X Y Z\n↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓\nN O P Q R S T U V W X Y Z A B C D E F G H I J K L M\n```\n\nCommon patterns:\n- `HRZR` = **UEME** (User Experience Monitoring Engine)\n- `pzq.rkr` = **cmd.exe**\n- `ertrqvg.rkr` = **regedit.exe**\n\n*Mnemonic*: \"ROT-13: Really Obvious Translation - 13 letters\" (simple alphabet shift)\n\n## The \"Three Questions\" Framework\n\nWhen analyzing any NTUSER.DAT artifact, ask:\n\n1. **WHAT** did the user do? (MRU = files accessed, UserAssist = programs run)\n2. **WHEN** did they do it? (LastWriteTime, UserAssist timestamps)\n3. **WHY** does it matter? (Does it match incident timeframe? Suspicious patterns?)\n\n## Visual: Registry Hive Structure\n\n```\nC:\\Users\\Alice\\\n├── NTUSER.DAT         ← Main hive (locked during logon)\n├── NTUSER.DAT.LOG1    ← Transaction log (recent changes)\n├── NTUSER.DAT.LOG2    ← Transaction log (older changes)\n└── ntuser.dat.{GUID}  ← Backup copy\n\nWhen loaded → Becomes HKEY_CURRENT_USER (HKCU)\n```\n\n*Mnemonic*: \"LOG files = Latest Operations Get preserved\" (transaction logs capture recent activity)\n\n## Attack Pattern Recognition\n\nSuspicious patterns in NTUSER.DAT:\n\n| Indicator | Normal Behavior | Suspicious Behavior |\n|-----------|----------------|---------------------|\n| **Run key added** | OneDrive, Dropbox, Adobe Updater | Unknown .exe from Temp folder |\n| **UserAssist run count** | Chrome: 500+, Word: 200+ | mimikatz.exe: 3 |\n| **TypedPaths** | `C:\\Users\\Alice\\Documents` | `\\\\\\\\DC01\\C$\\Windows\\NTDS` |\n| **RecentDocs at 3 AM** | (none) | Employee_Database.xlsx |\n| **MRU gaps** | 0,1,2,3,4,5 | 0,1,4,5 (missing 2,3) |\n\n*Mnemonic*: \"TIME = Tooling, Intent, Misplaced, Enumeration\"\n- **T**ooling: Hacker tools (mimikatz, psexec)\n- **I**ntent: Deliberate typing (TypedPaths to sensitive shares)\n- **M**isplaced: Programs in wrong locations (svchost in Temp)\n- **E**numeration: Systematic reconnaissance (DC$, SYSVOL, Backups)\n\n## Correlation Checklist\n\nWhen you find NTUSER.DAT evidence, check these other sources:\n\n- ✅ **Event Logs**: 4688 (process creation), 4663 (file access), 5140 (share access)\n- ✅ **Prefetch**: Confirms program execution, shows run count\n- ✅ **SRUM**: Network usage, application resource consumption\n- ✅ **Amcache/Shimcache**: Program execution history\n- ✅ **USN Journal**: File creation/deletion/modification\n- ✅ **$MFT**: File timestamps, confirms file existed\n\n*Mnemonic*: \"CORPUS = Correlate Other Registry Proof Using Secondary sources\"\n\n## Quick Win: The \"Exfil Trifecta\"\n\nIf you see these three together, investigate data exfiltration:\n\n1. **WinRAR/7-Zip in UserAssist** (compression tool executed)\n2. **USB drive letter in LastVisitedPidlMRU** (E:\\, F:\\ accessed)\n3. **Sensitive file in RecentDocs** (Customer_List.xlsx, Passwords.txt)\n\n*Mnemonic*: \"CUE = Compression + USB + Exfiltration\"\n\n## Tool Memory Map\n\n| Tool | Best For | Command |\n|------|----------|----------|\n| **RegRipper** | Automated batch parsing | `rip.exe -r NTUSER.DAT -p userassist` |\n| **Registry Explorer** | Interactive GUI analysis | Load hive → Search/bookmark |\n| **KAPE** | Enterprise-scale collection | `kape.exe --target RegistryHivesUser` |\n| **Python** | Custom scripts/automation | `from Registry import Registry` |\n\n*Mnemonic*: \"RRKP = RegRipper, Registry Explorer, KAPE, Python\" (your forensic toolkit)\n\nPractice these mnemonics until they're automatic. In high-pressure incidents, these memory hooks will guide your analysis when you don't have time to reference documentation."
      }
    },
    {
      "type": "quiz",
      "content": {
        "text": "## Knowledge Check\n\nBefore moving forward, test your understanding with the post-assessment questions. Focus on:\n\n1. **UserAssist specifics**: What makes it unique? (ROT-13, run counts, focus time)\n2. **MRU forensic value**: Why do MRU lists persist after file deletion?\n3. **Correlation scenarios**: When UserAssist and Prefetch don't match, what does it mean?\n\nThese questions mirror real investigation scenarios you'll encounter. If you miss any, review the relevant section before proceeding to the next lesson.\n\n**Passing score**: 2/3 correct (66%)\n**Mastery score**: 3/3 correct (100%)\n\nAnswer the post-assessment questions now."
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "## Reflection: Applying NTUSER.DAT Analysis\n\nTake 5 minutes to consider these questions. Write down your answers to solidify the learning:\n\n### 1. Environment Assessment\n**Question**: Which user accounts in your environment should you prioritize for NTUSER.DAT analysis during an incident?\n\n**Consider**:\n- Domain administrators (privileged access)\n- Service accounts (often overlooked)\n- Users reported in initial alerts\n- Accounts with recent unusual logon times (Event 4624)\n\n**Action item**: Create a prioritized list of \"high-value\" user accounts to analyze first during incidents.\n\n### 2. Automation Opportunities\n**Question**: How will you script repetitive NTUSER.DAT parsing tasks so future incidents resolve faster?\n\n**Consider**:\n- KAPE batch processing across multiple user profiles\n- Python scripts to auto-flag suspicious Run keys\n- RegRipper batch mode for all users: `for /R %f in (NTUSER.DAT) do rip.exe -r \"%f\" -p userassist`\n- Scheduled baseline captures (weekly registry exports for comparison)\n\n**Action item**: Write one automation script this week. Start simple: Extract all Run keys from NTUSER.DAT and email if changes detected.\n\n### 3. Baseline Development\n**Question**: What does \"normal\" look like in your environment's NTUSER.DAT hives?\n\n**Consider**:\n- Legitimate Run keys (OneDrive, corporate VPN client, antivirus)\n- Expected TypedPaths (common file shares: `\\\\fileserver\\shared`, `\\\\dept\\resources`)\n- Standard UserAssist entries (Outlook, Chrome, corporate apps)\n- Typical RecentDocs patterns (how often? which file types?)\n\n**Action item**: Collect NTUSER.DAT from 5 known-good workstations. Parse with RegRipper. Document the common Run keys, MRU patterns, and UserAssist entries. This becomes your baseline for anomaly detection.\n\n### 4. Cross-Team Communication\n**Question**: Who needs a business-friendly summary of NTUSER.DAT findings before the next incident?\n\n**Consider**:\n- Legal/compliance: What evidence proves unauthorized access?\n- HR: Can registry prove employee policy violations?\n- Management: How do we explain \"MRU lists\" to non-technical executives?\n- IT ops: Which persistence mechanisms can they proactively hunt for?\n\n**Action item**: Draft a one-page \"NTUSER.DAT Cheat Sheet\" for non-technical stakeholders. Include:\n- What it is (\"Windows diary of user activity\")\n- What it proves (\"Programs run, files accessed, persistence\")\n- Sample findings (\"User compressed sensitive files at 3 AM and copied to USB\")\n- Why it matters (\"Survives log clearing and file deletion\")\n\n### 5. Lab Practice\n**Question**: How will you gain hands-on experience before the next real incident?\n\n**Practice scenarios**:\n1. **Malware persistence**: Install a test VM, create a Run key manually, analyze with Registry Explorer\n2. **Data exfiltration simulation**: Access sensitive files, compress with 7-Zip, copy to USB, then parse UserAssist + MRU\n3. **Anti-forensics**: Delete specific MRU entries, compare with VSS snapshot, observe gaps\n4. **Timeline reconstruction**: Generate activity over 1 hour (browse shares, run programs, open files), then build timeline from NTUSER.DAT alone\n\n**Action item**: Schedule 2 hours this week for lab practice. Use a Windows 10/11 VM. Walk through one scenario. Document your findings as if writing an incident report.\n\n### 6. Integration with Existing Workflow\n**Question**: Where does NTUSER.DAT fit into your current incident response playbook?\n\n**Workflow integration**:\n- **Triage**: Quick RegRipper scan for Run keys + UserAssist on suspected host\n- **Evidence collection**: Add NTUSER.DAT to imaging checklist (KAPE, FTK Imager)\n- **Timeline analysis**: Import RegRipper output into Plaso/Log2Timeline\n- **Reporting**: Include UserAssist/MRU findings in IOC list\n\n**Action item**: Update your IR playbook documentation. Add \"Analyze NTUSER.DAT\" as a standard step in host forensics. Include tool commands (RegRipper, KAPE).\n\n---\n\n## Commitment to Action\n\nLearning sticks when you apply it immediately. Choose ONE action from above and complete it within 48 hours:\n\n- [ ] Write one automation script (RegRipper batch processing)\n- [ ] Collect baseline NTUSER.DAT samples from 5 workstations\n- [ ] Complete one lab scenario (malware persistence or data exfil simulation)\n- [ ] Draft one-page NTUSER.DAT cheat sheet for non-technical stakeholders\n- [ ] Update IR playbook with NTUSER.DAT analysis steps\n\nCheck the box when done. This converts knowledge into operational capability.\n\n**Remember**: You don't need to master every artifact immediately. Focus on the **M-U-R-P-T** framework:\n- **M**RU lists (file access)\n- **U**serAssist (program execution)\n- **R**un keys (persistence)\n- **P**aths typed (reconnaissance)\n- **T**imestamps (timeline correlation)\n\nThese five artifacts solve 90% of real-world investigations. Master these first. The rest will come with practice."
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "## You're Building Real Investigative Skills\n\n**Registry analysis** can feel overwhelming at first — thousands of keys, cryptic names like \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSaveMRU\", binary data encoded in ROT-13. It's easy to feel lost.\n\n**Here's the truth**: Every expert forensic analyst started exactly where you are. They felt the same uncertainty opening their first NTUSER.DAT hive. The difference between them and beginners isn't talent — it's **repetition and pattern recognition**.\n\n### The Power of Pattern Recognition\n\nYour brain is a pattern-matching machine. Right now, you're learning the patterns:\n\n- **Pattern 1**: Run key + unusual path (C:\\Temp\\svchost.exe) = persistence\n- **Pattern 2**: WinRAR in UserAssist + USB in LastVisitedPidlMRU = potential exfiltration\n- **Pattern 3**: TypedPaths to `\\\\DC01\\C$` + RecentDocs with .dmp files = credential dumping\n\nAfter analyzing 10 NTUSER.DAT hives, these patterns will jump out at you. After 50, you'll spot them in seconds. After 100, you'll be the expert others ask for help.\n\n### Embrace the \"I Don't Know\" Moments\n\nWhen you encounter a registry key you've never seen before, that's not failure — that's **the frontier of your knowledge expanding**. Every \"I don't know\" is an opportunity:\n\n1. Google the registry path: \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist forensics\"\n2. Check SANS DFIR posters: https://www.sans.org/posters/windows-forensic-analysis/\n3. Search GitHub: Someone likely wrote a parser: https://github.com/search?q=ntuser+dat+parser\n4. Document it: Add to your notes. Next time you'll know.\n\n**Growth mindset**: \"I don't know *yet*, but I will in 5 minutes.\"\n\n### The M-U-R-P-T Framework: Your Safety Net\n\nWhen overwhelmed during an incident, return to the **M-U-R-P-T** framework:\n\n- **M**RU: What files did they access?\n- **U**serAssist: What programs did they run?\n- **R**un keys: What persisted?\n- **P**aths typed: What did they enumerate?\n- **T**imestamps: When did it happen?\n\nThese five questions solve most investigations. You don't need to memorize every registry key in Windows. Focus on these, and you'll deliver results.\n\n### Permission to Learn by Doing\n\nYou don't need to understand 100% of registry internals before analyzing your first case. **Start messy**:\n\n- Run RegRipper with `-a` (all plugins). See what it finds.\n- Open Registry Explorer. Click around. Search for \"run\". Explore.\n- Parse a known-good NTUSER.DAT first. Learn what normal looks like.\n- Then analyze a suspicious one. Notice the differences.\n\n**Perfection is the enemy of progress.** Better to analyze 10 hives imperfectly than to study theory for months without touching a real artifact.\n\n### Your Next Win is One Lab Session Away\n\nSchedule 30 minutes this week:\n\n1. Download a practice NTUSER.DAT (https://github.com/AndrewRathbun/DFIRMadness)\n2. Run RegRipper: `rip.exe -r NTUSER.DAT -a > results.txt`\n3. Read the output. Google anything unfamiliar.\n4. Find ONE suspicious artifact. Write a one-sentence explanation.\n\nThat's it. One artifact, one sentence. You'll have learned more from that 30 minutes than from hours of passive reading.\n\n### The UMUT Acronym: Your Memory Anchor\n\nRemember **UMUT** from the lesson?\n- **U**ser-specific registry hive analysis\n- **M**RU (Most Recently Used) lists\n- **U**serAssist\n- **T**yped paths\n\nWhen your manager asks \"What can we learn from the registry?\" you'll answer: \"UMUT — User activity, MRU file access, UserAssist program execution, and Typed paths for reconnaissance. Plus Run keys for persistence.\"\n\nNow you sound like an expert. Because you are becoming one.\n\n### You're Not Alone\n\nEvery DFIR professional debugs the same registry mysteries you're learning now:\n- \"Why is this UserAssist entry ROT-13 encoded?\" (Microsoft design choice, no clear reason)\n- \"Why don't I see Prefetch for this UserAssist entry?\" (Network share execution doesn't create Prefetch)\n- \"Can attackers delete MRU entries?\" (Yes, but it leaves detectable gaps)\n\nThese questions don't make you a beginner — they make you thorough. Keep asking them.\n\n### Celebrate Small Wins\n\nToday you learned:\n- ✅ NTUSER.DAT structure and forensic value\n- ✅ How to parse UserAssist (ROT-13 decoding, run counts)\n- ✅ Where MRU lists hide file access evidence\n- ✅ How Run keys prove persistence\n- ✅ TypedPaths revealing reconnaissance behavior\n- ✅ Real-world cases (NotPetya, SolarWinds, FIN7)\n\nThat's **expert-level knowledge**. Six months ago, you might not have known what a registry hive was. Now you can explain UserAssist ROT-13 encoding and MRU forensic value.\n\n**That's massive progress.** Acknowledge it.\n\n### Final Coaching: From Learner to Investigator\n\nThe gap between \"learning about NTUSER.DAT\" and \"using NTUSER.DAT to solve cases\" is just **one lab session**. You've got the knowledge. Now add the practice:\n\n1. **This week**: Analyze one NTUSER.DAT with RegRipper\n2. **Next week**: Simulate a data exfil scenario, then investigate your own activity\n3. **In 30 days**: Incorporate NTUSER.DAT analysis into your next real incident\n\nThree steps. Thirty days. You'll go from \"I'm learning this\" to \"I just solved a case with this.\"\n\n**You've got this.** The M-U-R-P-T framework is your guide. The tools are free and ready. The practice hives are downloadable. All that's left is to begin.\n\nSchedule that first 30-minute lab session now. Your future investigator self will thank you.\n\n---\n\n*Remember*: Every expert was once a beginner who refused to quit. You're building muscle memory. You're developing pattern recognition. You're becoming the investigator your team needs.\n\nNow go run RegRipper. Teach the UMUT acronym to a teammate. Schedule a lab exercise. Convert this knowledge into instinct.\n\n**You are ready.**"
      }
    }
  ]
}