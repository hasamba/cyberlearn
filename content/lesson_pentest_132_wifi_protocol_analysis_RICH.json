{
  "lesson_id": "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d",
  "domain": "pentest",
  "title": "Wi-Fi Protocol Analysis and Packet Capture",
  "difficulty": 2,
  "order_index": 132,
  "prerequisites": [],
  "concepts": [
    "802.11 wireless protocol fundamentals",
    "Wi-Fi frame types and structure",
    "Monitor mode vs managed mode",
    "Wireless packet capture with airodump-ng",
    "Channel hopping and frequency analysis",
    "Beacon frames and probe requests",
    "Wireless encryption types (WEP, WPA, WPA2, WPA3)",
    "RF spectrum analysis",
    "SSID discovery and enumeration",
    "Wireless reconnaissance tools and techniques"
  ],
  "estimated_time": 60,
  "learning_objectives": [
    "Understand 802.11 wireless protocol architecture and frame types",
    "Configure wireless adapters for monitor mode packet capture",
    "Capture and analyze Wi-Fi traffic using airodump-ng and Wireshark",
    "Identify wireless networks, clients, and access points",
    "Analyze beacon frames, probe requests, and management frames",
    "Perform RF spectrum analysis to identify interference",
    "Enumerate SSIDs and detect hidden networks",
    "Distinguish between different Wi-Fi encryption types",
    "Map wireless network topology and client associations",
    "Implement proper wireless reconnaissance methodology"
  ],
  "post_assessment": [
    {
      "question_id": "wifi-001",
      "question": "What is the PRIMARY difference between monitor mode and managed mode on a wireless adapter?",
      "options": [
        "Monitor mode provides faster speeds for regular Wi-Fi connections",
        "Monitor mode captures all wireless traffic on a channel, not just traffic destined for your adapter",
        "Managed mode allows packet injection for wireless attacks",
        "Monitor mode automatically connects to available networks"
      ],
      "correct_answer": 1,
      "explanation": "Monitor mode (also called promiscuous mode for wireless) captures ALL wireless frames on the channel, including traffic between other devices. Managed mode only receives frames addressed to your specific adapter. This makes monitor mode essential for wireless analysis and penetration testing. It doesn't provide faster speeds or auto-connect features.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "wifi-002",
      "question": "Which 802.11 frame type is used by access points to advertise their presence and capabilities?",
      "options": [
        "Probe Request frames",
        "Association Request frames",
        "Beacon frames",
        "Data frames"
      ],
      "correct_answer": 2,
      "explanation": "Beacon frames are management frames transmitted periodically (typically every 100ms) by access points to advertise their presence, SSID, supported rates, encryption type, and other capabilities. Probe Request frames are sent by clients searching for networks. Association Request frames are used to join a network. Data frames carry actual payload traffic.",
      "type": "multiple_choice",
      "difficulty": 1
    },
    {
      "question_id": "wifi-003",
      "question": "When performing wireless reconnaissance, what does 'channel hopping' accomplish?",
      "options": [
        "It increases the signal strength of captured packets",
        "It allows discovery of networks operating on different Wi-Fi channels",
        "It automatically cracks Wi-Fi passwords by trying different channels",
        "It prevents detection by switching between different wireless adapters"
      ],
      "correct_answer": 1,
      "explanation": "Channel hopping rapidly cycles through different Wi-Fi channels (1-11 in 2.4GHz, 36-165 in 5GHz) to discover networks operating on various frequencies. Since a wireless adapter can only listen on one channel at a time, hopping ensures you find all networks in range. It doesn't affect signal strength, crack passwords, or provide stealth.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "wifi-004",
      "question": "What information can be gleaned from Probe Request frames during wireless reconnaissance?",
      "options": [
        "The Wi-Fi password being used by the client",
        "Previously connected SSIDs that the client is searching for",
        "The MAC address of the access point the client is connected to",
        "The decrypted contents of the client's traffic"
      ],
      "correct_answer": 1,
      "explanation": "Probe Request frames are sent by clients actively searching for networks. They often contain SSIDs of previously connected networks, revealing the client's network history and potential preferred networks. This is valuable for evil twin attacks or social engineering. Probe Requests don't contain passwords, current connection info, or decrypted traffic.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "wifi-005",
      "question": "Which tool is MOST commonly used for capturing wireless packets in monitor mode on Linux?",
      "options": [
        "Nmap",
        "airodump-ng (aircrack-ng suite)",
        "Metasploit",
        "Burp Suite"
      ],
      "correct_answer": 1,
      "explanation": "airodump-ng (part of the aircrack-ng suite) is the standard tool for wireless packet capture in monitor mode. It displays discovered networks, captures handshakes, and logs traffic to pcap files. Nmap is for network scanning, Metasploit for exploitation, and Burp Suite for web app testing - none are designed for 802.11 packet capture.",
      "type": "multiple_choice",
      "difficulty": 1
    }
  ],
  "jim_kwik_principles": [
    "active_learning",
    "minimum_effective_dose",
    "teach_like_im_10",
    "memory_hooks",
    "meta_learning",
    "connect_to_what_i_know"
  ],
  "content_blocks": [
    {
      "type": "mindset_coach",
      "content": {
        "text": "Welcome to Wireless Penetration Testing! ğŸ“¡\n\nYou're about to master one of the most practical and exciting areas of cybersecurity: wireless hacking. Wi-Fi is everywhere - coffee shops, airports, offices, homes. Every wireless network is a potential entry point, and you're learning to find and exploit them.\n\n**Why Wireless Matters:**\n\nğŸ¯ **Ubiquitous**: 3+ billion Wi-Fi devices worldwide\nğŸ¯ **Vulnerable**: 50%+ of networks have weak security\nğŸ¯ **Invisible**: Radio waves don't respect physical boundaries\nğŸ¯ **High-value**: Often the easiest path into corporate networks\n\n**Real-World Impact:**\n- **Target Breach (2013)**: Attackers entered via HVAC company's weak Wi-Fi â†’ 40M credit cards stolen\n- **TJX Breach (2007)**: Weak WEP encryption â†’ 94M+ customer records\n- **Marriott (2018)**: Wi-Fi network compromise â†’ 500M guest records\n\n**What You'll Master:**\n- 802.11 wireless protocols and frame structure\n- Monitor mode packet capture\n- Wireless network discovery and enumeration\n- Analyzing Wi-Fi traffic with professional tools\n- RF spectrum analysis\n- Wireless reconnaissance methodology\n\n**This is your foundation** for all wireless attacks. Master protocol analysis, and you'll understand how every Wi-Fi attack works.\n\nLet's dominate wireless security! ğŸ’ªğŸ“¶"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## Teach Me Like I'm 10: What is Wi-Fi and How Does It Work?\n\nImagine you're in a classroom and want to talk to your friend across the room.\n\n**Wired Network (Ethernet) = Passing Notes**\n- You write a note and hand it directly to your friend\n- Only you and your friend can read it\n- The note can't get lost or intercepted (it's in your hands)\n- But you have to be physically close\n\n**Wireless Network (Wi-Fi) = Shouting Across the Room**\n- You shout your message across the room\n- **EVERYONE in the room hears it** (not just your friend!)\n- Messages can get mixed up if multiple people shout at once\n- Bad guys can hear your messages too\n- But you can talk from anywhere in the room\n\n### Wi-Fi = Radio Waves\n\nWi-Fi uses **invisible radio waves** (like radio stations, but faster):\n\nğŸ“» **Access Point (AP)** = Radio Station\n- Broadcasts signals constantly\n- Says \"Hey! I'm 'CoffeeShop_WiFi'! Connect to me!\"\n- Like a radio station announcing its name\n\nğŸ“± **Your Device** = Radio Receiver\n- Listens for broadcasts\n- Picks the station (Wi-Fi network) you want\n- Tunes in and connects\n\n### The Problem: Everyone Can Hear\n\n**When you connect to Wi-Fi:**\n- Your laptop shouts: \"CoffeeShop_WiFi, can I connect?\"\n- Router shouts back: \"Sure! Here's your connection!\"\n- Your laptop shouts: \"Cool! I'm checking Facebook now!\"\n\n**The attacker with a special antenna:**\n- Hears EVERYTHING\n- Records all the shouting\n- Can pretend to be the Wi-Fi router\n\n**That's why we need encryption** - it's like speaking in a secret code so eavesdroppers can't understand.\n\n### Wi-Fi Channels = Different Frequencies\n\nThink of Wi-Fi channels like TV channels:\n- Channel 1 = One frequency\n- Channel 6 = Different frequency\n- Channel 11 = Another frequency\n\nYour wireless adapter can only listen to **one channel at a time** (like you can only watch one TV channel at once).\n\n**Channel Hopping** = Rapidly switching channels\n- Channel 1 for 0.1 seconds â†’ hear network A\n- Channel 6 for 0.1 seconds â†’ hear network B\n- Channel 11 for 0.1 seconds â†’ hear network C\n- Repeat!\n\n### Monitor Mode vs Normal Mode\n\n**Normal Mode (Managed Mode) = Listening to One Conversation**\n- You only hear messages meant for YOU\n- Like having a private phone call\n- Can't hear other people's conversations\n\n**Monitor Mode = Hearing EVERYONE**\n- You hear ALL Wi-Fi messages in the room\n- Like being a spy with super hearing\n- Can hear everyone's conversations, not just yours\n- **This is what we use for Wi-Fi hacking**\n\n### What We Can Learn from Wi-Fi Signals\n\nWhen we listen to Wi-Fi in monitor mode:\n\n**We can see:**\n- Network names (SSIDs): \"Home_WiFi\", \"CoffeeShop\"\n- Who's connected (MAC addresses of laptops, phones)\n- Which networks are encrypted (WPA2, WPA3) or open\n- How strong signals are\n- What devices are searching for networks\n\n**It's like:**\n- Reading everyone's name tags at a party\n- Seeing who's talking to whom\n- Knowing who's looking for their friends\n- Understanding who arrived when\n\n### Wi-Fi Frame Types (Types of Messages)\n\n**1. Beacon Frames** = \"I'm here!\" announcements\n- Router shouts: \"I'm 'Home_WiFi'! I support WPA2! Connect to me!\"\n- Sent every 100 milliseconds (10 times per second)\n- Like a lighthouse flashing constantly\n\n**2. Probe Requests** = \"Is my network here?\" searches\n- Your phone shouts: \"Is 'Home_WiFi' nearby?\"\n- Your phone shouts: \"Is 'Office_WiFi' nearby?\"\n- **Reveals where you've connected before!**\n- Like calling out for your friend in a crowded place\n\n**3. Authentication/Association** = Joining the network\n- Your laptop: \"Can I join?\"\n- Router: \"Sure! You're in!\"\n- Like asking to join a club\n\n**4. Data Frames** = Actual information\n- Your encrypted web traffic\n- Emails, passwords, etc.\n- Only readable if you have the Wi-Fi password\n\n---\n\n**Bottom Line:**\n\nWi-Fi is like shouting across a room - everyone can hear it. We use special tools (like airodump-ng) to listen to ALL the shouting (monitor mode) and understand:\n- Who's talking (devices)\n- What networks exist (SSIDs)\n- Who's trying to connect\n- What encryption they're using\n\n**This is the foundation of all Wi-Fi hacking!**"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## 802.11 Wireless Protocol Deep Dive\n\n### The OSI Model and Wi-Fi\n\nWi-Fi operates at **Layer 1 (Physical)** and **Layer 2 (Data Link)** of the OSI model:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Layer 7: Application (HTTP, DNS, etc.)    â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Layer 4: Transport (TCP, UDP)             â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Layer 3: Network (IP addresses)           â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Layer 2: Data Link (MAC addresses)        â”‚ â† 802.11 operates here\nâ”‚          - LLC (Logical Link Control)      â”‚\nâ”‚          - MAC (Media Access Control)      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Layer 1: Physical (Radio waves)           â”‚ â† 802.11 operates here\nâ”‚          - Modulation, frequencies         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### 802.11 Standards Evolution\n\n**802.11 Standard Timeline:**\n\n```\n1997: 802.11        â†’ 2 Mbps,  2.4 GHz (original, obsolete)\n1999: 802.11b       â†’ 11 Mbps, 2.4 GHz\n1999: 802.11a       â†’ 54 Mbps, 5 GHz\n2003: 802.11g       â†’ 54 Mbps, 2.4 GHz\n2009: 802.11n (Wi-Fi 4) â†’ 600 Mbps, 2.4/5 GHz, MIMO\n2014: 802.11ac (Wi-Fi 5) â†’ 6.9 Gbps, 5 GHz, MU-MIMO\n2019: 802.11ax (Wi-Fi 6) â†’ 9.6 Gbps, 2.4/5 GHz, OFDMA\n2024: 802.11be (Wi-Fi 7) â†’ 46 Gbps, 2.4/5/6 GHz\n```\n\n**Security Implications:**\n- Older standards (b/g) more vulnerable\n- Newer standards (ax/be) have better encryption\n- All standards vulnerable to deauth attacks\n\n### Wi-Fi Frequency Bands\n\n**2.4 GHz Band:**\n- Channels: 1-14 (1-11 in US)\n- Range: Better penetration through walls\n- Interference: Microwaves, Bluetooth, baby monitors\n- Crowded: Most devices use 2.4 GHz\n\n**5 GHz Band:**\n- Channels: 36-165 (varies by country)\n- Range: Shorter range, less penetration\n- Interference: Less crowded, cleaner spectrum\n- Speed: Higher throughput\n\n**6 GHz Band (Wi-Fi 6E):**\n- Channels: 1-233\n- Range: Shortest range\n- Interference: Very clean (new band)\n- Speed: Highest throughput\n\n**Channel Overlap (2.4 GHz):**\n\n```\n    1   2   3   4   5   6   7   8   9   10  11\n    |---|---|---|---|---|---|---|---|---|----|----|\n    [=====Channel 1====]\n            [=====Channel 6=====]\n                        [=====Channel 11====]\n```\n\nChannels 1, 6, and 11 are non-overlapping in 2.4 GHz.\n\n### 802.11 Frame Structure\n\nEvery 802.11 frame has this structure:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    802.11 Frame                            â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Frame Control (2 bytes)                                    â”‚\nâ”‚  - Protocol version, type, subtype, flags                  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Duration/ID (2 bytes)                                      â”‚\nâ”‚  - Time channel will be busy                               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Address 1 (6 bytes) - Destination MAC                      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Address 2 (6 bytes) - Source MAC                           â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Address 3 (6 bytes) - BSSID (AP MAC)                       â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Sequence Control (2 bytes)                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Address 4 (6 bytes) - Optional (WDS mode)                  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Frame Body (0-2312 bytes)                                  â”‚\nâ”‚  - Actual data or management information                   â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ FCS (4 bytes) - Frame Check Sequence (CRC)                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Frame Types\n\n**Management Frames (Type 0):**\n- **Beacon** (Subtype 8): AP announces its presence\n- **Probe Request** (Subtype 4): Client searches for networks\n- **Probe Response** (Subtype 5): AP responds to probe\n- **Authentication** (Subtype 11): First step to join network\n- **Deauthentication** (Subtype 12): Disconnect client\n- **Association Request** (Subtype 0): Client joins network\n- **Disassociation** (Subtype 10): Client leaves network\n\n**Control Frames (Type 1):**\n- **RTS** (Request to Send): Reserve channel\n- **CTS** (Clear to Send): Channel is clear\n- **ACK** (Acknowledgment): Packet received\n\n**Data Frames (Type 2):**\n- Actual payload (web traffic, emails, etc.)\n- Encrypted if WPA/WPA2/WPA3 is used\n\n### Beacon Frame Analysis\n\nBeacon frames reveal critical information:\n\n```\nBeacon Frame Contents:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Timestamp         â†’ When transmittedâ”‚\nâ”‚ Beacon Interval   â†’ Usually 100ms   â”‚\nâ”‚ Capability Info   â†’ Supported featuresâ”‚\nâ”‚ SSID              â†’ Network name    â”‚\nâ”‚ Supported Rates   â†’ Data rates      â”‚\nâ”‚ DS Parameter Set  â†’ Channel number  â”‚\nâ”‚ Traffic Indication Map (TIM)        â”‚\nâ”‚ ERP Information   â†’ 802.11g/n info  â”‚\nâ”‚ Extended Rates    â†’ Higher speeds   â”‚\nâ”‚ RSN Information   â†’ WPA2/WPA3 info  â”‚\nâ”‚ HT Capabilities   â†’ 802.11n featuresâ”‚\nâ”‚ VHT Capabilities  â†’ 802.11ac featuresâ”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Example Beacon Decoding:**\n\n```\nSSID: \"CoffeeShop_Guest\"\nBSSID: 00:1A:2B:3C:4D:5E (AP MAC address)\nChannel: 6 (2.4 GHz)\nEncryption: WPA2-PSK (CCMP)\nSignal: -45 dBm (strong signal)\nBeacon Interval: 100 TU (102.4 ms)\nCapabilities: ESS, Privacy\n```\n\n**From this beacon, we know:**\n- Network name and AP MAC\n- Operating channel\n- Encryption type (helps choose attack)\n- Signal strength (determines if we're in range)\n- The network requires a password (Privacy flag)\n\n### Hidden SSIDs\n\nSome networks hide their SSID (don't broadcast in beacons):\n\n**Hidden SSID Beacon:**\n```\nSSID: \"\" (empty or null)\nBSSID: 00:1A:2B:3C:4D:5E\nChannel: 11\nEncryption: WPA2\n```\n\n**But we can still find the SSID:**\n1. Wait for a client to connect (Association Request reveals SSID)\n2. Send deauth to force reconnection\n3. Capture the Probe Response when client reconnects\n\n**Hidden SSIDs provide NO real security** - just obscurity.\n\n### Encryption Types\n\n**No Encryption (Open):**\n- Anyone can connect\n- Traffic visible to all\n- **Extremely dangerous**\n\n**WEP (Wired Equivalent Privacy):**\n- Broken encryption (crackable in < 5 minutes)\n- Uses RC4 cipher with weak IV\n- **Never use WEP**\n\n**WPA (Wi-Fi Protected Access):**\n- Temporary fix for WEP\n- Uses TKIP (also weak)\n- **Deprecated, avoid**\n\n**WPA2 (802.11i):**\n- Strong encryption (AES-CCMP)\n- Personal (PSK) or Enterprise (802.1X)\n- Vulnerable to KRACK attack (patched)\n- **Current standard**\n\n**WPA3 (802.11w):**\n- Latest standard (2018)\n- SAE (Simultaneous Authentication of Equals)\n- Forward secrecy\n- Protection against offline dictionary attacks\n- **Most secure**\n\nThis foundation will enable you to understand every wireless attack in the following lessons."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "## Hands-On Lab: Wireless Reconnaissance with airodump-ng\n\n### Prerequisites\n\n**Required Hardware:**\n- Wireless adapter supporting monitor mode\n- Recommended: Alfa AWUS036ACH, TP-Link TL-WN722N v1\n- **Not recommended**: Built-in laptop Wi-Fi (limited capabilities)\n\n**Required Software:**\n- Kali Linux or similar pentesting distro\n- aircrack-ng suite\n- Wireshark\n\n### Lab Setup\n\n**Step 1: Identify Your Wireless Adapter**\n\n```bash\n# List all network interfaces\nifconfig\n\n# Or use newer ip command\nip link show\n\n# Look for wireless interfaces (usually wlan0, wlan1)\n# Example output:\nwlan0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500\n        ether 00:c0:ca:97:c4:7a  txqueuelen 1000  (Ethernet)\n```\n\n**Step 2: Check if Monitor Mode is Supported**\n\n```bash\n# Check wireless capabilities\niw list\n\n# Look for \"monitor\" in Supported interface modes:\n# Supported interface modes:\n#   * IBSS\n#   * managed\n#   * AP\n#   * monitor  â† This confirms support!\n#   * P2P-client\n#   * P2P-GO\n```\n\n**Step 3: Kill Interfering Processes**\n\n```bash\n# Kill processes that might interfere\nsudo airmon-ng check kill\n\n# This kills:\n# - NetworkManager\n# - wpa_supplicant  \n# - dhclient\n# (Don't worry, they'll restart on reboot)\n```\n\n**Step 4: Enable Monitor Mode**\n\n```bash\n# Method 1: Using airmon-ng (recommended)\nsudo airmon-ng start wlan0\n\n# This creates a new interface: wlan0mon\n# Example output:\nPHY     Interface   Driver      Chipset\nphy0    wlan0       ath9k_htc   Atheros Communications, Inc. AR9271\n\n(mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)\n(mac80211 station mode vif disabled for [phy0]wlan0)\n\n# Verify monitor mode\niwconfig wlan0mon\n# Should show: Mode:Monitor\n```\n\n**Alternative Method (Manual):**\n\n```bash\n# Bring interface down\nsudo ip link set wlan0 down\n\n# Set monitor mode\nsudo iw wlan0 set monitor none\n\n# Bring interface up\nsudo ip link set wlan0 up\n\n# Verify\niwconfig wlan0\n# Mode:Monitor\n```\n\n### Exercise 1: Basic Network Discovery\n\n```bash\n# Start airodump-ng (discovers all networks)\nsudo airodump-ng wlan0mon\n\n# You'll see output like:\nCH  6 ][ Elapsed: 52 s ][ 2024-01-15 14:30\n\nBSSID              PWR  Beacons  #Data  #/s  CH  MB   ENC  CIPHER AUTH ESSID\n\n00:1A:2B:3C:4D:5E  -42       89    125   10   6  54e  WPA2 CCMP   PSK  CoffeeShop_WiFi\n11:22:33:44:55:66  -67       45     12    2  11  54e  WPA2 CCMP   PSK  Home_Network\nAA:BB:CC:DD:EE:FF  -35      120      0    0   1  54e  OPN              Free_WiFi\n\nBSSID              STATION            PWR   Rate    Lost    Frames  Probe\n\n00:1A:2B:3C:4D:5E  A1:B2:C3:D4:E5:F6  -45    0 - 1      0       15  \n11:22:33:44:55:66  F1:E2:D3:C4:B5:A6  -72   54 - 54     0       42  Office_WiFi\n(not associated)   99:88:77:66:55:44  -60    0 - 0      0        8  Home_Network,Office_WiFi\n```\n\n**Understanding the Output:**\n\n**Top Section (Access Points):**\n- `BSSID`: MAC address of access point\n- `PWR`: Signal strength (-30 = strong, -90 = weak)\n- `Beacons`: Number of announcement packets\n- `#Data`: Number of data packets captured\n- `CH`: Channel (1-11 for 2.4GHz, 36+ for 5GHz)\n- `ENC`: Encryption (WPA2, WPA, WEP, OPN)\n- `ESSID`: Network name (SSID)\n\n**Bottom Section (Clients):**\n- `STATION`: MAC address of connected device\n- `BSSID`: Which AP the client is connected to\n- `Probe`: Networks the client is searching for\n\n### Exercise 2: Target Specific Network\n\n```bash\n# Focus on one network and save capture\nsudo airodump-ng -c 6 --bssid 00:1A:2B:3C:4D:5E -w capture wlan0mon\n\n# Flags explained:\n# -c 6             : Lock to channel 6\n# --bssid XX:...   : Filter for specific AP\n# -w capture       : Write to capture-01.cap, capture-01.csv, etc.\n# wlan0mon         : Monitor interface\n\n# This creates files:\n# capture-01.cap  â†’ Wireshark-readable packet capture\n# capture-01.csv  â†’ CSV with AP and client info\n# capture-01.kismet.csv â†’ Kismet format\n# capture-01.kismet.netxml â†’ Kismet XML\n```\n\n### Exercise 3: Capture WPA Handshake\n\n**The handshake is required for password cracking:**\n\n```bash\n# Terminal 1: Start capture on target network\nsudo airodump-ng -c 6 --bssid 00:1A:2B:3C:4D:5E -w handshake wlan0mon\n\n# Wait for a client to connect/reconnect\n# You'll see: WPA handshake: 00:1A:2B:3C:4D:5E\n\n# To speed up, force a client to reconnect:\n# Terminal 2: Send deauthentication (in separate terminal)\nsudo aireplay-ng --deauth 5 -a 00:1A:2B:3C:4D:5E wlan0mon\n\n# Flags:\n# --deauth 5  : Send 5 deauth packets\n# -a XX:...   : Target AP MAC address\n\n# Client will disconnect and immediately reconnect\n# Handshake captured!\n```\n\n**Verify Handshake Capture:**\n\n```bash\n# Check if handshake was captured\nsudo aircrack-ng handshake-01.cap\n\n# Output:\nOpening handshake-01.cap\nReading packets, please wait...\n\n1 potential targets\n\n#  BSSID              ESSID                     Encryption\n\n1  00:1A:2B:3C:4D:5E  CoffeeShop_WiFi           WPA (1 handshake)\n\n# \"1 handshake\" means success!\n```\n\n### Exercise 4: Analyze Captures in Wireshark\n\n```bash\n# Open capture in Wireshark\nwireshark handshake-01.cap\n\n# Useful Wireshark filters:\n\n# Show only beacon frames\nwlan.fc.type_subtype == 0x08\n\n# Show only probe requests\nwlan.fc.type_subtype == 0x04\n\n# Show only deauthentication frames\nwlan.fc.type_subtype == 0x0c\n\n# Show all management frames\nwlan.fc.type == 0\n\n# Filter by BSSID\nwlan.bssid == 00:1a:2b:3c:4d:5e\n\n# Show EAPOL frames (handshake)\neapol\n\n# Show only data frames\nwlan.fc.type == 2\n```\n\n**Analyzing a Beacon Frame in Wireshark:**\n\n1. Filter for beacons: `wlan.fc.type_subtype == 0x08`\n2. Select a beacon packet\n3. Expand \"IEEE 802.11 Beacon frame\"\n4. Look for:\n   - SSID\n   - Supported rates\n   - Channel\n   - RSN information (encryption details)\n   - HT/VHT capabilities\n\n### Exercise 5: Channel Hopping Reconnaissance\n\n```bash\n# Hop through all 2.4GHz channels\nsudo airodump-ng --band bg wlan0mon\n\n# Hop through 5GHz channels only\nsudo airodump-ng --band a wlan0mon\n\n# Hop through all bands\nsudo airodump-ng --band abg wlan0mon\n\n# Custom channel list\nsudo airodump-ng --channel 1,6,11,36,40,44,48 wlan0mon\n```\n\n### Exercise 6: Export and Analyze Results\n\n```bash\n# airodump-ng creates CSV files automatically\n# Parse the CSV for analysis:\n\ncat capture-01.csv\n\n# Extract just SSIDs and encryption:\nawk -F, '{print $14, $6}' capture-01.csv | sort -u\n\n# Find open networks:\ngrep \"OPN\" capture-01.csv\n\n# Find WEP networks (easy targets):\ngrep \"WEP\" capture-01.csv\n\n# Count networks by encryption type:\nawk -F, '{print $6}' capture-01.csv | sort | uniq -c\n```\n\n### Cleanup and Return to Normal Mode\n\n```bash\n# Stop monitor mode\nsudo airmon-ng stop wlan0mon\n\n# Restart NetworkManager\nsudo systemctl start NetworkManager\n\n# Or reboot to restore everything\nsudo reboot\n```\n\n### Pro Tips\n\n**1. External Antenna:**\n```bash\n# Use external antenna for better range\n# Alfa AWUS036ACH supports external antennas\n# Can extend range from 50m to 500m+\n```\n\n**2. Multiple Adapters:**\n```bash\n# Use 2 adapters simultaneously\n# Adapter 1: Monitor 2.4GHz\nsudo airodump-ng --band bg wlan0mon\n\n# Adapter 2: Monitor 5GHz\nsudo airodump-ng --band a wlan1mon\n```\n\n**3. GPS Integration:**\n```bash\n# Add GPS data for wardriving\nsudo airodump-ng --gpsd wlan0mon\n\n# Requires gpsd daemon running\n# Creates KML files for Google Earth\n```\n\nThis foundational lab gives you the skills to discover, analyze, and capture wireless traffic - essential for all wireless penetration testing!"
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "## Memory Aids for Wi-Fi Pentesting\n\n### The \"MAC BED\" Framework\n\nRemember the key wireless concepts with **MAC BED**:\n\n**M = Monitor Mode**\n- **M**ust enable for packet capture\n- Sees **M**ore than managed mode\n- Remember: \"**M**onitor **M**eans seeing **M**ore\"\n\n**A = Airodump-ng**\n- **A**ir + dump = captures everything in the air\n- **A**lways your starting tool\n- Remember: \"**A**ir**A**ir**A**ir - it's all about the air!\"\n\n**C = Channels**\n- **C**hannels 1, 6, 11 don't overlap (2.4GHz)\n- **C**hannel hopping finds all networks\n- Remember: \"**C**an't see all without **C**hannel hopping\"\n\n**B = Beacons**\n- **B**roadcast frames from APs\n- **B**roadcast every 100ms\n- Remember: \"**B**eacons are like **B**roacasting lighthouses\"\n\n**E = Encryption**\n- **E**ncryption types: Open, WEP, WPA, WPA2, WPA3\n- **E**asy to hard: Open < WEP < WPA < WPA2 < WPA3\n- Remember: \"**E**ncryption **E**scapes **E**avesdroppers\"\n\n**D = Deauth**\n- **D**isconnect clients to capture handshakes\n- **D**on't overuse (noisy and detectable)\n- Remember: \"**D**eauth **D**isconnects **D**evices\"\n\n---\n\n### Frame Types Mnemonic: \"MCD\"\n\n**M = Management** (Type 0)\n- **M**anages connections\n- Beacons, Probes, Auth, Assoc\n- Remember: \"**M**anagement **M**anages the network\"\n\n**C = Control** (Type 1)\n- **C**ontrols channel access\n- RTS, CTS, ACK\n- Remember: \"**C**ontrol **C**hannel traffic\"\n\n**D = Data** (Type 2)\n- **D**elivers actual data\n- Encrypted payload\n- Remember: \"**D**ata is the **D**estination\"\n\n---\n\n### 2.4GHz Non-Overlapping Channels: \"1-6-11\"\n\nRemember with **\"One-Six-Eleven\"**:\n- **1** = First non-overlapping channel\n- **6** = Middle non-overlapping channel  \n- **11** = Last non-overlapping channel\n\nVisual: **\" 1 ------- 6 ------- 11 \"**\n\nThink of it like traffic lanes on a highway - use lanes 1, 6, or 11 to avoid collisions!\n\n---\n\n### Encryption Strength: \"OWN WAPAS\"\n\n**Weakest to Strongest:**\n\n**O** = **O**pen (no encryption)\n**W** = **W**EP (broken, < 5 min crack)\n**N** = **N**ope, don't use these!\n\n**WA** = **W**PA (weak, TKIP)\n**PA** = **P**SK/**A**uthentication\n**S** = **S**trong (WPA2/WPA3)\n\nRemember: \"You **OWN** networks with weak crypto, but **WPA**s are stronger!\"\n\n---\n\n### airodump-ng Command Structure\n\nRemember flags with **\"C-B-W\"** (Channel-BSSID-Write):\n\n```bash\nairodump-ng -c [channel] --bssid [MAC] -w [file] [interface]\n             â””â”€Câ”€â”˜       â””â”€â”€â”€â”€Bâ”€â”€â”€â”€â”˜   â””â”€Wâ”€â”˜\n```\n\n**C** = **C**hannel to lock onto\n**B** = **B**SSID (MAC) to filter  \n**W** = **W**rite capture to file\n\nThink: \"**C**ome **B**ring **W**ireless data!\"\n\n---\n\n### Signal Strength Quick Reference\n\n```\n-30 dBm = â˜…â˜…â˜…â˜…â˜… Excellent (very close)\n-50 dBm = â˜…â˜…â˜…â˜…â˜† Good (normal)\n-70 dBm = â˜…â˜…â˜†â˜†â˜† Weak (far)\n-90 dBm = â˜…â˜†â˜†â˜†â˜† Very weak (unusable)\n```\n\nRemember: \"**Lower negative = Better signal**\"\n\nThink of it like temperature in freezing:\n- -30Â°F is cold but not terrible\n- -90Â°F is dangerously cold\n\nSame with dBm - more negative = worse!\n\n---\n\n### Wireless Adapter Setup Steps: \"KCME\"\n\nRemember the order with **KCME** (\"Kick-Me\"):\n\n**K** = **K**ill interfering processes (`airmon-ng check kill`)\n**C** = **C**heck adapter capabilities (`iw list`)\n**M** = **M**onitor mode enable (`airmon-ng start wlan0`)\n**E** = **E**xecute capture (`airodump-ng wlan0mon`)\n\nThink: \"Don't **kick me**, follow these steps!\"\n\n---\n\n### Quick Reference Card\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚          Wi-Fi Pentesting Cheat Sheet             â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Monitor Mode:                                      â”‚\nâ”‚   airmon-ng start wlan0     â†’ wlan0mon            â”‚\nâ”‚   airmon-ng stop wlan0mon   â†’ back to managed     â”‚\nâ”‚                                                    â”‚\nâ”‚ Discovery:                                         â”‚\nâ”‚   airodump-ng wlan0mon      â†’ find all networks   â”‚\nâ”‚   airodump-ng -c 6 wlan0mon â†’ lock to channel 6   â”‚\nâ”‚                                                    â”‚\nâ”‚ Capture Handshake:                                 â”‚\nâ”‚   airodump-ng -c 6 --bssid XX:XX:XX:XX:XX:XX \\    â”‚\nâ”‚               -w capture wlan0mon                  â”‚\nâ”‚                                                    â”‚\nâ”‚ Force Reconnect:                                   â”‚\nâ”‚   aireplay-ng --deauth 5 -a XX:XX:XX:XX:XX:XX \\   â”‚\nâ”‚               wlan0mon                             â”‚\nâ”‚                                                    â”‚\nâ”‚ Verify Handshake:                                  â”‚\nâ”‚   aircrack-ng capture-01.cap                       â”‚\nâ”‚                                                    â”‚\nâ”‚ Non-Overlapping Channels: 1, 6, 11                â”‚\nâ”‚ Frame Types: Management(0), Control(1), Data(2)   â”‚\nâ”‚ Encryption Strength: Open < WEP < WPA < WPA2/3    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nUse these memory aids during engagements and exams! ğŸ“"
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "## Reflection: Mastering Wi-Fi Protocol Analysis\n\nYou've learned the foundation of wireless penetration testing. Before moving to attacks, reflect on what you've mastered.\n\n### Self-Assessment Questions\n\n**Technical Understanding:**\n\n1. **Can you explain the difference between monitor mode and managed mode?**\n   - What does monitor mode allow that managed mode doesn't?\n   - Why is monitor mode essential for wireless pentesting?\n   - What are the limitations of monitor mode?\n\n2. **What information can you gather from beacon frames?**\n   - List at least 5 pieces of information\n   - How does encryption type affect your attack strategy?\n   - What does signal strength (dBm) tell you?\n\n3. **Why do we need to capture the 4-way handshake?**\n   - What is the handshake used for?\n   - What happens if you miss one of the 4 frames?\n   - Can you crack WPA3 the same way as WPA2?\n\n**Practical Skills:**\n\n4. **Could you set up monitor mode right now without looking at notes?**\n   - What commands would you run?\n   - What if it fails - how would you troubleshoot?\n   - How would you verify it's working?\n\n5. **If you ran airodump-ng and saw 20 networks, how would you prioritize?**\n   - Which would you test first and why?\n   - What makes a network a good target?\n   - What makes a network a bad target?\n\n6. **What's your strategy for capturing a handshake?**\n   - How long would you wait before deauthing?\n   - How many deauth packets would you send?\n   - How would you verify the handshake is complete?\n\n### Hands-On Challenge\n\n**Scenario**: You're in a coffee shop hired to test their Wi-Fi security.\n\n**Your Task**:\n1. Set up monitor mode\n2. Discover all networks in range\n3. Identify the coffee shop's network\n4. Determine encryption type\n5. Capture a WPA handshake\n6. Document findings\n\n**Write Your Methodology**:\n\n```\nStep 1: Equipment Check\n- Adapter: [Which adapter would you use?]\n- Tools: [List required tools]\n- Legal: [What authorization do you need?]\n\nStep 2: Reconnaissance\n- Commands: [What commands would you run?]\n- Expected output: [What would you look for?]\n- Target identification: [How do you confirm it's their network?]\n\nStep 3: Handshake Capture\n- Capture strategy: [Passive waiting or active deauth?]\n- Timing: [How long would you try each approach?]\n- Verification: [How do you confirm success?]\n\nStep 4: Documentation\n- What would you document?\n- How would you present findings?\n- What remediation would you suggest?\n```\n\n### Knowledge Gaps\n\nBe honest - what do you still need to practice?\n\n- [ ] Setting up monitor mode\n- [ ] Understanding channel hopping\n- [ ] Interpreting airodump-ng output\n- [ ] Capturing handshakes reliably\n- [ ] Using Wireshark filters\n- [ ] Distinguishing encryption types\n- [ ] Troubleshooting adapter issues\n- [ ] Understanding 802.11 frame structure\n\n**For each checked item**: Practice in your lab environment!\n\n### Connect to Real-World\n\n**If you're a penetration tester:**\n- How would you include wireless in your methodology?\n- What would you document for compliance?\n- How would you handle PCI-DSS wireless requirements?\n\n**If you're a security engineer:**\n- How does this change your Wi-Fi deployment strategy?\n- What controls would you implement?\n- How would you detect rogue APs?\n\n**If you're a student:**\n- How would you practice without breaking laws?\n- What lab equipment would you buy?\n- Which certifications cover wireless security?\n\n### Next Steps\n\n**This Week:**\n1. Set up a home lab with a spare router\n2. Practice monitor mode 10 times until it's muscle memory\n3. Capture 5 handshakes from your own networks\n4. Analyze 100 beacon frames in Wireshark\n\n**This Month:**\n1. Study for OSWP (Offensive Security Wireless Professional)\n2. Read \"The Wireless Networking Starter Kit\" by Glenn Fleishman\n3. Join wireless security communities (Reddit r/WirelessHacking)\n4. Practice on HackTheBox wireless challenges\n\n**This Year:**\n1. Master all wireless attack types (next lessons!)\n2. Earn OSWP or GAWN certification\n3. Conduct your first authorized wireless assessment\n4. Present wireless findings to your team\n\n### Final Thoughts\n\n**What was your biggest \"aha!\" moment?**\n\n_Write here:_\n\n\n**What surprised you most about Wi-Fi?**\n\n_Write here:_\n\n\n**What will you practice first?**\n\n_Write here:_\n\n\n---\n\n**Remember**: Wi-Fi protocol analysis is the foundation for everything that follows. Master this, and attacks will make perfect sense. Don't rush - build solid fundamentals!\n\n**You're ready for the next lesson: Rogue AP Detection!** ğŸ¯ğŸ“¡"
      }
    }
  ],
  "tags": ["Course: SANS-SEC617", "Career Path: Pentester"]
}
