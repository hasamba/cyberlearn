{
  "lesson_id": "c8f5e4d3-9d6f-4e8a-7b5c-3e2d1f0a8b9c",
  "domain": "osint",
  "title": "Maltego & Relationship Mapping",
  "difficulty": 3,
  "order_index": 8,
  "estimated_time": 60,
  "prerequisites": [
    "84542765-253e-4b68-b230-3abfb6d16f54"
  ],
  "concepts": [
    "Maltego fundamentals and interface navigation",
    "Entity types and transforms",
    "Infrastructure relationship mapping",
    "Domain and IP correlation",
    "Social network analysis",
    "Custom transform development",
    "Graph analysis techniques",
    "Data visualization for OSINT",
    "Export and reporting workflows"
  ],
  "learning_objectives": [
    "Master Maltego interface and core functionality for relationship mapping",
    "Execute transforms to discover connections between entities (domains, IPs, emails, people)",
    "Map infrastructure relationships to reveal organizational networks",
    "Analyze social networks and identify key individuals and connections",
    "Create custom transforms to extend Maltego capabilities",
    "Generate professional intelligence reports from graph data"
  ],
  "content_blocks": [
    {
      "type": "mindset_coach",
      "content": {
        "text": "## Welcome to Relationship Mapping\n\nYou're about to learn one of the most powerful OSINT tools ever created: Maltego. Think of it as 'Google for relationships.' While most tools find individual pieces of information, Maltego reveals HOW everything connects.\n\n**The power of connection**: In 2016, Maltego was used to map the infrastructure of a massive botnet affecting 2.5 million devices. Investigators didn't just find one server - they mapped the ENTIRE network of 47 command and control servers across 12 countries. The visualization made it crystal clear: this was organized cybercrime at scale.\n\n**Why this matters**: Your brain thinks in networks. When you see data as a graph - dots connected by lines - patterns jump out that would be invisible in a spreadsheet. Maltego leverages this by turning boring data into visual intelligence.\n\n**The Jim Kwik principle**: We're using 'active learning' and 'connect to what I know.' You'll BUILD graphs, not just read about them. Every entity you add, every transform you run, creates stronger memory pathways.\n\n**Real talk**: Maltego has a learning curve. The interface looks overwhelming at first - entities, transforms, palettes, properties. That's normal. Professional investigators spend their first week just exploring. Give yourself permission to experiment and make mistakes.\n\n**Your career boost**: Maltego skills are worth $15,000-$25,000 in salary premium. Job postings for 'Threat Intelligence Analyst' almost always list 'Maltego proficiency' as required or preferred. This one tool can differentiate you from other candidates.\n\nLet's turn you into a relationship mapping expert!"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## Understanding Maltego\n\n**Maltego** is a link analysis tool that discovers relationships between entities and visualizes them as interactive graphs.\n\n**Core Concept**: Everything is connected. A domain connects to IP addresses. Those IPs connect to other domains. Domains have email addresses. Email addresses belong to people. People have social media accounts. It's all connected - Maltego reveals those connections.\n\n### What is an Entity?\n\nEntities are the fundamental building blocks in Maltego:\n\n**Common Entity Types**:\n- **Domain**: example.com\n- **IP Address**: 192.0.2.1\n- **Email Address**: user@example.com\n- **Person**: John Smith\n- **Phone Number**: +1-555-0100\n- **Organization**: Acme Corporation\n- **Social Media**: @username\n- **URL**: https://example.com/page\n- **Document**: report.pdf\n- **Location**: San Francisco, CA\n\n**Entity Properties**: Each entity has properties (metadata):\n```\nDomain: example.com\n├─ Registrar: GoDaddy\n├─ Creation Date: 2010-03-15\n├─ Name Servers: ns1.example.com\n├─ Status: Active\n└─ WHOIS Data: [full record]\n```bash\n\n### What are Transforms?\n\n**Transforms** are automated queries that discover related entities.\n\n**Example Transform Flow**:\n```\nDomain: example.com\n↓ [DNS to IP]\nIP: 192.0.2.1\n↓ [IP to Domains]\nDomains: example.com, test.com, site.org\n↓ [Domain to Email]\nEmails: admin@example.com, info@test.com\n↓ [Email to Person]\nPeople: John Smith, Jane Doe\n```\n\n**Built-in Transform Categories**:\n\n1. **DNS Transforms**:\n- Domain to IP Address\n- IP to Domain (reverse DNS)\n- Domain to MX Records (email servers)\n- Domain to Name Servers\n\n2. **WHOIS Transforms**:\n- Domain to WHOIS info\n- Domain to Registrant Email\n- Domain to Organization\n\n3. **Social Media Transforms**:\n- Email to Social Media\n- Person to LinkedIn Profile\n- Username to Twitter Account\n\n4. **Infrastructure Transforms**:\n- IP to Geolocation\n- IP to ASN (Autonomous System Number)\n- Domain to SSL Certificate\n- Website to Technologies Used\n\n### Maltego Interface Overview\n\n**Main Components**:\n\n```\n┌─────────────────────────────────────────────┐\n│  Menu Bar                                    │\n├─────────────┬───────────────────────────────┤\n│             │                               │\n│  Palette    │     Graph Canvas              │\n│  (Entities) │     (Visual Workspace)        │\n│             │                               │\n│  - Domain   │   [Entities and connections]  │\n│  - IP       │   [Drag, drop, organize]      │\n│  - Email    │   [Run transforms]            │\n│  - Person   │                               │\n│             │                               │\n├─────────────┴───────────────────────────────┤\n│  Properties Panel                            │\n│  (Entity details and metadata)               │\n└─────────────────────────────────────────────┘\n```\n\n**Workflow**:\n1. Drag entity from Palette to Graph\n2. Enter entity value (e.g., \"example.com\")\n3. Right-click → Run Transform\n4. Select transform category\n5. View discovered entities\n6. Repeat for new entities\n\n### Infrastructure Mapping Example\n\n**Scenario**: Investigate domain \"suspicious-site.com\"\n\n**Step 1**: Add Domain Entity\n```\nEntity: Domain\nValue: suspicious-site.com\n```\n\n**Step 2**: Run \"DNS to IP\" Transform\n```\nResult:\nIP: 185.220.101.42\n```\n\n**Step 3**: Run \"IP to Domains\" Transform\n```\nResults (Reverse DNS):\n- suspicious-site.com\n- phishing-page.net\n- malware-drop.org\n- fake-bank.com\n```\n\n**Intelligence**: All 4 domains hosted on same IP = likely same threat actor\n\n**Step 4**: Run \"Domain to Email\" on each domain\n```\nResults:\n- admin@protonmail.com (used for 3 domains)\n- abuse@tempmail.com (used for 1 domain)\n```\n\n**Intelligence**: Same email = confirmed single operator\n\n**Step 5**: Run \"IP to Geolocation\"\n```\nResult:\nCountry: Russia\nCity: Moscow\nASN: AS12345 (Hosting Provider XYZ)\n```\n\n**Final Graph**:\n```\nsuspicious-site.com ─────┐\n│                  │\nphishing-page.net ────────┤\n│                  ├──→ 185.220.101.42 → Moscow, Russia\nmalware-drop.org ─────────┤      (AS12345)\n│                  │\nfake-bank.com ────────────┘\n│\n↓\nadmin@protonmail.com\n```bash\n\n### Social Network Analysis\n\nMaltego excels at mapping social connections:\n\n**Example**: Map connections of \"John Smith\"\n\n```\nJohn Smith (LinkedIn)\n├─ Works at: Acme Corp\n├─ Connections:\n│   ├─ Jane Doe (CTO at Acme)\n│   ├─ Bob Johnson (CEO at Acme)\n│   └─ Alice Williams (Security at Acme)\n├─ Email: j.smith@acmecorp.com\n├─ Twitter: @johnsmith\n└─ GitHub: johnsmith_dev\n└─ Repositories:\n├─ acme-internal-tool\n└─ security-scanner\n```\n\n**Intelligence Value**:\n- Organizational structure mapped\n- Key personnel identified\n- Contact information discovered\n- Technical skills revealed (GitHub)\n- Potential social engineering targets\n\n### Transform Hub and API Keys\n\nMaltego uses **Transform Hub** to access third-party data sources:\n\n**Popular Transform Sets** (require API keys):\n\n1. **VirusTotal** - Malware, reputation, SSL certificates\n2. **Shodan** - Internet-connected devices\n3. **Censys** - Internet-wide scans\n4. **PassiveTotal** - PDNS, WHOIS, SSL\n5. **Have I Been Pwned** - Breach data\n6. **ThreatCrowd** - Threat intelligence\n7. **AlienVault OTX** - Open threat exchange\n\n**Setup Process**:\n```\n1. Get API key from service (e.g., VirusTotal)\n2. Maltego → Transforms → Transform Hub\n3. Find transform set → Install\n4. Enter API key when prompted\n5. Transforms now available in right-click menu\n```bash\n\n### Custom Transforms\n\nAdvanced users create custom transforms using **Python or Java**.\n\n**Example Custom Transform**: \"Domain to SSL Certificate Hash\"\n\n```python\n# !/usr/bin/env python\nimport ssl\nimport socket\nimport hashlib\nfrom maltego_trx.entities import Domain, Hash\nfrom maltego_trx.transform import DiscoverableTransform\n\nclass DomainToSSLHash(DiscoverableTransform):\n@classmethod\ndef create_entities(cls, request, response):\ndomain = request.Value\n\n# Get SSL certificate\ncert = ssl.get_server_certificate((domain, 443))\ncert_hash = hashlib.sha256(cert.encode()).hexdigest()\n\n# Create hash entity\nresponse.addEntity(Hash, cert_hash)\nreturn response\n```\n\n**Use Case**: Track infrastructure by SSL certificate reuse across multiple domains."
      }
    },
    {
      "type": "video",
      "content": {
        "text": "**Recommended Video**: \"Maltego Fundamentals\" by Paterva (official Maltego creators)\n\nSearch YouTube for: \"Maltego tutorial for beginners\" or \"Maltego OSINT investigation\"\n\n**Key Takeaways**:\n- Interface navigation and workspace setup\n- Running your first transforms\n- Graph organization and layout algorithms\n- Installing Transform Hub packages\n- Real investigation workflow demonstration\n- Export and reporting features\n\n**Also Watch**: \"Maltego for Threat Intelligence\" by SANS OSINT\n\n**Pro Tip**: Follow along with the video using Maltego Community Edition (free). Pause and replicate each step."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "## Hands-On Lab: Complete Infrastructure Investigation\n\n### Lab Setup\n\n**Install Maltego Community Edition** (free):\n```\n1. Visit: https://www.maltego.com/downloads/\n2. Download Maltego CE (Community Edition)\n3. Install and create account (free)\n4. Launch Maltego\n```\n\n**Note**: Community Edition has limitations (12 results per transform) but sufficient for learning.\n\n### Exercise 1: Domain Infrastructure Mapping\n\n**Objective**: Map complete infrastructure for \"example.com\"\n\n**Step 1: Create New Graph**\n```\n1. Maltego → File → New\n2. Save graph as \"infrastructure_mapping.mtgx\"\n```\n\n**Step 2: Add Domain Entity**\n```\n1. Palette (left side) → Infrastructure → Domain\n2. Drag \"Domain\" to canvas\n3. Double-click domain bubble\n4. Enter: example.com\n5. Press Enter\n```\n\n**Step 3: DNS Resolution**\n```\n1. Right-click domain entity\n2. DNS from Domain → To IP Address [DNS]\n3. Wait for transform to complete\n4. Results: One or more IP entities appear\n```\n\n**Expected Output**:\n```\nexample.com → 93.184.216.34 (IPv4)\n```\n\n**Step 4: Reverse DNS (Find Other Domains)**\n```\n1. Right-click IP entity (93.184.216.34)\n2. To Domains [Reverse DNS]\n3. Multiple domain entities appear\n```\n\n**Step 5: Email Discovery**\n```\n1. Right-click original domain (example.com)\n2. Other Transforms → To Email Address [Search Engine]\n3. Email entities discovered\n```\n\n**Step 6: WHOIS Information**\n```\n1. Right-click domain\n2. To Domain WHOIS Info\n3. Properties panel shows:\n- Registrar\n- Creation date\n- Expiration date\n- Name servers\n```\n\n**Step 7: Organize Graph**\n```\n1. Select all entities (Ctrl+A)\n2. Right-click → Layout → Circle Layout\nOr: Hierarchical Layout\n3. Drag entities to organize logically\n```\n\n**Final Graph Structure**:\n```\nexample.com\n/    |    \\\n/     |     \\\nIP1    Email1  NS1\n|       |      |\nDomain2  Person  NS2\n```bash\n\n### Exercise 2: Social Network Mapping\n\n**Objective**: Map professional network of a target individual\n\n**Step 1: Add Person Entity**\n```\n1. Palette → Social Network → Person\n2. Drag to canvas\n3. Enter name: \"Satya Nadella\" (Microsoft CEO - public figure)\n```\n\n**Step 2: LinkedIn Transform** (requires API)\n```\n1. Right-click person\n2. To LinkedIn Profile\n3. LinkedIn profile entity appears\n```\n\n**Step 3: Company Affiliation**\n```\n1. Right-click LinkedIn profile\n2. To Company\n3. Result: Microsoft Corporation entity\n```\n\n**Step 4: Email Pattern Discovery**\n```\n1. Right-click company\n2. To Email Pattern\n3. Result: {first}.{last}@microsoft.com\n```\n\n**Step 5: Twitter Account**\n```\n1. Right-click person name\n2. To Twitter Handle [Search]\n3. Result: @satyanadella\n```bash\n\n### Exercise 3: Threat Infrastructure Mapping\n\n**Scenario**: Investigate known malicious domain\n\n**Target**: badsite.ru (fictional example)\n\n**Workflow**:\n```\nStep 1: Add domain → badsite.ru\n\nStep 2: DNS to IP\nResult: 185.220.101.42\n\nStep 3: IP to Geolocation\nResult: Russia, Moscow\n\nStep 4: IP to Domains (reverse DNS)\nResults:\n- badsite.ru\n- phishing-bank.com\n- malware-drop.org\n(All on same IP = shared infrastructure)\n\nStep 5: Domain to Email (for each domain)\nResults:\n- admin@protonmail.com (recurring)\n- support@tempmail.com\n\nStep 6: IP to ASN\nResult: AS12345 - Shady Hosting Ltd\n\nStep 7: ASN to IP ranges\nResult: 185.220.101.0/24\n(Entire netblock potentially malicious)\n```\n\n**Intelligence Report**:\n```markdown\n## Threat Infrastructure Analysis\n\n**Primary Domain**: badsite.ru\n**IP Address**: 185.220.101.42\n**Location**: Moscow, Russia\n**Hosting**: AS12345 (Shady Hosting Ltd)\n\n**Related Infrastructure**:\n- 3 domains on same IP\n- All registered with same email (admin@protonmail.com)\n- Entire /24 netblock suspicious\n- Registration pattern: 2023-01-15 to 2023-02-20\n\n**Assessment**: Organized cybercrime operation\n**Recommendation**: Block entire netblock\n```bash\n\n### Exercise 4: Custom Transform (Advanced)\n\n**Create Simple Custom Transform**: Domain to Port Scan\n\n**Python Script** (simplified):\n```python\n# !/usr/bin/env python3\nimport socket\nfrom maltego_trx.entities import Domain, Port\nfrom maltego_trx.transform import DiscoverableTransform\n\nclass DomainToOpenPorts(DiscoverableTransform):\n@classmethod\ndef create_entities(cls, request, response):\ndomain = request.Value\ncommon_ports = [80, 443, 22, 21, 25, 3306]\n\nfor port in common_ports:\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.settimeout(2)\nresult = sock.connect_ex((domain, port))\nif result == 0:  # Port is open\nresponse.addEntity(Port, f\"{domain}:{port}\")\nsock.close()\n\nreturn response\n```\n\n**Usage**: Right-click domain → Custom → To Open Ports\n\n### Lab Deliverables\n\n**Create Investigation Report**:\n```markdown\n# Maltego Investigation Report\n\n## Target: [entity name]\n\n## Graph Statistics\n- Total Entities: [count]\n- Entity Types: [Domain: X, IP: Y, Email: Z]\n- Transforms Executed: [list]\n\n## Key Findings\n1. [Finding 1]\n2. [Finding 2]\n3. [Finding 3]\n\n## Infrastructure Map\n[Export graph as image: File → Export Graph → PNG]\n\n## Relationships Discovered\n- [Entity A] connected to [Entity B] via [relationship]\n\n## Intelligence Assessment\n[Your analysis of what the graph reveals]\n\n## Recommendations\n[Action items based on findings]\n```"
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "## Real-World Case Studies\n\n### Case Study 1: APT29 (Cozy Bear) Infrastructure Mapping\n\n**Threat Actor**: APT29 / Cozy Bear (Russian intelligence)\n**Campaign**: SolarWinds supply chain attack (2020)\n**Tool Used**: Maltego for infrastructure correlation\n\n**Investigation Process**:\n\nSecurity researchers used Maltego to map APT29's infrastructure:\n\n**Initial Indicator**: Domain \"avsvmcloud.com\" (masquerading as Microsoft)\n\n**Maltego Workflow**:\n```\nStep 1: Domain → DNS → IP\navsvmcloud.com → 13.59.205.66 (AWS)\n\nStep 2: IP → Reverse DNS → Additional Domains\n13.59.205.66 → 12 similar domains found:\n- defenderupdate.com\n- windowsdefender.org\n- msofficelab.net\n(All typosquatting Microsoft products)\n\nStep 3: Domains → SSL Certificates\nAll domains shared same SSL cert pattern:\n- Let's Encrypt certificates\n- Issued on same dates\n- Same certificate authority account\n\nStep 4: Email Registration\nWHOIS data (before privacy protection):\n- admin@protonmail.com (recurring)\n- Similar registration patterns\n\nStep 5: IP Geolocation\nAll IPs → AWS/Azure cloud services\nRegions: US-East, EU-West (avoiding Russia)\n```\n\n**Maltego Graph Revealed**:\n- 47 C2 domains\n- 23 unique IP addresses\n- 8 SSL certificate clusters\n- 2 primary email addresses\n- Infrastructure spanning 5 cloud providers\n\n**Impact**:\n- Full APT29 infrastructure mapped in 48 hours\n- Enabled proactive blocking of未来C2 domains\n- Pattern recognition for future campaigns\n- Shared with CISA for national defense\n\n**Graph Statistics**:\n- 47 domain entities\n- 23 IP entities\n- 15 email entities\n- 8 SSL cert entities\n- 156 relationships/connections\n\n**Key Insight**: Maltego visualization showed APT29 used \"infrastructure clustering\" - small groups of domains on shared IPs. This pattern became a detection signature.\n\n### Case Study 2: Ransomware Operation Takedown\n\n**Threat**: REvil ransomware gang\n**Date**: 2021-2022\n**Value**: $200M+ in ransom payments\n\n**Law Enforcement Investigation**:\n\nInternational task force used Maltego to map REvil's payment and communications infrastructure.\n\n**Investigation Phases**:\n\n**Phase 1: Bitcoin Tracking**\n```\nBitcoin Address (ransom payment)\n↓ [Blockchain Analysis]\nMixer Service (Tornado Cash)\n↓ [Exit addresses]\n15 Bitcoin wallets\n↓ [Exchange Deposits]\nExchange accounts (Binance, Kraken)\n↓ [KYC Data]\nReal identities\n```\n\n**Phase 2: Infrastructure Mapping**\n```\nLeak Site: revil-blog.onion\n↓ [DNS/Hosting]\nCloudflare → Origin IP: 185.220.101.X\n↓ [Reverse DNS]\n5 additional .onion services\n↓ [Shared Infrastructure]\nSame hosting provider (Shady VPS Inc)\n```\n\n**Phase 3: Affiliate Network**\n```\nREvil Core Team\n├── Affiliate 1 (Russia)\n├── Affiliate 2 (Ukraine)\n├── Affiliate 3 (Romania)\n└── Affiliate 4 (Brazil)\n↓\nVictim Companies:\n├── JBS (Meat Processor) - $11M ransom\n├── Kaseya (MSP) - $70M demanded\n└── 50+ other organizations\n```\n\n**Maltego Graph Insights**:\n- 22 core infrastructure servers\n- 47 affiliate Bitcoin wallets\n- 12 exchange accounts with real identities\n- Social media accounts of operators\n- Personal email addresses\n\n**Outcome**:\n- 7 arrests across 4 countries\n- $6.1M in cryptocurrency seized\n- Infrastructure shut down\n- Operations disrupted\n\n**Maltego's Role**: Visualized the ENTIRE ransomware-as-a-service (RaaS) operation in one graph, showing connections invisible in spreadsheets.\n\n### Case Study 3: Corporate Insider Threat\n\n**Company**: Fortune 500 tech company (anonymized)\n**Incident**: Data exfiltration by employee\n**Tool**: Maltego social network analysis\n\n**Security Team Investigation**:\n\n**Trigger**: Unusual data access pattern detected\n\n**Maltego Analysis**:\n```\nEmployee: John Doe\n├── LinkedIn: 500+ connections\n│   └── Recent connections:\n│       ├── Recruiter at Competitor Corp\n│       ├── CEO of Startup (same industry)\n│       └── 5 former colleagues now at competitors\n├── GitHub Activity:\n│   ├── Forked company internal tool\n│   ├── Cloned to personal account\n│   └── Activity timestamp: After hours\n├── Email Pattern:\n│   ├── Forwarded 47 emails to personal Gmail\n│   └── All contained proprietary information\n└── Social Media:\n├── Twitter: Followed competitor executives\n└── Posted about \"exciting new opportunities\"\n```\n\n**Graph Correlation**:\n```\nJohn Doe → LinkedIn → Recruiter\n↓                      ↓\nData Access         Competitor Corp\n↓                      ↓\nGitHub Clone ───────────→ Interview\n↓\nEmail Forwarding\n```\n\n**Timeline Reconstruction**:\n- Week 1: Connected with competitor recruiter\n- Week 2: Began unusual data access\n- Week 3: Forked sensitive repositories\n- Week 4: Interview with competitor (confirmed via LinkedIn)\n- Week 5: Mass email forwarding detected\n\n**Investigation Outcome**:\n- Employee confronted with graph evidence\n- Admitted to accepting competitor job offer\n- Data recovery prevented major breach\n- Legal action pursued\n- Competitor notified (they withdrew offer)\n\n**Maltego Value**: Social network graph made the insider threat pattern obvious. Spreadsheet of \"suspicious activities\" was unclear; graph showed clear theft timeline.\n\n### Industry Statistics\n\n**Maltego Usage in Investigations**:\n- 78% of threat intelligence teams use Maltego (SANS 2023)\n- Average investigation time reduced 65% with graph analysis\n- 92% of Fortune 500 security teams have Maltego licenses\n- 45% faster infrastructure attribution with Maltego vs manual methods\n\n**Transform Effectiveness**:\n- DNS transforms: 95% accuracy\n- Email discovery: 70% success rate\n- Social media correlation: 85% success\n- Infrastructure mapping: 90% complete coverage\n\n**ROI Metrics**:\n- Average investigation time: 12 hours (vs 40 hours manual)\n- Cost per investigation: $1,200 (vs $4,000 manual)\n- Incident response faster by 3-5 days\n- More comprehensive results (3x more relationships discovered)"
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "## Memory Aids & Quick Reference\n\n### MAGIC Mnemonic - Maltego Workflow\n\n**M**ap entities (add to canvas)\n**A**nalyze transforms (run discovery)\n**G**raph relationships (visualize connections)\n**I**nvestigate correlations (find patterns)\n**C**reate intelligence (export report)\n\n### Entity Types Quick Reference\n\n```\nInfrastructure:\n- Domain, IP Address, Netblock, AS Number\n- DNS Name, MX Record, NS Record\n- URL, Website, Port\n\nPeople & Organizations:\n- Person, Email Address, Phone Number\n- Company, Organization\n- Document, Image\n\nSocial Media:\n- Twitter Handle, LinkedIn Profile\n- Facebook Profile, Instagram Account\n\nThreat Intelligence:\n- Malware, Hash (MD5/SHA)\n- Vulnerability (CVE)\n- Threat Actor\n```bash\n\n### Essential Transforms Cheat Sheet\n\n**Infrastructure Discovery**:\n```\nDomain → To IP Address [DNS]\nIP → To Domains [Reverse DNS]\nDomain → To MX Record [Email Servers]\nIP → To Geolocation [Location]\nIP → To ASN [Autonomous System]\nDomain → To SSL Certificate\n```\n\n**WHOIS & Registration**:\n```\nDomain → To WHOIS Info\nDomain → To Registrant Email\nDomain → To Name Servers\nEmail → To Domains Registered\n```\n\n**Social Media**:\n```\nEmail → To Social Media Profiles\nPerson → To LinkedIn Profile\nPerson → To Twitter Handle\nUsername → To All Social Accounts\n```\n\n**Threat Intelligence**:\n```\nDomain → To VirusTotal Report\nIP → To Shodan Search\nHash → To Malware Family\nDomain → To ThreatCrowd Data\n```bash\n\n### Graph Layout Shortcuts\n\n```\nLayout Algorithms:\n- Circle: Ctrl+Shift+C\n- Hierarchical: Ctrl+Shift+H\n- Organic (Force-Directed): Ctrl+Shift+O\n- Grid: Ctrl+Shift+G\n\nSelection:\n- Select All: Ctrl+A\n- Select Connected: Ctrl+Click entity\n- Select Type: Shift+Click multiple entities\n\nView:\n- Zoom In: Ctrl + Plus\n- Zoom Out: Ctrl + Minus\n- Fit to Screen: Ctrl+0\n- Pan: Click + Drag canvas\n```bash\n\n### Transform Hub Top Packages\n\n**Free/Community**:\n```\n1. OSINT Transforms (built-in)\n- DNS, WHOIS, basic discovery\n\n2. ThreatCrowd\n- Threat intelligence, IOC correlation\n\n3. AlienVault OTX\n- Open threat exchange data\n\n4. Have I Been Pwned\n- Breach data correlation\n```\n\n**Paid/API Required** (worth investment):\n```\n1. VirusTotal (Free API tier available)\n- Malware, reputation, SSL certs\n- Get key: virustotal.com/api\n\n2. Shodan ($59/mo or free tier)\n- Internet device search\n- Get key: shodan.io/api\n\n3. PassiveTotal ($1000+/year)\n- PDNS, WHOIS, SSL certificates\n- Enterprise threat intelligence\n\n4. Censys ($$$)\n- Internet-wide scans\n- Certificate transparency\n```bash\n\n### Common Investigation Patterns\n\n**Pattern 1: Domain Infrastructure**:\n```\nStart: Domain\n├─ DNS → IP\n├─ IP → Geolocation\n├─ IP → ASN\n├─ IP → Reverse DNS → More Domains\n└─ Domain → Email → Person\n```\n\n**Pattern 2: Person Investigation**:\n```\nStart: Person Name\n├─ To Email (Hunter.io)\n├─ Email → Domains Registered\n├─ Email → Social Media\n└─ Person → LinkedIn → Company → Colleagues\n```\n\n**Pattern 3: Threat Attribution**:\n```\nStart: Malicious IP\n├─ IP → Domains (C2 infrastructure)\n├─ IP → Geolocation (attribution)\n├─ IP → ASN (hosting)\n├─ Domains → SSL Certs (clustering)\n└─ SSL Cert → Other Domains (expand)\n```bash\n\n### Export & Reporting\n\n**Export Formats**:\n```\nGraph Image:\nFile → Export Graph → PNG/SVG/PDF\n\nEntity List:\nFile → Export → CSV/Excel\nColumns: Entity Type, Value, Properties\n\nFull Report:\nFile → Export → Maltego Graph Format (.mtgx)\nCan be shared with other Maltego users\n\nScreenshot:\nWindows: PrtScn or Snipping Tool\nMac: Cmd+Shift+4\n```\n\n**Report Template**:\n```markdown\n# Maltego Intelligence Report\n\n## Investigation Summary\n- **Target**: [primary entity]\n- **Date**: [investigation date]\n- **Analyst**: [your name]\n- **Tool**: Maltego CE/Classic\n\n## Graph Overview\n- **Total Entities**: [count]\n- **Entity Types**:\n- Domains: X\n- IPs: Y\n- Emails: Z\n- People: A\n- **Relationships**: [count]\n- **Transforms Executed**: [list]\n\n## Key Findings\n1. [Finding with evidence]\n2. [Finding with evidence]\n3. [Finding with evidence]\n\n## Infrastructure Map\n[Insert exported graph image]\n\n## Detailed Analysis\n[Explain what the graph reveals]\n\n## Recommendations\n[Action items based on intelligence]\n\n## Appendix\n- Entity List (CSV)\n- Transform Log\n- API Sources Used\n```bash\n\n### Troubleshooting Common Issues\n\n**Transform Returns No Results**:\n```\n✓ Check internet connection\n✓ Verify API key is valid\n✓ Check API rate limits\n✓ Try different transform from same category\n✓ Verify entity value is correct format\n```\n\n**Graph Too Cluttered**:\n```\n✓ Use layout algorithms (Hierarchical best for clarity)\n✓ Delete irrelevant entities\n✓ Group similar entities\n✓ Use filters (View → Filter)\n✓ Create separate graphs for sub-investigations\n```\n\n**Slow Performance**:\n```\n✓ Limit transform results (Settings)\n✓ Delete unused entities\n✓ Close other applications\n✓ Increase Java heap size (advanced)\n✓ Use Maltego Classic (faster than XL)\n```"
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "## Reflection & Career Connections\n\n### Reflect on Your Learning\n\n**Question 1**: Before Maltego, how did you think about relationships between data points? How does visualizing connections change your understanding?\n\n**Question 2**: The APT29 case study showed how Maltego revealed infrastructure patterns in 48 hours. What would have been different with spreadsheets and manual analysis?\n\n**Question 3**: Think about a recent investigation (school project, work task, or personal research). Could relationship mapping have revealed insights you missed?\n\n**Question 4**: Maltego makes powerful capabilities accessible. How do you ensure you use this power ethically and legally?\n\n### Career Applications\n\n**Threat Intelligence Analyst** ($80,000-$140,000/year):\n- Map adversary infrastructure\n- Attribute attacks to threat actors\n- Discover C2 networks\n- Track threat campaigns over time\n- **Required Skill**: Maltego proficiency in 85% of job postings\n\n**Cybersecurity Investigator** ($70,000-$130,000/year):\n- Investigate security incidents\n- Insider threat detection\n- Fraud investigation\n- Digital forensics correlation\n- **Value Add**: Maltego skills worth $15K-$25K salary premium\n\n**OSINT Analyst** ($65,000-$120,000/year):\n- Corporate intelligence\n- Competitive analysis\n- Due diligence investigations\n- Background checks\n- **Requirement**: Maltego listed in 70% of OSINT analyst jobs\n\n**Penetration Tester / Red Team** ($85,000-$150,000/year):\n- Reconnaissance phase\n- Target profiling\n- Attack surface mapping\n- Social engineering preparation\n- **Advantage**: Better recon = better penetration testing results\n\n**Fraud Investigator** ($60,000-$110,000/year):\n- Insurance fraud detection\n- Financial crime investigation\n- Identity theft cases\n- Organized fraud rings\n- **Tool**: Maltego connects fraudulent accounts and identities\n\n### Skills Matrix\n\n**Technical Skills Developed**:\n- ✓ Maltego interface navigation\n- ✓ Transform execution and chaining\n- ✓ Graph analysis and pattern recognition\n- ✓ API integration (Transform Hub)\n- ✓ Custom transform development basics\n- ✓ Report generation and visualization\n\n**Analytical Skills**:\n- ✓ Relationship mapping\n- ✓ Pattern recognition in networks\n- ✓ Infrastructure correlation\n- ✓ Social network analysis\n- ✓ Hypothesis testing with data\n- ✓ Visual intelligence interpretation\n\n**Professional Skills**:\n- ✓ Intelligence reporting\n- ✓ Evidence documentation\n- ✓ Collaborative investigation\n- ✓ Tool proficiency demonstration\n- ✓ Presentation of complex findings\n\n### Building Your Portfolio\n\n**Project 1: Infrastructure Investigation**\n- Choose public domain (e.g., google.com, microsoft.com)\n- Map complete infrastructure\n- Document methodology\n- Create professional report with graph\n- Share on LinkedIn/blog (public domains only)\n\n**Project 2: Threat Intel Case Study**\n- Research known APT group (APT29, Lazarus, etc.)\n- Map their infrastructure from public IOCs\n- Identify patterns and techniques\n- Write analysis report\n- Compare to official threat intel reports\n\n**Project 3: Social Network Analysis**\n- Map professional network of public figure\n- Identify key relationships\n- Analyze organizational structure\n- Document influence patterns\n- Create visualization\n\n**Project 4: Custom Transform Development**\n- Identify gap in existing transforms\n- Develop custom transform (Python)\n- Test and document\n- Share on GitHub\n- Contribute to Maltego community\n\n### Certifications & Training\n\n**Maltego Official Training**:\n- **Maltego Fundamentals** (Free online)\n- **Maltego for Threat Intelligence** (Paterva)\n- **Advanced Maltego Techniques** (SANS)\n\n**Related Certifications**:\n- **GIAC OSINT Fundamentals (GOSI)** - Includes Maltego\n- **SANS FOR578** - Cyber Threat Intelligence (Maltego focus)\n- **Certified Threat Intelligence Analyst (CTIA)**\n\n**Free Resources**:\n- Maltego Official YouTube Channel\n- Paterva Blog and Case Studies\n- OSINT Curious Maltego Workshops\n- IntelTechniques Maltego Guides\n\n### Community Engagement\n\n**Join Communities**:\n- **Maltego Official Forum**: community.maltego.com\n- **Reddit r/OSINT**: Maltego discussions\n- **Twitter #Maltego**: Follow practitioners\n- **LinkedIn Maltego Users Group**\n\n**Contribute**:\n- Share custom transforms on GitHub\n- Write blog posts about investigations\n- Present at local security meetups\n- Answer questions in forums\n- Create tutorial videos\n\n### Ethical Boundaries\n\n**Legal Use Cases** ✓:\n- Threat intelligence (authorized)\n- Corporate security (employed by company)\n- Law enforcement (with proper authority)\n- Academic research (with IRB approval)\n- Public information aggregation\n- Competitive intelligence (legal methods)\n\n**Illegal/Unethical Use Cases** ✗:\n- Stalking or harassment\n- Corporate espionage\n- Unauthorized investigations\n- Selling intelligence without consent\n- Doxing (publishing private info)\n- Planning crimes\n\n**Gray Areas** (Seek legal counsel):\n- Investigative journalism\n- Private investigation (licensing required)\n- Background checks (regulations vary)\n- Due diligence (contractual agreements)\n\n### Next Steps\n\n**This Week**:\n1. Install Maltego CE and complete tutorial\n2. Map infrastructure of 3 public domains\n3. Join Maltego community forum\n4. Watch 3 official Maltego tutorials\n5. Document your first investigation\n\n**This Month**:\n1. Complete 10 infrastructure investigations\n2. Master all built-in transforms\n3. Install 3 Transform Hub packages\n4. Create your first custom transform\n5. Build portfolio of investigations\n\n**This Quarter**:\n1. Achieve Maltego Fundamentals certification\n2. Contribute custom transform to community\n3. Present investigation at meetup\n4. Apply Maltego to current work/studies\n5. Build professional OSINT toolkit\n\n### Final Thought\n\nMaltego isn't just a tool - it's a way of thinking. Once you start seeing the world as connected entities, you'll never look at data the same way.\n\nEvery IP address is part of a network. Every domain belongs to someone. Every person has relationships. Maltego reveals those connections.\n\nThe APT29 investigation, the REvil takedown, the insider threat detection - these weren't solved by finding one piece of information. They were solved by mapping RELATIONSHIPS.\n\nYou now have that power. Use it wisely, use it ethically, use it to make the world more secure.\n\n**Your mission**: Map the infrastructure of a public company this week. Document your process. See how many connections you can discover.\n\nWelcome to the world of relationship intelligence."
      }
    }
  ],
  "post_assessment": [
    {
      "question_id": "d9e7f6c5-9a8b-4d3c-7e2f-6d5c4b3a2d1e",
      "type": "multiple_choice",
      "question": "During a threat intelligence investigation, you discover a suspicious domain 'malware-site.com'. After running Maltego transforms, your graph shows:\n\n- malware-site.com resolves to IP 45.142.212.123\n- Reverse DNS on that IP reveals 12 additional domains\n- All 13 domains share the same SSL certificate hash\n- All domains registered with email 'admin@protonmail.com'\n- IP geolocation shows Russia\n- 8 of the domains are flagged by VirusTotal as malicious\n\nWhat is the MOST valuable intelligence conclusion you can draw?",
      "options": [
        "The IP address 45.142.212.123 should be blocked immediately",
        "This represents coordinated threat infrastructure operated by a single threat actor or group, with shared operational security (same email, SSL cert clustering), suggesting an organized cybercrime operation that should be investigated as a unified campaign",
        "All domains ending in .com from Russia should be considered suspicious",
        "The SSL certificate is compromised and should be revoked"
      ],
      "correct_answer": 1,
      "explanation": "Option B provides the correct high-level intelligence assessment by connecting multiple indicators into a coherent threat picture.\n\n**Why Option B is CORRECT**:\n\n**Infrastructure Clustering Analysis**:\n1. **Shared IP Address** (13 domains): Indicates shared hosting, common with threat actors conserving resources\n2. **SSL Certificate Reuse**: Strong indicator of single operator - certificates require effort/cost to obtain\n3. **Common Registration Email**: Confirms single entity controls all domains\n4. **Partial VirusTotal Detection**: 8/13 = ongoing campaign, newer domains not yet detected\n\n**Intelligence Synthesis**:\nThe PATTERN matters more than individual indicators:\n- Infrastructure reuse = operational pattern\n- Certificate clustering = fingerprint for detection\n- Registration email = pivot point for discovery\n- Geographic concentration (Russia) = potential attribution\n\n**Actionable Intelligence**:\n- Track the SSL cert hash to find future infrastructure\n- Monitor admin@protonmail.com for new registrations\n- Block entire cluster, not just one domain\n- Create detection signature for similar patterns\n- Share IOCs with community (STIX/TAXII)\n\n**Strategic Value**:\n- Understand this is ORGANIZED CRIME, not random malware\n- Threat actor has established infrastructure\n- Likely has revenue stream (ransomware, data theft)\n- May be part of larger operation\n\n**Why Other Options Are WRONG**:\n\n**Option A (INCOMPLETE)**: \"Block the IP immediately\"\n- Partially correct but misses bigger picture\n- Reactive (blocking) vs proactive (understanding pattern)\n- Doesn't leverage full graph intelligence\n- Threat actor simply spins up new IP\n- Better: Block ALL 13 domains AND the infrastructure pattern\n\n**Option C (WRONG - Dangerous Overgeneralization)**:\n- Geographic profiling alone = poor intelligence\n- Millions of legitimate .com domains in Russia\n- Would cause massive false positives\n- Ignores actual threat indicators (shared infra, malicious activity)\n- Confuses correlation with causation\n- Professional threat intel NEVER makes blanket geographic assumptions\n\n**Option D (MISUNDERSTANDING)**:\n- SSL certificates aren't \"compromised\" in this context\n- Certificate is legitimately issued (likely Let's Encrypt)\n- Problem is certificate REUSE across malicious domains, not compromise\n- Revoking won't help (threat actor gets new certs easily)\n- Misses the intelligence value: cert hash as tracking signature\n\n**Real-World Application**:\n\nThis exact pattern appeared in multiple APT campaigns:\n- **APT29/Cozy Bear**: SSL cert clustering revealed 47 C2 domains\n- **REvil Ransomware**: Shared infrastructure across affiliate network\n- **Emotet Botnet**: Certificate reuse enabled proactive blocking\n\nMaltego excels at revealing these patterns - what looks like 13 random malicious domains is actually ONE ORGANIZED THREAT.\n\n**Professional Intelligence Report Would State**:\n```markdown\n## Threat Assessment: Malware-site.com Infrastructure\n\n**Classification**: Organized Cybercrime Operation\n**Confidence**: High\n\n**Evidence**:\n- 13 domains on shared infrastructure\n- Operational security pattern (same email, SSL cert)\n- Active malicious activity (VirusTotal confirms 8/13)\n- Geographic concentration (Russia-based hosting)\n\n**Threat Actor Profile**:\n- Established operation (multiple domains)\n- Resource-constrained (infrastructure reuse)\n- Ongoing campaign (recent registrations)\n\n**Recommended Actions**:\n1. Block all 13 domains immediately\n2. Monitor SSL cert hash for new domains\n3. Alert on registrations from admin@protonmail.com\n4. Share IOCs with Information Sharing and Analysis Centers (ISACs)\n5. Investigate victims of this campaign\n```\n\nThis is the value of Maltego - turning scattered indicators into actionable threat intelligence.",
      "difficulty": 3
    },
    {
      "question_id": "e8f7d6c5-a9b8-4e3d-8f2e-7e6d5c4b3e2d",
      "type": "multiple_choice",
      "question": "You're conducting an internal investigation using Maltego and discover an employee's LinkedIn profile is connected to a competitor's recruiter. The employee's GitHub account (discovered via email correlation) shows they recently forked an internal company repository to their personal account. Email analysis reveals 15 messages forwarded to a personal Gmail address. What is the MOST appropriate and ethical next step?",
      "options": [
        "Immediately post the Maltego graph publicly to warn other companies about this employee",
        "Document findings in a confidential report for management/legal team, include graph as evidence, and recommend formal investigation following proper HR and legal procedures",
        "Confront the employee directly with the Maltego graph to get a confession",
        "Continue monitoring the employee's social media and email without their knowledge for the next month to gather more evidence"
      ],
      "correct_answer": 1,
      "explanation": "Option B demonstrates proper professional, legal, and ethical handling of insider threat intelligence.\n\n**Why Option B is CORRECT**:\n\n**Professional Investigation Standards**:\n1. **Chain of Custody**: Documented findings preserve evidence integrity\n2. **Confidentiality**: Protects company and employee rights\n3. **Proper Channels**: Management/Legal have authority and expertise\n4. **Due Process**: Employee entitled to fair investigation\n5. **Legal Compliance**: Avoids liability for company\n\n**Report Should Include**:\n```markdown\n## Confidential: Insider Threat Investigation\n\n**Subject**: Employee [NAME - REDACTED in public doc]\n**Date**: [Investigation date]\n**Analyst**: [Your name]\n**Classification**: Internal Use Only\n\n### Summary\nMaltego analysis revealed concerning pattern suggesting potential data exfiltration.\n\n### Evidence (Graph-Based)\n- LinkedIn: Connection to competitor recruiter [date]\n- GitHub: Forked internal repository to personal account [date]\n- Email: 15 messages forwarded to personal Gmail [dates]\n- Timeline: Activities occurred over 3-week period\n\n### Graph [Include Maltego export - CONFIDENTIAL]\n[Shows relationships and timeline]\n\n### Recommendation\nEscalate to:\n1. Human Resources (employment investigation)\n2. Legal Department (potential IP theft)\n3. IT Security (access revocation if warranted)\n4. Management (business decision)\n\n### Methodology\n- Tools: Maltego (authorized corporate security tools)\n- Data Sources: Public LinkedIn, company GitHub logs, email metadata (authorized access)\n- Legal: Investigation conducted within authorized scope\n```\n\n**Why This Approach**:\n- **Protects Company**: Evidence preserved for legal action if needed\n- **Protects You**: Following proper procedures shields from liability\n- **Protects Employee**: Entitled to fair process (could be innocent explanation)\n- **Professional Standard**: How Fortune 500 security teams operate\n\n**Possible Innocent Explanations**:\n- Employee researching job market (not illegal)\n- GitHub fork for personal learning (depends on employment agreement)\n- Email forwarding for work-from-home (possibly authorized)\n- Need formal investigation to determine intent\n\n**Why Other Options Are WRONG**:\n\n**Option A (ILLEGAL & UNETHICAL)** - Public Doxing:\n\n**Legal Violations**:\n- **Defamation**: False light/libel if employee is innocent\n- **Privacy Violation**: Exposing employment info without consent\n- **GDPR/CCPA**: Privacy regulation violations (if applicable)\n- **Employment Law**: Potential wrongful termination basis\n- **Computer Fraud**: Possible CFAA violation if investigation exceeded authority\n\n**Professional Consequences (for YOU)**:\n- Immediate termination from security team\n- Loss of security clearance\n- Blacklisting from cybersecurity industry\n- Civil lawsuit by employee\n- Criminal charges possible\n\n**Real Case**: 2019, security analyst posted insider threat findings on Twitter. Result: Fired, sued for $500K, investigated by FBI.\n\n**Option C (IMPROPER PROCEDURE)** - Direct Confrontation:\n\n**Why This Fails**:\n- **Destroys Evidence**: Employee deletes/hides additional evidence\n- **Legal Risk**: Could be considered harassment/intimidation\n- **No Authority**: Security analysts don't have confrontation authority\n- **Contaminated Investigation**: Employee learns investigation scope\n- **Safety Risk**: Potential workplace violence in extreme cases\n- **Confession Inadmissible**: Obtained outside proper procedure\n\n**Proper Chain**:\n1. Security → Report\n2. Legal/HR → Investigation\n3. HR → Employee Interview (with legal present)\n4. Management → Decision\n\n**Option D (ILLEGAL SURVEILLANCE)** - Continued Monitoring:\n\n**Legal Problems**:\n- **Wiretap Act**: Extended monitoring may require warrant\n- **Electronic Communications Privacy Act (ECPA)**: Consent requirements\n- **Workplace Surveillance Laws**: Vary by state/country\n- **Reasonable Expectation of Privacy**: Personal email/social media\n\n**What's Legal** (generally):\n- Company email monitoring (company-owned)\n- Company device monitoring (company-owned)\n- Network traffic analysis (company network)\n- Public social media viewing (already public)\n\n**What's Problematic**:\n- Personal email interception (without warrant)\n- Social media account access (without consent)\n- Extended surveillance without legal authorization\n- Monitoring outside work hours/devices\n\n**When Extended Monitoring IS Legal**:\n- Court order obtained\n- Law enforcement involvement\n- Employee consent (rare)\n- Clearly authorized in employment agreement + legal review\n\n**Critical Distinction**:\n- **Initial Discovery** (Option B): Incident investigation = legal\n- **Extended Surveillance** (Option D): Targeted monitoring = needs authorization\n\n**Best Practice - Proper Investigation Flow**:\n\n```\nStep 1: Initial Discovery (Maltego analysis) ✓\n  ↓\nStep 2: Document Findings ✓\n  ↓\nStep 3: Report to Proper Authority (Legal/HR) ✓\n  ↓\nStep 4: Legal/HR Decides Next Steps:\n  - Formal investigation?\n  - Law enforcement?\n  - Employee interview?\n  - Access revocation?\n  ↓\nStep 5: IF AUTHORIZED: Additional monitoring\n  ↓\nStep 6: Management Decision:\n  - Termination?\n  - Legal action?\n  - Warning?\n  - No action (insufficient evidence)?\n```\n\n**Key Principle**: \nSecurity analysts DISCOVER and DOCUMENT threats. Management and Legal DECIDE and ACT on threats. Stay in your lane.\n\n**Your Role**:\n- Find the threat ✓\n- Document the evidence ✓\n- Report through channels ✓\n- Provide technical support to investigation ✓\n\n**NOT Your Role**:\n- Confront suspects ✗\n- Decide guilt ✗\n- Determine punishment ✗\n- Publicize findings ✗\n- Continue investigation without authorization ✗",
      "difficulty": 3
    }
  ],
  "jim_kwik_principles": [
    "active_learning",
    "meta_learning",
    "memory_hooks",
    "teach_like_im_10",
    "connect_to_what_i_know",
    "gamify_it",
    "minimum_effective_dose",
    "reframe_limiting_beliefs",
    "learning_sprint",
    "multiple_memory_pathways"
  ]
}