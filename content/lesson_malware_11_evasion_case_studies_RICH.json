{
  "lesson_id": "42f2f269-a185-4a88-86ba-d9d2ba285ce8",
  "domain": "malware",
  "title": "Malware Evasion Case Studies",
  "subtitle": "Analysing top techniques and defender countermeasures",
  "difficulty": 3,
  "estimated_time": 55,
  "order_index": 11,
  "prerequisites": [
    "Advanced Malware Analysis",
    "Rootkits and Bootkits Analysis"
  ],
  "concepts": [
    "Packer and crypter chains",
    "Process injection variations",
    "API unhooking and ETW tampering",
    "Sleep obfuscation and timing tricks",
    "Virtualisation and sandbox detection",
    "Living-off-the-land binaries",
    "Signed binary abuse",
    "Command-and-control evasion",
    "Defender telemetry gaps",
    "Mitigation and detection strategies"
  ],
  "learning_objectives": [
    "Dissect real-world malware samples to identify layered evasion techniques",
    "Understand how adversaries tamper with Windows telemetry (ETW, AMSI)",
    "Map evasion behaviours to MITRE ATT&CK TTPs for detection engineering",
    "Design countermeasures such as memory scanning, behavioural analytics, and script control",
    "Communicate findings to defenders for rapid detection uplift",
    "Incorporate evasion awareness into malware analysis workflows"
  ],
  "content_blocks": [
    {
      "block_id": "d7595278-8401-44bb-b56f-eacf27379fe4",
      "type": "mindset_coach",
      "title": "Stay Humble, Stay Curious",
      "content": {
        "text": "Evasion techniques evolve daily. Approach each sample with humility\u2014expect surprises\u2014and curiosity to unravel each layer."
      },
      "simplified_explanation": "Assume malware authors are clever; be more curious than they are sneaky.",
      "memory_aids": [
        "Curiosity defeats complacency"
      ],
      "real_world_connection": "Reverse engineers thrive when they enjoy the puzzle, not just the answer.",
      "reflection_prompt": "What evasion trick surprised you recently?",
      "is_interactive": false,
      "xp_reward": 0
    },
    {
      "block_id": "9b164659-bb33-4717-b9e6-72a0c9dde6e2",
      "type": "explanation",
      "title": "Layered Evasion Patterns",
      "content": {
        "text": "## E.V.A.D.E.\n- **E**ntry packaging (packers/cryters).\n- **V**irtual environment detection.\n- **A**nti-analysis (ETW/AMSI tampering).\n- **D**ormant timers and sleep obfuscation.\n- **E**xecution via trusted binaries."
      },
      "simplified_explanation": "Use EVADE to remember the evasion chain.",
      "memory_aids": [
        "Entry \u2192 Virtual checks \u2192 Anti-analysis \u2192 Dormant \u2192 Execution"
      ],
      "real_world_connection": "Recent campaigns like Emotet and TrickBot exhibit these layers.",
      "reflection_prompt": "Which EVADE step is hardest for your tooling to detect?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "ea456b46-0679-42d0-957d-3eb665886fcb",
      "type": "video",
      "title": "Malware Evasion Deep Dive",
      "content": {
        "resources": "Watch a reverse engineer analyse modern evasion techniques.\n\n**Video**: [How does Malware bypass Antivirus Software? #coding #reverseengineering](https://www.youtube.com/watch?v=FKyElLsHJ3E)\n\nPay attention to API unhooking demos and ETW tampering walkthroughs."
      },
      "simplified_explanation": "See evasion tactics unfold and note the defender tips.",
      "memory_aids": [
        "Pause after each tactic and add countermeasure ideas"
      ],
      "real_world_connection": "Clip based on incident response experience shared at a malware conference.",
      "reflection_prompt": "Which countermeasure will you prototype after the video?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "93642379-207e-4d44-8a7b-13863bd265d1",
      "type": "memory_aid",
      "title": "DEFEND Counterpoints",
      "content": {
        "text": "### D.E.F.E.N.D.\n- **D**etect unusual packer behaviours.\n- **E**nable AMSI/ETW hardening and monitoring.\n- **F**lag suspicious LOLBIN usage.\n- **E**stablish memory scanning baselines.\n- **N**otify on anomalous sleep patterns.\n- **D**ocument detection gaps for follow-up."
      },
      "simplified_explanation": "DEFEND pairs with EVADE to guide countermeasures.",
      "memory_aids": [
        "Detect \u2192 Enable \u2192 Flag \u2192 Establish \u2192 Notify \u2192 Document"
      ],
      "real_world_connection": "Security engineers track DEFEND actions in their detection roadmap.",
      "reflection_prompt": "Which DEFEND action will you prioritise next?",
      "is_interactive": false,
      "xp_reward": 5
    },
    {
      "block_id": "57639b84-7b7b-4ae4-85ff-1e18db322b57",
      "type": "real_world",
      "title": "Field Example: FIN7 Loader",
      "content": {
        "text": "FIN7 used a multi-stage loader with packers, delayed execution, and ETW unhooking to evade EDR. Analysts created YARA rules targeting the unpacked payload, deployed Sysmon configs for LOLBIN monitoring, and collaborated with Microsoft to strengthen AMSI protections."
      },
      "simplified_explanation": "Layered defence closed gaps highlighted by the loader's evasion chain.",
      "memory_aids": [
        "Layered detection beats layered evasion"
      ],
      "real_world_connection": "Case discussed in an open threat report.",
      "reflection_prompt": "How would you brief defenders on this case to motivate action?",
      "is_interactive": false,
      "xp_reward": 10
    },
    {
      "block_id": "7df76daa-7d24-4ea0-ab43-dda0d04e6184",
      "type": "simulation",
      "title": "Evasion Playbook Lab",
      "content": {
        "text": "1. Analyse a benign sample instrumented with evasion techniques (packer + sleep obfuscation).\n2. Document each evasion layer and propose detection ideas.\n3. Map behaviours to ATT&CK techniques and create hunt queries.\n4. Draft a briefing for SOC engineers outlining countermeasures."
      },
      "simplified_explanation": "Practise translating analysis into actionable detection work.",
      "memory_aids": [
        "Analyse \u2192 Map \u2192 Hunt \u2192 Brief"
      ],
      "real_world_connection": "Malware labs emulate this workflow before publishing detection updates.",
      "reflection_prompt": "Which detection idea will you convert into a rule within the next sprint?",
      "is_interactive": true,
      "xp_reward": 25
    },
    {
      "block_id": "ace54213-4b70-43f9-a026-5dd217af2185",
      "type": "reflection",
      "title": "Teach Back the Case Study",
      "content": {
        "text": "### Reflect & Teach\n- Explain the EVADE chain and DEFEND counterpoints to a defender.\n- List two detection enhancements you will pilot.\n- Identify one knowledge gap you will research (e.g., ETW internals, anti-VM techniques)."
      },
      "simplified_explanation": "Teaching closes the loop between analysis and defence.",
      "memory_aids": [
        "Explain \u2192 Enhance \u2192 Explore"
      ],
      "real_world_connection": "Reverse engineers routinely brief SOC teams using this structure.",
      "reflection_prompt": "Who will you brief and what support do you need to implement countermeasures?",
      "is_interactive": false,
      "xp_reward": 5
    }
  ],
  "pre_assessment": null,
  "post_assessment": [
    {
      "question_id": "q1",
      "type": "multiple_choice",
      "question": "Why do malware authors tamper with ETW or AMSI?",
      "options": [
        "To speed up execution",
        "To disable security telemetry and avoid detection",
        "To ensure compatibility with Linux",
        "To reduce payload size"
      ],
      "correct_answer": 1,
      "explanation": "Tampering with ETW/AMSI suppresses telemetry that defenders rely on to detect malicious behaviour.",
      "difficulty": 3,
      "memory_aid": "Tamper = telemetry blind spot",
      "points": 10
    },
    {
      "question_id": "q2",
      "type": "multiple_choice",
      "question": "What defender action counters sleep obfuscation techniques?",
      "options": [
        "Disabling Sysmon",
        "Using behavioural analytics that flag unusual sleep patterns",
        "Shortening sleep times to 1ms",
        "Blocking all signed binaries"
      ],
      "correct_answer": 1,
      "explanation": "Behaviour-based detections can highlight anomalous sleep loops typical of evasion.",
      "difficulty": 3,
      "memory_aid": "Behaviour analytics beat timing tricks",
      "points": 10
    },
    {
      "question_id": "q3",
      "type": "multiple_choice",
      "question": "How can living-off-the-land binaries aid evasion?",
      "options": [
        "They automatically patch vulnerabilities",
        "They blend malicious actions with trusted system tools",
        "They disable antivirus completely",
        "They require kernel drivers"
      ],
      "correct_answer": 1,
      "explanation": "Attackers abuse legitimate binaries to appear benign and bypass allow-lists.",
      "difficulty": 3,
      "memory_aid": "LOLBIN = trusted disguise",
      "points": 10
    }
  ],
  "mastery_threshold": 80,
  "jim_kwik_principles": [
    "active_learning",
    "minimum_effective_dose",
    "teach_like_im_10",
    "memory_hooks",
    "meta_learning",
    "connect_to_what_i_know",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "base_xp_reward": 150,
  "badge_unlock": null,
  "is_core_concept": false,
  "created_at": "2025-10-28T15:42:00",
  "updated_at": "2025-10-28T15:42:00",
  "author": "CyberLearn Advanced Curriculum Team",
  "version": "2.1"
}
