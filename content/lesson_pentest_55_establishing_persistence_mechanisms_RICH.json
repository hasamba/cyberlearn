{
  "lesson_id": "f2395bcf-8105-4e14-8758-39befd216472",
  "domain": "pentest",
  "title": "Establishing Persistence Mechanisms",
  "subtitle": "Section 5: Post-Exploitation Focus on WMI Event Subscription persistence",
  "difficulty": 3,
  "estimated_time": 56,
  "order_index": 55,
  "prerequisites": [
    "2bf59677-b9e4-4d61-b862-f009fb6ef03e",
    "8f5a4cb5-544e-40e4-8c35-c6585693cd3b",
    "e6cdacfe-c3df-44d7-860d-6ed17c431cdc",
    "ecb62c40-10a5-41de-9578-9ddf9163375f",
    "796a92e2-dd80-4df5-a729-803dd46f57d1",
    "3ef72aa3-5630-4b62-864f-d9185382b2dd"
  ],
  "concepts": [
    "WMI Event Subscription persistence",
    "Golden Ticket attacks",
    "web shell persistence",
    "cloud backdoor accounts (AWS/Azure/GCP)",
    "multi-platform persistence"
  ],
  "learning_objectives": [
    "Summarize why Establishing Persistence Mechanisms matters for penetration testing operations and how it guides decision-making.",
    "Apply WMI Event Subscription persistence and Golden Ticket attacks to a scripted incident and document the workflow.",
    "Evaluate telemetry, communication, and automation opportunities discovered while rehearsing Establishing Persistence Mechanisms.",
    "Coach peers through the lesson structure and record measurable improvements across the team."
  ],
  "post_assessment": [
    {
      "question": "How does WMI Event Subscription persistence strengthen the Establishing Persistence Mechanisms workflow?",
      "options": [
        "It distracts penetration testers from penetration testing operations priorities by focusing on unrelated administrative work.",
        "It guides penetration testers to gather evidence, compare telemetry, and communicate findings tied to penetration testing operations.",
        "It encourages teams to skip documentation and rely on ad-hoc conversations during crises.",
        "It replaces the need for collaboration with external partners and legal advisors."
      ],
      "correct_answer": 1,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "39044877-6742-4f21-8f8d-e02f751e4c03",
      "explanation": "WMI Event Subscription persistence provides structure for capturing observations, testing hypotheses, and looping in stakeholders so the Establishing Persistence Mechanisms process consistently improves."
    },
    {
      "question": "How does Golden Ticket attacks strengthen the Establishing Persistence Mechanisms workflow?",
      "options": [
        "It distracts penetration testers from penetration testing operations priorities by focusing on unrelated administrative work.",
        "It guides penetration testers to gather evidence, compare telemetry, and communicate findings tied to penetration testing operations.",
        "It encourages teams to skip documentation and rely on ad-hoc conversations during crises.",
        "It replaces the need for collaboration with external partners and legal advisors."
      ],
      "correct_answer": 1,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "ec7c63e6-0030-432c-a44f-eb1634c5137f",
      "explanation": "Golden Ticket attacks provides structure for capturing observations, testing hypotheses, and looping in stakeholders so the Establishing Persistence Mechanisms process consistently improves."
    },
    {
      "question": "How does web shell persistence strengthen the Establishing Persistence Mechanisms workflow?",
      "options": [
        "It distracts penetration testers from penetration testing operations priorities by focusing on unrelated administrative work.",
        "It guides penetration testers to gather evidence, compare telemetry, and communicate findings tied to penetration testing operations.",
        "It encourages teams to skip documentation and rely on ad-hoc conversations during crises.",
        "It replaces the need for collaboration with external partners and legal advisors."
      ],
      "correct_answer": 1,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "15e8013a-b978-4da0-a122-07f71c7a771a",
      "explanation": "web shell persistence provides structure for capturing observations, testing hypotheses, and looping in stakeholders so the Establishing Persistence Mechanisms process consistently improves."
    },
    {
      "question": "How does cloud backdoor accounts (AWS/Azure/GCP) strengthen the Establishing Persistence Mechanisms workflow?",
      "options": [
        "It distracts penetration testers from penetration testing operations priorities by focusing on unrelated administrative work.",
        "It guides penetration testers to gather evidence, compare telemetry, and communicate findings tied to penetration testing operations.",
        "It encourages teams to skip documentation and rely on ad-hoc conversations during crises.",
        "It replaces the need for collaboration with external partners and legal advisors."
      ],
      "correct_answer": 1,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "b15bac51-9c75-4893-a79b-9d07b69cbbbf",
      "explanation": "cloud backdoor accounts (AWS/Azure/GCP) provides structure for capturing observations, testing hypotheses, and looping in stakeholders so the Establishing Persistence Mechanisms process consistently improves."
    }
  ],
  "jim_kwik_principles": [
    "teach_like_im_10",
    "memory_hooks",
    "connect_to_what_i_know",
    "active_learning",
    "meta_learning",
    "minimum_effective_dose",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "content_blocks": [
    {
      "type": "explanation",
      "content": {
        "text": "### Section 5: Post-Exploitation – Establishing Persistence Mechanisms\n\nPenetration testers rely on **Establishing Persistence Mechanisms** to express why this portion of the curriculum matters. The lesson connects strategy and day-to-day execution so the team can describe what good looks like when safeguarding penetration testing operations.\n\nRemember from the planning notes: Maintaining access\n\nWMI Event Subscription persistence keeps penetration testers grounded in repeatable practice. Within penetration testing operations, this element clarifies how to brief peers, review telemetry, and translate the section 5: post-exploitation commitments into measurable action. Kickoff workshops should document baseline data, escalation triggers, and links to automation backlogs so the entire unit understands how wmi event subscription persistence supports resilience and recovery.\n\nGolden Ticket attacks keeps penetration testers grounded in repeatable practice. Within penetration testing operations, this element clarifies how to brief peers, review telemetry, and translate the section 5: post-exploitation commitments into measurable action. Kickoff workshops should document baseline data, escalation triggers, and links to automation backlogs so the entire unit understands how golden ticket attacks supports resilience and recovery.\n\nweb shell persistence keeps penetration testers grounded in repeatable practice. Within penetration testing operations, this element clarifies how to brief peers, review telemetry, and translate the section 5: post-exploitation commitments into measurable action. Kickoff workshops should document baseline data, escalation triggers, and links to automation backlogs so the entire unit understands how web shell persistence supports resilience and recovery.\n\nClose the section by capturing success metrics, owner assignments, and retrospectives that prove the establishing persistence mechanisms habits are embedded across the program."
      }
    },
    {
      "type": "video",
      "content": {
        "text": "https://www.youtube.com/watch?v=VqDY2Tfz6Qw — Black Hills Information Security dissects offensive playbooks with live tooling, reinforcing the offensive concepts you will rehearse in this lesson."
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "### Section 5: Post-Exploitation – Establishing Persistence Mechanisms\n\nPenetration testers rely on **Establishing Persistence Mechanisms** to express why this portion of the curriculum matters. The lesson connects strategy and day-to-day execution so the team can describe what good looks like when safeguarding penetration testing operations.\n\nRemember from the planning notes: Maintaining access\n\ncloud backdoor accounts (AWS/Azure/GCP) keeps penetration testers grounded in repeatable practice. Within penetration testing operations, this element clarifies how to brief peers, review telemetry, and translate the section 5: post-exploitation commitments into measurable action. Deep-dive workshops should document baseline data, escalation triggers, and links to automation backlogs so the entire unit understands how cloud backdoor accounts (aws/azure/gcp) supports resilience and recovery.\n\nmulti-platform persistence keeps penetration testers grounded in repeatable practice. Within penetration testing operations, this element clarifies how to brief peers, review telemetry, and translate the section 5: post-exploitation commitments into measurable action. Deep-dive workshops should document baseline data, escalation triggers, and links to automation backlogs so the entire unit understands how multi-platform persistence supports resilience and recovery.\n\nClose the section by capturing success metrics, owner assignments, and retrospectives that prove the establishing persistence mechanisms habits are embedded across the program."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "## Hands-on Simulation for Establishing Persistence Mechanisms\n\nSet up a sandbox aligned with section 5: post-exploitation commitments. The goal is to narrate every investigative move so penetration testers can replay the workflow with new data sets.\n\n1. Draft a playbook segment around **WMI Event Subscription persistence**. Identify required tooling, the evidence collected, and the triage decisions the team must make. Capture command output, dashboards, and analyst notes.\n\n2. Draft a playbook segment around **Golden Ticket attacks**. Identify required tooling, the evidence collected, and the triage decisions the team must make. Capture command output, dashboards, and analyst notes.\n\n3. Draft a playbook segment around **web shell persistence**. Identify required tooling, the evidence collected, and the triage decisions the team must make. Capture command output, dashboards, and analyst notes.\n\n4. Draft a playbook segment around **cloud backdoor accounts (AWS/Azure/GCP)**. Identify required tooling, the evidence collected, and the triage decisions the team must make. Capture command output, dashboards, and analyst notes.\n\n5. Draft a playbook segment around **multi-platform persistence**. Identify required tooling, the evidence collected, and the triage decisions the team must make. Capture command output, dashboards, and analyst notes.\n\nAfter the walkthrough, schedule a peer review. Each analyst explains what worked, what required escalation, and how to automate repetitive steps without losing investigative rigor.\n\nFinish by updating the runbook, linking recorded sessions, and tagging knowledge base articles so future rotations learn from the exercise."
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "## Case Study: Applying Establishing Persistence Mechanisms\n\nA regional team experienced a high-pressure incident that exposed gaps in penetration testing operations. Penetration testers regrouped and replayed the timeline using the lesson structure from Establishing Persistence Mechanisms.\n\nThey cataloged the signals they missed, the collaboration friction they encountered, and the stakeholders who needed clearer communication. By aligning remediation tasks to the lesson structure, they closed visibility gaps and launched new detection backlogs.\n\nDuring the postmortem, the team recorded how executive updates, compliance obligations, and vendor coordination all tied back to the lesson pillars. This ensured future incidents would follow a confident, rehearsed pathway to containment.\n\nPlanning reminder: Maintaining access"
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "## Memory Architectures\n\n### Mnemonic: EPM\n\nAssociate the acronym with the mission of this lesson. Visualize a war room where each station is labeled with these initials, reminding the crew how to defend penetration testing operations under stress.\n\n- E – WMI Event Subscription persistence\n- P – Golden Ticket attacks\n- M – web shell persistence\n\n### Mnemonic: EPM\n\nUse this alternate mnemonic to trigger rapid debriefs. Picture sticky notes, dashboards, and alerts all echoing these letters so the practice becomes muscle memory.\n\n- E – Lessons Learned\n- P – Resilience Testing\n- M – Automation Backlog\n\nTurn both memory tools into cue cards, whiteboard sketches, and spaced-repetition prompts so the team revisits them weekly."
      }
    },
    {
      "type": "quiz",
      "content": {
        "text": "## Quick Knowledge Check: Establishing Persistence Mechanisms\n\nDiscuss these prompts with a teammate before attempting the formal post-assessment. Emphasize storytelling and decision rationale.\n\n- How does **WMI Event Subscription persistence** influence the triage path, and which warning signs should penetration testers flag immediately?\n\n- How does **Golden Ticket attacks** influence the triage path, and which warning signs should penetration testers flag immediately?\n\n- How does **web shell persistence** influence the triage path, and which warning signs should penetration testers flag immediately?\n\nCapture the answers in your runbook and update escalation thresholds so the lesson becomes part of daily stand-ups."
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "## Reflection Journal\n\n- When did you last witness a breakdown in penetration testing operations, and how would the Establishing Persistence Mechanisms workflow change the outcome?\n- Which allies outside your immediate team should be briefed on this lesson so penetration testers have faster support?\n- What metric will you watch over the next two sprints to prove the lesson is embedded?"
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "## Mindset Coach\n\nThis is an advanced journey. Celebrate each iteration where penetration testers narrate what they learned, how they collaborated, and which safeguards they reinforced.\n\nTreat mistakes as signal. Document them, share the story, and adjust the playbook so confidence keeps growing while working through Establishing Persistence Mechanisms.\n\nEnd every session by identifying one action you can automate, one teammate you can mentor, and one stakeholder update you can improve."
      }
    }
  ],
  "tags": [
    "Course: SANS-SEC504"
  ]
}