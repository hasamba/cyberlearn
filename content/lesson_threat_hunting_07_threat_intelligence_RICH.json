{
  "lesson_id": "th-007-threat-intelligence",
  "domain": "threat_hunting",
  "title": "Threat Intelligence for Hunting",
  "difficulty": 2,
  "order_index": 7,
  "prerequisites": ["th-001-fundamentals", "th-002-methodologies"],
  "concepts": [
    "Threat intelligence types and sources",
    "IOC consumption and operationalization",
    "TTP-based intelligence vs IOC-based",
    "Threat intelligence platforms (MISP, ThreatConnect)",
    "Intelligence-driven hunting hypotheses",
    "Sharing threat intelligence with community"
  ],
  "estimated_time": 50,
  "learning_objectives": [
    "Understand types of threat intelligence (strategic, tactical, operational)",
    "Consume and operationalize IOCs for hunting",
    "Build TTP-based hunt hypotheses from intelligence",
    "Use threat intelligence platforms effectively",
    "Generate threat intelligence from hunt findings",
    "Participate in threat intelligence sharing communities"
  ],
  "post_assessment": [
    {
      "question": "What is the difference between tactical and strategic threat intelligence?",
      "options": [
        "Tactical is IOCs/TTPs, Strategic is high-level trends and risks",
        "They are the same thing",
        "Tactical is for executives, Strategic is for analysts",
        "Strategic expires faster than tactical"
      ],
      "correct_answer": 0,
      "difficulty": 2,
      "type": "multiple_choice"
    },
    {
      "question": "Why are TTPs more valuable than IOCs for threat hunting?",
      "options": [
        "TTPs are easier to find",
        "TTPs change less frequently than IOCs (IPs, domains, hashes)",
        "TTPs are faster to implement",
        "IOCs are deprecated"
      ],
      "correct_answer": 1,
      "difficulty": 2,
      "type": "multiple_choice"
    },
    {
      "question": "What does STIX stand for in threat intelligence?",
      "options": [
        "Standard Threat Intelligence XML",
        "Structured Threat Information Expression",
        "Security Threat Index Exchange",
        "System Threat Intelligence X-ray"
      ],
      "correct_answer": 1,
      "difficulty": 2,
      "type": "multiple_choice"
    }
  ],
  "jim_kwik_principles": [
    "active_learning",
    "connect_to_what_i_know",
    "minimum_effective_dose"
  ],
  "content_blocks": [
    {
      "type": "explanation",
      "content": {
        "text": "# Threat Intelligence: Hunting with Purpose\n\n**Threat intelligence** transforms reactive hunting into **proactive, intelligence-driven operations**. Instead of blindly searching for threats, you hunt based on **what adversaries are doing right now**.\n\n## What is Threat Intelligence?\n\n**Threat Intelligence** = Evidence-based knowledge about threats, including:\n- **Who**: Threat actors (APT29, Lazarus Group, ransomware gangs)\n- **What**: Malware families, tools, techniques\n- **How**: Tactics, Techniques, and Procedures (TTPs)\n- **When**: Active campaigns, trending threats\n- **Where**: Targeting (industries, countries, organizations)\n- **Why**: Motivations (financial, espionage, disruption)\n\n### The Intelligence Hierarchy\n\n**Strategic Intelligence** (Executive Level)\n- **Timeframe**: Months to years\n- **Audience**: CISO, Board, executives\n- **Content**: Industry trends, geopolitical threats, risk assessments\n- **Example**: \"Ransomware attacks on healthcare increased 200% in 2024\"\n- **Use**: Budget planning, strategic decisions\n\n**Operational Intelligence** (Management Level)\n- **Timeframe**: Weeks to months\n- **Audience**: SOC manager, Incident Response lead\n- **Content**: Active campaigns, threat actor profiles\n- **Example**: \"APT29 targeting government contractors with SolarWinds-style attacks\"\n- **Use**: Resource allocation, campaign tracking\n\n**Tactical Intelligence** (Analyst Level)\n- **Timeframe**: Days to weeks\n- **Audience**: Threat hunters, SOC analysts\n- **Content**: IOCs (IPs, domains, hashes), TTPs, detection rules\n- **Example**: \"Cobalt Strike beacon using named pipe pattern 'MSSE-*'\"\n- **Use**: Direct hunting, detection engineering\n\n**Technical Intelligence** (Implementation Level)\n- **Timeframe**: Hours to days\n- **Audience**: Engineers, IR teams\n- **Content**: Malware analysis, exploit details, config extraction\n- **Example**: \"Qakbot C2 config extracted: 198.51.100.20:443\"\n- **Use**: Immediate response, blocking\n\n## IOCs vs TTPs: The Intelligence Spectrum\n\n### Indicators of Compromise (IOCs)\n\n**What they are**: Specific atomic indicators\n\n**Examples**:\n- IP addresses: 198.51.100.20\n- Domains: malicious-c2.com\n- File hashes: SHA256:a7f3d...\n- Email addresses: attacker@evil.com\n- URLs: http://evil.com/payload.exe\n\n**Strengths**:\n- âœ… Easy to implement (block list, SIEM alerts)\n- âœ… High confidence (if IOC found = threat detected)\n- âœ… Fast to operationalize\n\n**Weaknesses**:\n- âŒ **Short lifespan**: Attackers change IPs/domains daily\n- âŒ **Easy to evade**: New IP = bypassed detection\n- âŒ **Limited context**: Doesn't explain HOW attack works\n\n**IOC Lifecycle**:\n```\n[IOC Published] â†’ [24-48 hours] â†’ [Attacker pivots to new infrastructure] â†’ [IOC obsolete]\n```\n\n### Tactics, Techniques, and Procedures (TTPs)\n\n**What they are**: Adversary behaviors and methods\n\n**Examples**:\n- **Tactic**: Credential Access (TA0006)\n- **Technique**: OS Credential Dumping (T1003)\n- **Procedure**: Using Mimikatz to dump LSASS memory\n\n**Strengths**:\n- âœ… **Long lifespan**: TTPs change slowly (adversaries stick with what works)\n- âœ… **Hard to evade**: Behavioral detection catches variations\n- âœ… **Rich context**: Understand full attack chain\n\n**Weaknesses**:\n- âŒ Harder to implement (requires behavioral detection)\n- âŒ May generate false positives\n- âŒ Requires deeper analysis skills\n\n**TTP Lifecycle**:\n```\n[TTP Published] â†’ [Months to Years] â†’ [Still effective] â†’ [Rare to change]\n```\n\n### The Pyramid of Pain (David Bianco)\n\n```\n        /\\               Hardest for Attacker to Change\n       /  \\              â†‘\n      / TT \\             | \n     / Ps   \\            |\n    /--------\\           |\n   / Tools   \\           |\n  /  Host    \\          |\n / Artifacts  \\         |\n/-------------\\        |\n/ Network/Host\\       |\n/   Artifacts  \\      |\n/---------------\\     |\n/   Domain      \\    |\n/    Names       \\   |\n/-----------------\\  |\n/   IP Addresses  \\ |\n/-------------------\\â†“\n                    Easiest for Attacker to Change\n```\n\n**Bottom (Easy to change)**: IP addresses, domains â†’ Low value for hunting\n**Top (Hard to change)**: TTPs â†’ High value for hunting\n\n**Hunt Strategy**: Focus on **TTPs** for maximum impact.\n\n## Threat Intelligence Sources\n\n### Open Source Intelligence (OSINT)\n\n**Free Sources**:\n- **AlienVault OTX**: Community-driven threat intelligence\n- **VirusTotal**: File/URL/IP reputation\n- **abuse.ch**: Malware samples and IOCs (URLhaus, MalwareBazaar)\n- **Shodan**: Internet-exposed services\n- **GitHub**: Adversary tool repositories, leaked data\n- **Twitter/X**: #threatintel hashtag, researcher accounts\n\n**Government Sources**:\n- **CISA Alerts**: US-CERT advisories\n- **NCSC UK**: UK government cyber alerts\n- **MITRE ATT&CK**: Adversary TTPs knowledge base\n\n**Vendor Blogs**:\n- CrowdStrike Intelligence\n- Mandiant Threat Intelligence\n- Microsoft Security Blog\n- Recorded Future\n\n### Commercial Intelligence\n\n**Paid Platforms**:\n- **Recorded Future**: Real-time threat intelligence\n- **Flashpoint**: Deep/dark web monitoring\n- **ThreatConnect**: Intelligence platform and community\n- **Anomali**: Threat intelligence aggregation\n- **CrowdStrike Falcon Intelligence**: APT tracking\n\n**Cost**: $10K-$500K+ per year\n\n**Value**: Curated, timely, actionable intelligence\n\n### Community Sharing (ISACs/ISAOs)\n\n**Information Sharing and Analysis Centers**:\n- **FS-ISAC**: Financial services\n- **H-ISAC**: Healthcare\n- **MS-ISAC**: State/local government\n- **Auto-ISAC**: Automotive\n\n**Benefits**: Industry-specific intelligence, peer collaboration\n\n### Internal Intelligence\n\n**Your own hunt findings**:\n- IOCs extracted from incidents\n- TTPs observed in your environment\n- Custom YARA rules\n- Behavioral patterns\n\n**Most valuable**: Tailored to YOUR threat landscape\n\n## Operationalizing Threat Intelligence\n\n### Step 1: Intelligence Collection\n\n**Automate feeds**:\n```python\nimport requests\n\n# Fetch AlienVault OTX pulse\nurl = \"https://otx.alienvault.com/api/v1/pulses/subscribed\"\nheaders = {\"X-OTX-API-KEY\": \"your-api-key\"}\n\nresponse = requests.get(url, headers=headers)\npulses = response.json()\n\nfor pulse in pulses['results']:\n    print(f\"Threat: {pulse['name']}\")\n    for indicator in pulse['indicators']:\n        print(f\"  IOC: {indicator['indicator']} ({indicator['type']})\")\n```\n\n### Step 2: Intelligence Enrichment\n\n**Enrich IOCs with context**:\n- Resolve IPs to domains\n- Check domain registration dates\n- Correlate with MITRE ATT&CK techniques\n- Add threat actor attribution\n\n**Example**:\n```\nIOC: 198.51.100.20\n  â†’ Domain: malicious-c2.com\n  â†’ Registrar: NameCheap (privacy protected)\n  â†’ First seen: 2025-01-10 (3 days old)\n  â†’ Associated campaign: Conti ransomware\n  â†’ TTPs: T1071.001 (Web Protocols), T1573 (Encrypted Channel)\n  â†’ Threat actor: Wizard Spider\n```\n\n### Step 3: Intelligence Dissemination\n\n**Push to security tools**:\n- **Firewall**: Block malicious IPs\n- **DNS**: Sinkhole malicious domains\n- **SIEM**: Create detection rules\n- **EDR**: Hunt for IOCs across fleet\n- **Email Gateway**: Block sender addresses\n\n**STIX/TAXII**:\n- **STIX**: Structured Threat Information Expression (data format)\n- **TAXII**: Trusted Automated Exchange of Intelligence Information (transport protocol)\n\n### Step 4: Hunt Based on Intelligence\n\n**IOC-Based Hunt**:\n```\nIntel: APT29 using domain \"cdn-cloudflare[.]net\"\n  â†“\nHunt: Search DNS logs for this domain\n  â†“\nQuery: cat dns.log | grep \"cdn-cloudflare.net\"\n  â†“\nResult: Found 500 queries from 192.168.1.75 â†’ Investigate\n```\n\n**TTP-Based Hunt**:\n```\nIntel: APT29 uses WMI for lateral movement (T1047)\n  â†“\nHypothesis: \"If APT29 is in our environment, we'd see WMI lateral movement\"\n  â†“\nHunt: Search for WMI process creation on remote systems\n  â†“\nQuery: Sysmon Event ID 1 | where ParentImage contains \"wmi\"\n  â†“\nResult: Found suspicious WMI execution â†’ Investigate\n```"
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "## Practical Intelligence-Driven Hunting\n\n### Scenario 1: Hunting Based on APT Report\n\n**Intelligence Report**: \"APT29 targeting government contractors using:\n- **Initial Access**: Spearphishing with malicious PDFs\n- **Execution**: PowerShell downloaders\n- **C2**: HTTPS to typo-squatted Microsoft domains\n- **Exfiltration**: WinRAR compression + cloud storage upload\"\n\n**Hunt Plan**:\n\n**Hunt 1: Malicious PDF Opens**\n```bash\n# Windows Event Log: Process creation from PDF reader\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4688} | \n  Where-Object {$_.Properties[5].Value -match 'AcroRd32.exe|Acrobat.exe'} |\n  Where-Object {$_.Properties[8].Value -match 'powershell|cmd'}\n```\n\n**Hunt 2: PowerShell Download Cradles**\n```powershell\n# PowerShell script block logging\nGet-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; ID=4104} |\n  Where-Object {$_.Message -match 'DownloadString|DownloadFile|IEX|Invoke-WebRequest'}\n```\n\n**Hunt 3: Typosquatted Domains**\n```bash\n# DNS logs for Microsoft typosquatting\ncat dns.log | grep -E '(micros0ft|mircosoft|updates-microsoft|windowsupdate-microsoft)'\n```\n\n**Hunt 4: WinRAR + Cloud Upload**\n```kusto\n// EDR: WinRAR creating archives, then network upload\nDeviceProcessEvents\n| where FileName =~ \"winrar.exe\" or FileName =~ \"rar.exe\"\n| where ProcessCommandLine contains \"a\" // archive flag\n| join (\n    DeviceNetworkEvents\n    | where RemoteUrl has_any (\"dropbox\", \"onedrive\", \"drive.google\")\n) on DeviceId\n| where NetworkEvents.Timestamp between (ProcessEvents.Timestamp .. (ProcessEvents.Timestamp + 5m))\n```\n\n### Scenario 2: IOC Feed Operationalization\n\n**Intel Source**: AlienVault OTX pulse - \"Cobalt Strike C2 Infrastructure\"\n\n**IOCs Received**:\n- IP: 198.51.100.20, 198.51.100.21, 198.51.100.22\n- Domain: cdn-service.net, update-check.com\n- Named Pipe Pattern: MSSE-*, postex_*\n\n**Step 1: Block at Perimeter**\n```bash\n# Firewall block (example with iptables)\niptables -A OUTPUT -d 198.51.100.20 -j DROP\niptables -A OUTPUT -d 198.51.100.21 -j DROP\niptables -A OUTPUT -d 198.51.100.22 -j DROP\n```\n\n**Step 2: Hunt in Historical Data**\n```bash\n# NetFlow: Check if any systems contacted these IPs\nnfdump -R /var/netflow/2025/01/ | grep -E '(198\\.51\\.100\\.20|198\\.51\\.100\\.21|198\\.51\\.100\\.22)'\n```\n\n**Step 3: Hunt for Named Pipes**\n```kusto\n// Microsoft Defender ATP\nDeviceEvents\n| where ActionType == \"NamedPipeEvent\"\n| where AdditionalFields has_any (\"MSSE-\", \"postex_\", \"status_\")\n| project Timestamp, DeviceName, InitiatingProcessFileName, AdditionalFields\n```\n\n**Step 4: Create Ongoing Detection**\n```yaml\n# Sigma rule for ongoing detection\ntitle: Cobalt Strike C2 IOCs from OTX\ndetection:\n  selection_ip:\n    destination_ip:\n      - '198.51.100.20'\n      - '198.51.100.21'\n      - '198.51.100.22'\n  selection_domain:\n    query:\n      - 'cdn-service.net'\n      - 'update-check.com'\n  condition: selection_ip or selection_domain\nlevel: critical\n```\n\n### Scenario 3: TTP-Based Hunt from MITRE ATT&CK\n\n**Intelligence**: MITRE ATT&CK Technique T1053.005 - Scheduled Task/Job\n\n**Hunt Hypothesis**: \"If an attacker establishes persistence, they may use scheduled tasks.\"\n\n**Hunt Query 1: Recent Task Creation**\n```powershell\n# Windows Event ID 4698: Scheduled task created\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4698} |\n  Where-Object {$_.TimeCreated -gt (Get-Date).AddDays(-7)} |\n  ForEach-Object {\n    $xml = [xml]$_.ToXml()\n    [PSCustomObject]@{\n      Time = $_.TimeCreated\n      TaskName = $xml.Event.EventData.Data[0].'#text'\n      User = $_.UserId\n    }\n  }\n```\n\n**Hunt Query 2: Tasks with Suspicious Actions**\n```kusto\n// EDR: Scheduled tasks executing PowerShell/cmd\nDeviceProcessEvents\n| where FileName =~ \"schtasks.exe\"\n| where ProcessCommandLine has \"/create\"\n| where ProcessCommandLine has_any (\"powershell\", \"cmd.exe\", \"wscript\", \"cscript\")\n| project Timestamp, DeviceName, ProcessCommandLine, AccountName\n```\n\n**Hunt Query 3: Validate Legitimacy**\n```powershell\n# Get all scheduled tasks and check for suspicious patterns\nGet-ScheduledTask | \n  Where-Object {$_.TaskName -match '^[a-z0-9]{8,12}$' -or $_.Actions.Execute -match 'powershell|cmd'} |\n  Select-Object TaskName, @{N='Action';E={$_.Actions.Execute + ' ' + $_.Actions.Arguments}}\n```"
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "## Real-World: Intelligence-Driven Hunt Stops Data Breach\n\n### Background\n\nA technology company received threat intelligence about **Lazarus Group** targeting software companies with supply chain attacks.\n\n### The Intelligence Report\n\n**Source**: FBI Flash Alert - \"Lazarus Group Targeting Software Supply Chains\"\n\n**Key Intelligence**:\n- **Target**: Software companies with remote access to customer environments\n- **Initial Access**: Spearphishing with fake job offers (LinkedIn)\n- **Execution**: Custom loader \"BLINDINGCAN\"\n- **Persistence**: Windows services with random 8-char names\n- **C2**: HTTPS to legitimate-looking domains (masquerading as software update servers)\n- **Objective**: Steal source code + inject backdoors into software updates\n\n**IOCs Provided**:\n- Domains: software-update[.]org, cdn-packages[.]com\n- File Hash: SHA256:a7f3d9e8c2b1... (BLINDINGCAN loader)\n- Service Names: Pattern ^[a-z]{8}$ (e.g., \"hjkdsfgh\")\n\n### The Intelligence-Driven Hunt\n\n**Week 1: IOC Sweep**\n\n**Hunt 1: Check for Known IOCs**\n```bash\n# DNS logs\ncat dns.log | grep -E '(software-update\\.org|cdn-packages\\.com)'\n# Result: No matches\n\n# File hash search (EDR)\nsha256: a7f3d9e8c2b1...\n# Result: No matches\n```\n\n**Conclusion**: No direct IOC hits, but **TTPs still relevant**.\n\n**Week 1: TTP-Based Hunt**\n\n**Hunt 2: Suspicious Services**\n```powershell\n# Hunt for services with random 8-char names\nGet-Service | Where-Object {$_.Name -match '^[a-z]{8}$'} | \n  Select-Object Name, DisplayName, Status, StartType\n\n# FOUND:\n# Name: hjkdsfgh\n# DisplayName: Windows Update Helper\n# Status: Running\n# StartType: Automatic\n```\n\n**Red Flags**:\n- âœ… Random 8-character name (matches IOC pattern)\n- âœ… Masquerading as Windows Update\n- âœ… Running with SYSTEM privileges\n\n**Hunt 3: Service Binary Analysis**\n```powershell\n# Get service executable path\nGet-WmiObject Win32_Service | Where-Object {$_.Name -eq 'hjkdsfgh'} | \n  Select-Object PathName\n\n# Result: C:\\ProgramData\\hjkdsfgh\\svchost.exe\n```\n\n**Red Flags**:\n- âœ… Executable in ProgramData (unusual for services)\n- âœ… Named \"svchost.exe\" (masquerading as legitimate Windows process)\n- âœ… Not signed by Microsoft\n\n**Week 2: Investigation**\n\n**Hunt 4: When Was Service Created?**\n```powershell\n# System Event Log: Service installation\nGet-WinEvent -FilterHashtable @{LogName='System'; ID=7045} |\n  Where-Object {$_.Message -match 'hjkdsfgh'}\n\n# Result: Created 2024-12-15 at 14:30\n```\n\n**Hunt 5: What Happened Before Service Creation?**\n```kusto\n// EDR: Activity before service installation\nDeviceProcessEvents\n| where Timestamp between (datetime(2024-12-15 14:00) .. datetime(2024-12-15 14:30))\n| where DeviceName == \"DEV-WS-05\"\n| project Timestamp, FileName, ProcessCommandLine\n\n// FOUND:\n// 14:15: rundll32.exe C:\\Users\\john\\Downloads\\document.dll,Start\n// 14:20: powershell.exe -enc [base64]\n// 14:25: sc.exe create hjkdsfgh binPath=\"C:\\ProgramData\\hjkdsfgh\\svchost.exe\"\n```\n\n**Attack Chain Discovered**:\n```\n14:00 - User downloaded \"Job_Offer_Details.pdf.dll\" (fake job offer)\n14:15 - User executed DLL (rundll32.exe)\n14:20 - PowerShell stager downloaded BLINDINGCAN\n14:25 - Service created for persistence\n14:30 - C2 beacon established\n```\n\n**Hunt 6: Network Connections**\n```bash\n# NetFlow: Where did this system connect after infection?\nnfdump -R /var/netflow/2024/12/15 | grep \"10.50.5.25\" # DEV-WS-05\n\n# FOUND:\n# 14:35 - Connection to 203.0.113.50:443 (external IP, not in IOC list)\n# DNS: Resolves to \"cdn-softwaretools.com\" (VARIANT of IOC domain)\n```\n\n**Adversary Adaptation**:\n- IOCs said: software-update[.]org, cdn-packages[.]com\n- Attacker used: cdn-softwaretools[.]com (**similar but not exact match**)\n- **TTP-based hunting found what IOC-based hunting would have missed**\n\n### Response Timeline\n\n**Day 1 (After Hunt Discovery)**:\n1. Isolated DEV-WS-05 from network\n2. Killed \"hjkdsfgh\" service\n3. Blocked 203.0.113.50 and cdn-softwaretools[.]com at firewall\n\n**Day 2: Expanded Hunt**\n```powershell\n# Hunt all systems for same TTP (8-char service names)\nInvoke-Command -ComputerName (Get-ADComputer -Filter *).Name -ScriptBlock {\n  Get-Service | Where-Object {$_.Name -match '^[a-z]{8}$'}\n}\n\n# FOUND: 2 additional compromised systems\n```\n\n**Day 3-5: Forensics**\n- Malware analysis confirmed BLINDINGCAN variant\n- Attacker had access for **15 days**\n- **NO source code stolen** (caught before exfiltration phase)\n- **NO customer environments compromised**\n\n### Outcome\n\n**Damage Prevented**:\n- Supply chain attack stopped before customer impact\n- Source code protected\n- Estimated damage prevented: **$20-50 million**\n\n**Key Factors**:\n1. âœ… **Intelligence report** provided context and TTPs\n2. âœ… **TTP-based hunting** found threat despite IOC evasion\n3. âœ… **Proactive hunt** caught attacker in early stages\n4. âœ… **Expanded hunt** found additional compromised systems\n\n**Intelligence Shared**:\n- New IOCs (cdn-softwaretools[.]com, 203.0.113.50) shared with FBI\n- Malware sample uploaded to VirusTotal\n- Hunt methodology shared with industry ISAC\n\n### Lessons Learned\n\n**What Worked**:\n- âœ… Intelligence report triggered proactive hunt\n- âœ… TTP-based detection caught adversary despite IOC changes\n- âœ… Pattern matching (8-char service names) was key indicator\n\n**What to Improve**:\n- âš ï¸ Initial compromise (phishing) went undetected for 15 days\n- âš ï¸ Need better email filtering for malicious attachments\n- âš ï¸ DLL execution from Downloads folder should trigger alert\n\n**Takeaway**: **Intelligence + TTP-based hunting = effective threat detection**, even when adversaries modify their IOCs."
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "## Threat Intelligence Memory Aids\n\n### STOT - Intelligence Types\n\n**S** - **S**trategic (Executive, months-years, trends)\n**T** - **T**actical (Analyst, days-weeks, IOCs/TTPs)\n**O** - **O**perational (Manager, weeks-months, campaigns)\n**T** - **T**echnical (Engineer, hours-days, malware details)\n\n### IOC vs TTP: The Pyramid\n\n**IOCs** (Bottom of Pyramid):\n- IPs, domains, hashes\n- **Easy for attacker to change**\n- **Short lifespan**\n- **Low pain** for adversary\n\n**TTPs** (Top of Pyramid):\n- Behaviors, techniques, procedures\n- **Hard for attacker to change**\n- **Long lifespan**\n- **High pain** for adversary\n\n**Hunt Priority**: TTPs > IOCs\n\n### CEDHD - Intelligence Lifecycle\n\n**C** - **C**ollect (Gather intel from sources)\n**E** - **E**nrich (Add context, correlate)\n**D** - **D**isseminate (Push to tools, share with team)\n**H** - **H**unt (Use intel to drive hunts)\n**D** - **D**ocument (Record findings, create new intel)\n\n### STIX/TAXII Quick Reference\n\n**STIX** = Format (JSON structure for threat data)\n**TAXII** = Transport (How to share STIX data)\n\n**Analogy**: STIX is the language, TAXII is the postal service\n\n### Visual: Intelligence-Driven Hunt Flow\n\n```\n[Intel Report] â†’ [Extract TTPs] â†’ [Formulate Hypothesis] â†’ [Hunt]\n      â†“              â†“                    â†“                  â†“\n  APT29 report  WMI lateral      \"If APT29 here,    Search WMI events\n                 movement       we'd see WMI use\"   Find suspicious\n                                                           â†“\n                                                    [Investigate/Respond]\n```"
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "## Reflection Questions\n\n1. **Why are TTPs more valuable than IOCs for threat hunting, even though IOCs are easier to operationalize?**\n\n   *Hint: Think about adversary agility and detection longevity.*\n\n2. **If you receive a threat intelligence report about APT targeting your industry, but it contains no IOCsâ€”only TTPsâ€”how would you use it?**\n\n   *Build hunt hypotheses based on TTPs, search for those behaviors in your environment.*\n\n3. **In the Lazarus Group case study, why did TTP-based hunting succeed where IOC-based hunting failed?**\n\n   *Adversary changed domains but kept TTPs (8-char service names, persistence methods).*\n\n4. **What's the difference between consuming threat intelligence and producing threat intelligence?**\n\n   *Consuming = using others' intel to hunt. Producing = sharing YOUR hunt findings with community.*\n\n5. **How would you prioritize which threat intelligence sources to monitor if you have limited time?**\n\n   *Industry-specific ISACs first, then government alerts (CISA), then vendor blogs.*\n\n6. **Why is it important to enrich IOCs with context before operationalizing them?**\n\n   *Context (threat actor, campaign, TTPs) helps prioritize response and understand attack chain.*"
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "## Mastering Threat Intelligence for Hunting\n\n### You've Learned to Hunt Smarter\n\nThreat intelligence transforms **reactive hunting** into **proactive, targeted operations**. You now understand:\n\nâœ… **Intelligence types**: Strategic, Operational, Tactical, Technical\nâœ… **IOCs vs TTPs**: Focus on TTPs for lasting detection\nâœ… **Pyramid of Pain**: Target adversary's hardest-to-change behaviors\nâœ… **Intelligence sources**: OSINT, commercial, ISACs, internal\nâœ… **Operationalization**: Collect, enrich, disseminate, hunt\nâœ… **Real-world success**: Stopping Lazarus Group via TTP-based hunting\n\n**You now hunt with intelligence, not just intuition.**\n\n### Your Action Plan\n\n**This Week**:\n1. **Subscribe to 3 intel sources**: AlienVault OTX, CISA alerts, industry ISAC\n2. **Pick one threat report**: Extract TTPs and build a hunt hypothesis\n3. **Run TTP-based hunt**: Search for behaviors, not just IOCs\n\n**This Month**:\n4. **Join threat intel community**: ISAC for your industry\n5. **Create intel feedback loop**: Share YOUR hunt findings with community\n6. **Build hunt playbook library**: Map hunts to MITRE ATT&CK techniques\n\n### Resources\n\n**Free Intel Sources**:\n- **AlienVault OTX**: https://otx.alienvault.com/\n- **MISP**: https://www.misp-project.org/\n- **CISA Alerts**: https://www.cisa.gov/cybersecurity-advisories\n- **abuse.ch**: https://abuse.ch/\n\n**Tools**:\n- **MISP**: Threat intelligence platform\n- **OpenCTI**: Open-source threat intelligence platform\n- **TheHive**: Incident response + case management\n\n**Learning**:\n- **SANS FOR578**: Cyber Threat Intelligence\n- **Intelligence-Driven Incident Response** (Book)\n\n### Remember\n\n**Intelligence gives your hunts direction.** Instead of searching blindly, you hunt for **what adversaries are actually doing**.\n\n**Next: APT Hunting** - Putting it all together to hunt advanced persistent threats.\n\n**Keep hunting. Intelligence guides the way.** ðŸŽ¯"
      }
    }
  ]
}
