{
  "lesson_id": "a686bda2-4bb3-4472-844d-b26c90ae5fec",
  "domain": "dfir",
  "title": "LNK File Analysis",
  "difficulty": 2,
  "order_index": 34,
  "prerequisites": [
    "e5d18e0d-9cda-4769-9589-395cbadcafed"
  ],
  "concepts": [
    "Windows LNK file structure and metadata",
    "LNK file creation and modification timestamps",
    "Target file path and volume information extraction",
    "MAC address and machine identifiers in LNK files",
    "Automatic Destination LNK files (Recent/Quick Access)",
    "LECmd tool for automated LNK parsing",
    "File access timeline reconstruction from LNK files",
    "Network share and removable media tracking via LNK"
  ],
  "estimated_time": 45,
  "learning_objectives": [
    "Understand Windows LNK file structure and forensic value",
    "Extract metadata from LNK files (timestamps, paths, volume serial numbers)",
    "Use LECmd (Eric Zimmerman Tools) for automated LNK parsing",
    "Reconstruct user file access history from LNK artifacts",
    "Identify network share access and USB device usage via LNK files",
    "Correlate LNK evidence with other forensic artifacts (MFT, Prefetch, Jump Lists)",
    "Detect anti-forensics attempts through LNK manipulation"
  ],
  "post_assessment": [
    {
      "question_id": "lnk-001",
      "question": "What is the primary forensic value of Windows LNK (shortcut) files?",
      "options": [
        "They contain copies of deleted files for recovery",
        "They record when and where files were accessed, including target paths and timestamps",
        "They store user passwords and credentials",
        "They provide network traffic logs"
      ],
      "correct_answer": 1,
      "explanation": "LNK files are Windows shortcut files that contain rich METADATA about the target file, including: (1) Target file path (original location), (2) Creation/modification/access timestamps of BOTH the LNK and target file, (3) Volume serial number (identifies specific drive/USB), (4) MAC address (identifies specific computer), (5) File size and attributes. Forensically, LNK files prove: WHO accessed WHAT file, WHEN it was accessed, and WHERE it was located (local drive, network share, USB). Even if the target file is deleted, the LNK preserves evidence of its existence and access history.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "lnk-002",
      "question": "A suspect's Desktop contains a LNK file pointing to \\\\FileServer\\Confidential\\TradSecrets.docx. The target file was deleted from the server. What can you prove from the LNK file?",
      "options": [
        "Nothing - if the target file is deleted, LNK provides no evidence",
        "The suspect accessed a file named TradSecrets.docx from the server, with timestamps of access",
        "The LNK file contains a backup copy of the deleted TradSecrets.docx",
        "The suspect created the file (not just accessed it)"
      ],
      "correct_answer": 1,
      "explanation": "Even with the target file DELETED, the LNK file preserves: (1) Full path (\\\\FileServer\\Confidential\\TradSecrets.docx) proving the file existed, (2) LNK creation time (when shortcut was created = when user first accessed file), (3) LNK modification time (when user last accessed file), (4) Target file size and modification time (at time of last access), (5) Volume serial number of the server. This is PROOF the suspect accessed confidential data, even if the data is now deleted. LNK files do NOT contain file contents (not backups), but metadata is sufficient for proving access in litigation/criminal cases.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "lnk-003",
      "question": "Where does Windows automatically create LNK files for recently accessed documents?",
      "options": [
        "C:\\Windows\\System32\\Recent\\",
        "C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\",
        "C:\\Program Files\\Microsoft\\Recent\\",
        "C:\\Recycle.Bin\\Recent\\"
      ],
      "correct_answer": 1,
      "explanation": "Windows automatically creates LNK files in C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\ whenever a user opens a file via File Explorer, Office applications, or most programs. These 'Automatic Destination' LNK files track recent file access history across the system. Forensic gold mine: This folder contains LNK files for EVERY document opened by the user (even if files are later deleted). Analysis reveals: Files accessed, timestamps, original paths (including network shares, USB drives). LECmd can parse this entire folder to generate a comprehensive file access timeline.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "lnk-004",
      "question": "A LNK file contains MAC address AA:BB:CC:DD:EE:FF. What is the forensic significance?",
      "options": [
        "It identifies the network router the computer was connected to",
        "It identifies the specific computer where the LNK file was created",
        "It identifies the target file's encryption key",
        "MAC addresses are not stored in LNK files"
      ],
      "correct_answer": 1,
      "explanation": "LNK files contain the NetBIOS MAC address of the computer where the shortcut was created. Forensic significance: (1) Proves which SPECIFIC COMPUTER created the LNK (MAC address is unique hardware identifier), (2) Cross-reference with network logs to identify computer name/IP, (3) Links LNK file to suspect's machine in multi-computer investigations, (4) Detects if LNK was created on a DIFFERENT computer (e.g., attacker's machine in lateral movement). Note: Modern Windows (10+) may omit MAC address in some LNK files for privacy, but older systems and many enterprise environments still include it.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "lnk-005",
      "question": "You analyze a LNK file with target path E:\\StolenData\\Confidential.xlsx. The volume serial number is 1A2B-3C4D. What can you determine?",
      "options": [
        "The file was accessed from a specific removable drive (USB) with serial 1A2B-3C4D",
        "The file size is 1A2B-3C4D bytes",
        "The file was created on January 2nd, 2B34 (date encoding)",
        "The volume serial number provides no useful forensic information"
      ],
      "correct_answer": 0,
      "explanation": "The volume serial number (1A2B-3C4D) uniquely identifies the SPECIFIC DRIVE where the target file was located. Forensic use: (1) Correlate with USB artifacts (USBSTOR registry) to identify the exact USB device used, (2) Prove file was accessed from removable media (E:\\ = typical USB drive letter), (3) Timeline: LNK creation timestamp = when USB was inserted and file accessed, (4) Even if USB is seized, volume serial number from LNK confirms it's the SAME device. Combined evidence: LNK (E:\\StolenData\\) + USB artifacts (device serial) + volume serial = proof of data theft via USB exfiltration.",
      "type": "multiple_choice",
      "difficulty": 2
    }
  ],
  "jim_kwik_principles": [
    "teach_like_im_10",
    "memory_hooks",
    "active_learning",
    "connect_to_what_i_know",
    "minimum_effective_dose",
    "meta_learning",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "content_blocks": [
    {
      "type": "mindset_coach",
      "content": {
        "text": "# Welcome to LNK File Forensics: The Digital Fingerprint Trail! ğŸ”—\n\n**LNK files are like breadcrumbs** that users unknowingly leave behind every time they open a file. They whisper: \"I was here, I opened this file, on this date, from this location.\"\n\n**Think of LNK files as automatic surveillance cameras** installed by Windows:\n- ğŸ“¹ **Records**: Every file you open\n- â° **Timestamps**: When you opened it\n- ğŸ“ **Location**: Where the file was (local, network, USB)\n- ğŸ†” **Identity**: Which computer created the shortcut\n\n**Real-world impact**: In a 2018 insider threat case, an employee deleted all traces of stolen IP documents from his laptop. But LNK files in his Recent folder revealed:\n- 127 files accessed from `\\\\FileServer\\Confidential\\`\n- Timeline: Accessed over 6 months before resignation\n- Evidence: LNK files survived despite target file deletion\n\n**Result**: Conviction for trade secret theft (5 years prison + $2M restitution).\n\n**This lesson** teaches you to read the breadcrumb trail users can't erase.\n\n**Let's analyze LNK files!** ğŸ•µï¸"
      }
    },
    {
      "type": "video",
      "content": {
        "text": "**Video: Windows Registry Forensics - 13Cubed**\\n\\n**Duration**: 15:24\\n\\nThis video provides a visual demonstration of the concepts covered in this lesson. Watch to see practical examples and deepen your understanding of LNK File Analysis.\\n\\n**Video Link**: [Windows Registry Forensics - 13Cubed](https://www.youtube.com/watch?v=2Kn0TDbKqYw)\\n\\n**Embedded Video**:\\n\\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/2Kn0TDbKqYw\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\\n\\n**Learning Tips**:\\n- Watch the video first to get an overview\\n- Pause and take notes on key concepts\\n- Replay sections that cover complex topics\\n- Try to practice along with the video demonstrations\\n- Return to the video as needed while working through exercises",
        "url": "https://www.youtube.com/watch?v=2Kn0TDbKqYw",
        "title": "Windows Registry Forensics - 13Cubed",
        "duration": "15:24"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Windows LNK File Architecture\n\n## What are LNK Files?\n\n**Definition**: LNK (Shell Link) files are Windows shortcut files that point to target files, folders, or applications.\n\n**Purpose**: Provide quick access to frequently used items (Desktop shortcuts, Recent files, Start Menu).\n\n**Forensic Gold**: LNK files contain EXTENSIVE METADATA beyond just the target path.\n\n---\n\n## LNK File Structure\n\n### Header (76 bytes)\n\n```c\ntypedef struct {\n    DWORD header_size;           // 0x00: Always 0x0000004C (76 bytes)\n    GUID link_clsid;             // 0x04: {00021401-0000-0000-C000-000000000046}\n    DWORD link_flags;            // 0x14: Flags indicating which structures follow\n    DWORD file_attributes;       // 0x18: Target file attributes\n    FILETIME creation_time;      // 0x1C: Target file creation time\n    FILETIME access_time;        // 0x24: Target file access time\n    FILETIME write_time;         // 0x2C: Target file write time\n    DWORD file_size;             // 0x34: Target file size (bytes)\n    DWORD icon_index;            // 0x38: Icon index\n    DWORD show_command;          // 0x3C: Window state (normal, minimized, maximized)\n    WORD hot_key;                // 0x40: Hot key (keyboard shortcut)\n    WORD reserved1;              // 0x42: Reserved\n    DWORD reserved2;             // 0x44: Reserved\n    DWORD reserved3;             // 0x48: Reserved\n} LNK_HEADER;\n```\n\n**Key Forensic Fields**:\n\n1. **Creation Time (0x1C)**: When TARGET file was created\n2. **Access Time (0x24)**: When TARGET file was last accessed\n3. **Write Time (0x2C)**: When TARGET file was last modified\n4. **File Size (0x34)**: Size of target file (helps identify specific files)\n\n---\n\n### LinkTarget IDList (Variable Length)\n\n**Purpose**: Hierarchical path to target (shell namespace traversal).\n\n**Example**:\n```\nDesktop â†’ MyComputer â†’ C:\\ â†’ Users â†’ jsmith â†’ Documents â†’ Report.docx\n```\n\n**Forensic Value**: Contains full path including network shares, USB drives.\n\n---\n\n### LinkInfo Structure (Variable Length)\n\n**Contains**:\n- Volume ID (drive letter, volume serial number)\n- Local base path\n- Network share path (if target on network)\n\n```c\ntypedef struct {\n    DWORD size;                      // Structure size\n    DWORD header_size;               // Header size\n    DWORD volume_id_offset;          // Offset to VolumeID structure\n    DWORD local_base_path_offset;    // Offset to local path\n    DWORD network_share_offset;      // Offset to network path (if applicable)\n    // ...\n} LINKINFO;\n\ntypedef struct {\n    DWORD size;                      // VolumeID size\n    DWORD drive_type;                // 0=Unknown, 2=Removable, 3=Fixed, 4=Network, 5=CD\n    DWORD drive_serial_number;       // Volume serial number (e.g., 1A2B-3C4D)\n    DWORD volume_label_offset;       // Offset to volume label string\n    // ...\n} VOLUMEID;\n```\n\n**Forensic Gold**:\n\n1. **Volume Serial Number**: Identifies SPECIFIC drive (USB device fingerprint)\n2. **Drive Type**: Removable (USB), Fixed (HDD/SSD), Network (SMB share)\n3. **Network Share Path**: Proves access to specific network locations\n\n---\n\n### String Data (Variable Length)\n\n**Contains**:\n- Target file path (full path as string)\n- Working directory\n- Command-line arguments\n- Icon location\n\n**Example**:\n```\nTarget Path: C:\\Users\\jsmith\\Documents\\Confidential\\TradSecrets.docx\nWorking Dir: C:\\Users\\jsmith\\Documents\\Confidential\\\nArguments: (none)\n```\n\n---\n\n### Extra Data Blocks (Optional)\n\n**Types**:\n\n1. **TrackerDataBlock**: Contains MAC address and machine ID\n\n```c\ntypedef struct {\n    DWORD size;                      // Block size\n    DWORD signature;                 // 0xA0000003 (TrackerDataBlock)\n    DWORD version;                   // Version\n    char machine_id[16];             // NetBIOS name of machine\n    GUID droid_volume_id;            // Distributed link tracking volume ID\n    GUID droid_file_id;              // Distributed link tracking file ID\n    GUID droid_birth_volume_id;      // Birth volume ID\n    GUID droid_birth_file_id;        // Birth file ID\n    BYTE mac_address[6];             // MAC address of machine\n    // ...\n} TRACKER_DATA_BLOCK;\n```\n\n**Forensic Gold**: MAC address identifies the SPECIFIC COMPUTER where LNK was created.\n\n2. **PropertyStoreDataBlock**: Contains additional metadata (file tags, ratings)\n\n3. **SpecialFolderDataBlock**: Special folder identifiers (Desktop, Documents, etc.)\n\n---\n\n## Automatic LNK Creation Locations\n\n### Location 1: Recent Items\n\n**Path**: `C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\`\n\n**Behavior**: Windows automatically creates LNK files here when users open documents.\n\n**Forensic Value**:\n- Complete file access history\n- Survives even if target files deleted\n- Timestamps show when files were accessed\n\n**Example**:\n```\nRecent\\\n  â”œâ”€â”€ TradSecrets.lnk         (created when TradSecrets.docx opened)\n  â”œâ”€â”€ FinancialData.lnk        (created when FinancialData.xlsx opened)\n  â””â”€â”€ Passwords.lnk            (created when Passwords.txt opened)\n```\n\n### Location 2: Desktop Shortcuts\n\n**Path**: `C:\\Users\\<username>\\Desktop\\`\n\n**Behavior**: User manually creates shortcuts for quick access.\n\n**Forensic Value**: Shows files/folders user accesses frequently.\n\n### Location 3: Start Menu / Taskbar\n\n**Path**: `C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskbarPins\\`\n\n**Behavior**: Pinned applications on taskbar.\n\n**Forensic Value**: Shows applications user runs most frequently.\n\n### Location 4: Office Recent Files (Custom Destinations)\n\n**Path**: `C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\AutomaticDestinations\\`\n\n**Behavior**: Jump List data (covered in Lesson 35).\n\n**Forensic Value**: Application-specific file access history.\n\n---\n\n## Forensic Analysis Workflows\n\n### Workflow 1: Extract Target Path and Timestamps\n\n**Tool**: **LECmd.exe** (Eric Zimmerman Tools)\n\n```bash\n# Parse single LNK file\nLECmd.exe -f \"C:\\Users\\jsmith\\Desktop\\Report.lnk\" --json output.json\n\n# Parse all LNK files in Recent folder\nLECmd.exe -d \"C:\\Users\\jsmith\\AppData\\Roaming\\Microsoft\\Windows\\Recent\" --csv output --csvf lnk_timeline.csv\n\n# Parse all LNK files on entire system (recursive)\nLECmd.exe -d \"C:\\Users\" --csv output --csvf all_lnk_files.csv --all\n```\n\n**Output (CSV)**:\n```csv\nSourceFile,TargetPath,TargetCreated,TargetModified,TargetAccessed,VolumeSerialNumber,MACAddress,DriveType\nC:\\Users\\jsmith\\Recent\\TradSecrets.lnk,\\\\FileServer\\Confidential\\TradSecrets.docx,2024-01-15 10:00,2024-03-10 14:30,2024-03-15 09:00,5A6B-7C8D,AA:BB:CC:DD:EE:FF,Network\nC:\\Users\\jsmith\\Recent\\USB_Data.lnk,E:\\StolenData\\Passwords.xlsx,2024-02-20 08:00,2024-03-14 16:00,2024-03-15 08:45,1A2B-3C4D,AA:BB:CC:DD:EE:FF,Removable\n```\n\n**Forensic Interpretation**:\n\n1. **TradSecrets.lnk**:\n   - Target: Network share (\\\\FileServer\\Confidential\\)\n   - Last accessed: 2024-03-15 09:00\n   - Proves user accessed confidential data from network\n\n2. **USB_Data.lnk**:\n   - Target: Removable drive E:\\\n   - Volume serial: 1A2B-3C4D (identifies specific USB device)\n   - Last accessed: 2024-03-15 08:45\n   - Proves user accessed data from USB device\n\n### Workflow 2: Network Share Access Detection\n\n**Goal**: Identify all files accessed from network shares.\n\n```python\nimport pandas as pd\n\n# Load LNK timeline\nlnk_df = pd.read_csv('lnk_timeline.csv')\n\n# Filter for network paths (UNC paths starting with \\\\)\nnetwork_access = lnk_df[lnk_df['TargetPath'].str.startswith('\\\\\\\\', na=False)]\n\nprint(f\"Network file access events: {len(network_access)}\")\nprint(\"\\nAccessed network paths:\")\nfor idx, row in network_access.iterrows():\n    print(f\"{row['TargetAccessed']}: {row['TargetPath']}\")\n```\n\n**Expected Output**:\n```\nNetwork file access events: 47\n\nAccessed network paths:\n2024-03-15 09:00: \\\\FileServer\\Confidential\\TradSecrets.docx\n2024-03-14 16:30: \\\\FileServer\\HR\\Salaries_2024.xlsx\n2024-03-13 10:15: \\\\BackupServer\\Archives\\OldData.zip\n...\n```\n\n**Forensic Significance**: User accessed 47 files from network shares (potential data theft vector).\n\n### Workflow 3: USB Device Tracking\n\n**Goal**: Identify files accessed from removable media (USB drives).\n\n```python\nimport pandas as pd\n\n# Load LNK timeline\nlnk_df = pd.read_csv('lnk_timeline.csv')\n\n# Filter for removable drives\nusb_access = lnk_df[lnk_df['DriveType'] == 'Removable']\n\n# Group by volume serial number (identifies unique USB devices)\nusb_devices = usb_access.groupby('VolumeSerialNumber')\n\nprint(f\"Unique USB devices detected: {len(usb_devices)}\\n\")\n\nfor serial, group in usb_devices:\n    print(f\"USB Device (Serial: {serial}):\")\n    print(f\"  Files accessed: {len(group)}\")\n    print(f\"  First access: {group['TargetAccessed'].min()}\")\n    print(f\"  Last access: {group['TargetAccessed'].max()}\")\n    print(f\"  Sample files:\")\n    for idx, row in group.head(3).iterrows():\n        print(f\"    - {row['TargetPath']}\")\n    print()\n```\n\n**Expected Output**:\n```\nUnique USB devices detected: 3\n\nUSB Device (Serial: 1A2B-3C4D):\n  Files accessed: 23\n  First access: 2024-03-10 08:00\n  Last access: 2024-03-15 09:00\n  Sample files:\n    - E:\\StolenData\\Confidential.docx\n    - E:\\StolenData\\Passwords.xlsx\n    - E:\\StolenData\\TradSecrets.pdf\n\nUSB Device (Serial: 5E6F-7G8H):\n  Files accessed: 12\n  First access: 2024-02-20 10:00\n  Last access: 2024-03-01 14:00\n  Sample files:\n    - F:\\Backup\\OldFiles.zip\n    - F:\\Backup\\Archives.rar\n    - F:\\Backup\\Documents.7z\n```\n\n**Forensic Conclusions**:\n1. User accessed 23 files from USB device 1A2B-3C4D (suspicious filenames: \"StolenData\")\n2. Timeline: March 10-15 (5 days before investigation)\n3. Cross-reference with USB artifacts (USBSTOR registry) to identify physical device\n\n### Workflow 4: MAC Address Correlation\n\n**Goal**: Identify which computer created LNK files (multi-computer investigations).\n\n```python\nimport pandas as pd\n\n# Load LNK timeline\nlnk_df = pd.read_csv('lnk_timeline.csv')\n\n# Group by MAC address\nmac_groups = lnk_df.groupby('MACAddress')\n\nprint(f\"Computers identified: {len(mac_groups)}\\n\")\n\nfor mac, group in mac_groups:\n    print(f\"Computer (MAC: {mac}):\")\n    print(f\"  LNK files created: {len(group)}\")\n    print(f\"  Date range: {group['TargetAccessed'].min()} to {group['TargetAccessed'].max()}\")\n    print()\n```\n\n**Expected Output**:\n```\nComputers identified: 2\n\nComputer (MAC: AA:BB:CC:DD:EE:FF):\n  LNK files created: 89\n  Date range: 2024-01-01 to 2024-03-15\n\nComputer (MAC: 11:22:33:44:55:66):\n  LNK files created: 3\n  Date range: 2024-03-14 to 2024-03-15\n```\n\n**Forensic Interpretation**:\n- Primary computer (AA:BB:CC:DD:EE:FF): 89 LNK files over 3 months (normal usage)\n- Secondary computer (11:22:33:44:55:66): 3 LNK files on March 14-15 (suspicious - lateral movement?)\n\n**Next Steps**: Cross-reference MAC addresses with network logs, DHCP, and system registry.\n\n---\n\n## Advanced LNK Analysis\n\n### Detecting LNK Manipulation (Anti-Forensics)\n\n**Red Flags**:\n\n1. **LNK creation time AFTER target file deletion**:\n```python\n# Check if LNK was created after target file was deleted\nif lnk_created > target_last_modified + 1_hour:\n    print(\"âš ï¸ SUSPICIOUS: LNK created long after target file was last modified\")\n    print(\"Possible: User manually created LNK, or LNK was planted\")\n```\n\n2. **Missing MAC address** (should be present in older Windows versions):\n```python\nif lnk_mac_address is None and windows_version < 10:\n    print(\"âš ï¸ SUSPICIOUS: MAC address missing (possible LNK tampering)\")\n```\n\n3. **Mismatched timestamps** (LNK modified time doesn't match target access pattern):\n```python\nif lnk_modified_time != target_accessed_time:\n    print(\"âš ï¸ SUSPICIOUS: LNK timestamps don't align with target access\")\n```\n\n### Correlation with Other Artifacts\n\n**LNK + Prefetch**:\n```\nLNK: TradSecrets.docx accessed at 2024-03-15 09:00\nPrefetch: WINWORD.EXE last run at 2024-03-15 09:00\n\nConclusion: User opened Word document at 09:00 (corroborated)\n```\n\n**LNK + Jump Lists**:\n```\nLNK: File accessed from Recent folder\nJump List: Same file in Word's Jump List (Most Frequently Used)\n\nConclusion: User accessed file multiple times (high-interest document)\n```\n\n**LNK + USB Artifacts**:\n```\nLNK: Volume serial 1A2B-3C4D, Drive E:\\\nUSBSTOR Registry: Device serial 4C530012345678, Volume serial 1A2B-3C4D\n\nConclusion: Same USB device (physical device identified)\n```\n\n---\n\n## LNK File Limitations\n\n### Limitation 1: No File Contents\n\nLNK files contain **metadata only** (paths, timestamps, serial numbers).\n\n**Impact**: Cannot recover actual file contents if target deleted.\n\n**Mitigation**: Use LNK as pointer to search for file in unallocated space (file carving).\n\n### Limitation 2: User Can Delete LNK Files\n\nLNK files in Recent folder can be manually deleted by user.\n\n**Impact**: File access history may be incomplete.\n\n**Mitigation**: Check for deleted LNK files in:\n- Unallocated space (file carving)\n- Volume Shadow Copies (VSS snapshots)\n- $I30 slack space (deleted directory entries)\n\n### Limitation 3: Not All File Access Creates LNK\n\nLNK files created primarily for:\n- Files opened via File Explorer\n- Files opened via Office apps (with \"Add to Recent\" enabled)\n- User-created Desktop shortcuts\n\n**NOT created for**:\n- Command-line file access (`type file.txt`)\n- Programmatic file access (scripts, malware)\n- Files opened from within applications (some cases)\n\n**Mitigation**: Combine LNK analysis with Prefetch, AmCache, USN Journal.\n\n---\n\n## Real-World Case Example\n\n### Insider Threat: Data Exfiltration via USB\n\n**Scenario**: Employee resigns. Company suspects data theft.\n\n**LNK Analysis**:\n\n```bash\n# Extract all LNK files from suspect's profile\nLECmd.exe -d \"C:\\Users\\suspect\\AppData\\Roaming\\Microsoft\\Windows\\Recent\" --csv output --csvf lnk.csv\n\n# Analyze in Python\nimport pandas as pd\nlnk = pd.read_csv('lnk.csv')\n\n# Find USB access\nusb = lnk[lnk['DriveType'] == 'Removable']\nprint(f\"USB files accessed: {len(usb)}\")\n\n# Find network share access\nnetwork = lnk[lnk['TargetPath'].str.startswith('\\\\\\\\', na=False)]\nprint(f\"Network files accessed: {len(network)}\")\n\n# Timeline: Last 30 days before resignation\nresignation_date = '2024-03-15'\nrecent = lnk[lnk['TargetAccessed'] >= '2024-02-15']\nprint(f\"Files accessed in last 30 days: {len(recent)}\")\n```\n\n**Findings**:\n```\nUSB files accessed: 67\nNetwork files accessed: 123\nFiles accessed in last 30 days: 190\n\nSuspicious patterns:\n  - 67 confidential files accessed from USB (E:\\StolenData\\)\n  - 123 files accessed from \\\\FileServer\\Confidential\\\n  - Activity spike: 190 file accesses in 30 days (vs 50/month average)\n```\n\n**Evidence Presented**:\n1. LNK files prove suspect accessed 67 files from USB device (volume serial 1A2B-3C4D)\n2. Timeline: Spike in activity before resignation (data staging)\n3. File paths: \"StolenData\", \"Confidential\" (consciousness of guilt)\n\n**Outcome**: Civil lawsuit, $500K settlement, criminal referral."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "# Hands-On: LNK File Analysis Lab\n\n## Lab Scenario\n\nYou're investigating a suspected insider threat. The employee (username: mthomas) resigned and wiped their laptop. You recovered a forensic image before the wipe completed.\n\n**Evidence**: Recent folder with 89 LNK files\n\n---\n\n## Exercise 1: Parse LNK Files with LECmd\n\n```bash\n# Extract all LNK files from Recent folder\nLECmd.exe -d \"E:\\Evidence\\Users\\mthomas\\AppData\\Roaming\\Microsoft\\Windows\\Recent\" --csv C:\\Analysis --csvf lnk_timeline.csv\n```\n\n**Expected Output**:\n```\nProcessing 89 LNK files...\nOutput: C:\\Analysis\\lnk_timeline.csv\nProcessing complete: 89 files parsed, 0 errors\n```\n\n---\n\n## Exercise 2: Identify Network Share Access\n\n```python\nimport pandas as pd\n\nlnk = pd.read_csv('C:\\\\Analysis\\\\lnk_timeline.csv')\n\n# Filter for UNC paths (network shares)\nnetwork = lnk[lnk['TargetPath'].str.startswith('\\\\\\\\', na=False)]\n\nprint(f\"Network file access: {len(network)} files\\n\")\nprint(\"Top 10 accessed network files:\")\nfor idx, row in network.head(10).iterrows():\n    print(f\"{row['TargetAccessed']}: {row['TargetPath']}\")\n```\n\n**Expected Output**:\n```\nNetwork file access: 47 files\n\nTop 10 accessed network files:\n2024-03-15 08:30: \\\\FileServer\\Confidential\\Q1_Financials.xlsx\n2024-03-15 08:32: \\\\FileServer\\Confidential\\CustomerList.docx\n2024-03-15 08:35: \\\\FileServer\\Confidential\\Passwords_DO_NOT_SHARE.txt\n2024-03-14 16:00: \\\\FileServer\\HR\\Salaries_2024.xlsx\n2024-03-14 15:45: \\\\FileServer\\Engineering\\SourceCode.zip\n...\n```\n\n---\n\n## Exercise 3: Track USB Device Usage\n\n```python\nimport pandas as pd\n\nlnk = pd.read_csv('C:\\\\Analysis\\\\lnk_timeline.csv')\n\n# Filter for removable drives\nusb = lnk[lnk['DriveType'] == 'Removable']\n\nif len(usb) > 0:\n    print(f\"USB device access detected: {len(usb)} files\\n\")\n    \n    # Group by volume serial number\n    for serial in usb['VolumeSerialNumber'].unique():\n        device_files = usb[usb['VolumeSerialNumber'] == serial]\n        print(f\"\\nUSB Device (Serial: {serial}):\")\n        print(f\"  Files accessed: {len(device_files)}\")\n        print(f\"  First access: {device_files['TargetAccessed'].min()}\")\n        print(f\"  Last access: {device_files['TargetAccessed'].max()}\")\n        print(f\"  Sample files:\")\n        for idx, row in device_files.head(5).iterrows():\n            print(f\"    - {row['TargetPath']}\")\nelse:\n    print(\"No USB device access detected.\")\n```\n\n**Expected Output**:\n```\nUSB device access detected: 23 files\n\nUSB Device (Serial: 1A2B-3C4D):\n  Files accessed: 23\n  First access: 2024-03-10 10:00\n  Last access: 2024-03-15 09:00\n  Sample files:\n    - E:\\ExfilData\\Q1_Financials_COPY.xlsx\n    - E:\\ExfilData\\CustomerList_COPY.docx\n    - E:\\ExfilData\\Passwords_BACKUP.txt\n    - E:\\ExfilData\\Salaries_2024_COPY.xlsx\n    - E:\\ExfilData\\SourceCode_BACKUP.zip\n```\n\n**Forensic Red Flags**:\n1. File naming pattern: \"_COPY\", \"_BACKUP\" (consciousness of guilt)\n2. 23 files copied to USB over 5 days (March 10-15)\n3. Filenames match network share files (exfiltration confirmed)\n\n---\n\n## Exercise 4: Build Timeline Correlation\n\n```python\nimport pandas as pd\n\nlnk = pd.read_csv('C:\\\\Analysis\\\\lnk_timeline.csv')\n\n# Create timeline of all file access\ntimeline = lnk[['TargetAccessed', 'TargetPath', 'DriveType', 'VolumeSerialNumber']].copy()\ntimeline = timeline.sort_values('TargetAccessed')\n\nprint(\"File Access Timeline (Last 10 events):\\n\")\nfor idx, row in timeline.tail(10).iterrows():\n    if row['DriveType'] == 'Removable':\n        location = f\"USB ({row['VolumeSerialNumber']})\"\n    elif row['TargetPath'].startswith('\\\\\\\\'):\n        location = \"Network Share\"\n    else:\n        location = \"Local Drive\"\n    \n    print(f\"{row['TargetAccessed']} | {location:20} | {row['TargetPath']}\")\n```\n\n**Expected Output**:\n```\nFile Access Timeline (Last 10 events):\n\n2024-03-15 08:30 | Network Share        | \\\\FileServer\\Confidential\\Q1_Financials.xlsx\n2024-03-15 08:32 | Network Share        | \\\\FileServer\\Confidential\\CustomerList.docx\n2024-03-15 08:35 | Network Share        | \\\\FileServer\\Confidential\\Passwords.txt\n2024-03-15 08:40 | USB (1A2B-3C4D)      | E:\\ExfilData\\Q1_Financials_COPY.xlsx\n2024-03-15 08:42 | USB (1A2B-3C4D)      | E:\\ExfilData\\CustomerList_COPY.docx\n2024-03-15 08:45 | USB (1A2B-3C4D)      | E:\\ExfilData\\Passwords_BACKUP.txt\n2024-03-15 08:50 | Local Drive          | C:\\Users\\mthomas\\Desktop\\README_DELETE_AFTER.txt\n2024-03-15 09:00 | USB (1A2B-3C4D)      | E:\\ExfilData\\FINAL_BACKUP.zip\n```\n\n**Attack Narrative**:\n```\n08:30-08:35: Accessed 3 confidential files from network share\n08:40-08:45: Copied same 3 files to USB device (exfiltration)\n08:50: Created local \"README_DELETE_AFTER.txt\" (anti-forensics intent)\n09:00: Created FINAL_BACKUP.zip on USB (consolidated exfiltration)\n```\n\n---\n\n## Exercise 5: Correlate with USB Registry Artifacts\n\n```python\n# Cross-reference LNK volume serial with USB registry data\n\n# From LNK analysis:\nlnk_usb_serial = \"1A2B-3C4D\"\n\n# From USB registry analysis (USBSTOR, MountPoints2):\nusb_device_info = {\n    \"Device\": \"SanDisk Ultra USB 3.0\",\n    \"Serial\": \"4C530012345678\",\n    \"Volume Serial\": \"1A2B-3C4D\",  # Matches LNK!\n    \"First Insertion\": \"2024-03-10 09:58:00\",\n    \"Last Removal\": \"2024-03-15 09:05:00\"\n}\n\nif lnk_usb_serial == usb_device_info[\"Volume Serial\"]:\n    print(\"âœ… LNK volume serial MATCHES USB registry artifact\\n\")\n    print(\"Device Identified:\")\n    for key, value in usb_device_info.items():\n        print(f\"  {key}: {value}\")\n    print(\"\\nConclusion: Employee used SanDisk Ultra USB to exfiltrate 23 files.\")\n```\n\n**Expected Output**:\n```\nâœ… LNK volume serial MATCHES USB registry artifact\n\nDevice Identified:\n  Device: SanDisk Ultra USB 3.0\n  Serial: 4C530012345678\n  Volume Serial: 1A2B-3C4D\n  First Insertion: 2024-03-10 09:58:00\n  Last Removal: 2024-03-15 09:05:00\n\nConclusion: Employee used SanDisk Ultra USB to exfiltrate 23 files.\n```\n\n---\n\n## Exercise 6: Generate Forensic Report\n\n```markdown\n# LNK File Analysis Report: Insider Threat Investigation\n\n## Case Information\n**Subject**: mthomas (Employee ID: 7890)\n**Investigation Date**: 2024-03-20\n**Evidence Source**: Forensic image of laptop (before wipe completed)\n\n## Key Findings\n\n### 1. Network Share Access (47 files)\n- **Location**: \\\\FileServer\\Confidential\\\n- **Timeframe**: 2024-03-14 to 2024-03-15\n- **Files**: Q1_Financials.xlsx, CustomerList.docx, Passwords.txt, Salaries_2024.xlsx\n\n### 2. USB Device Exfiltration (23 files)\n- **Device**: SanDisk Ultra USB 3.0 (Serial: 4C530012345678)\n- **Volume Serial**: 1A2B-3C4D\n- **Timeframe**: 2024-03-10 to 2024-03-15 (5 days)\n- **File Naming Pattern**: \"_COPY\", \"_BACKUP\" (indicates intentional duplication)\n\n### 3. Timeline Correlation\n```\n08:30-08:35: Access confidential files from network share\n08:40-08:45: Copy same files to USB (exfiltration window)\n08:50: Create anti-forensics note (\"README_DELETE_AFTER.txt\")\n09:00: Final backup created on USB\n09:05: USB device removed (last access)\n```\n\n### 4. Evidence Preservation\n- LNK files extracted: 89 total\n- Network access events: 47\n- USB access events: 23\n- MAC address: AA:BB:CC:DD:EE:FF (mthomas's laptop)\n\n## Conclusions\n\n1. **Data Theft Confirmed**: Employee accessed 47 confidential files from network and exfiltrated 23 files to USB\n2. **Premeditated Activity**: 5-day window (March 10-15) indicates planned exfiltration\n3. **Anti-Forensics Intent**: File naming (\"_COPY\", \"_BACKUP\") and \"README_DELETE_AFTER.txt\" show consciousness of guilt\n4. **Device Identified**: Physical USB device (SanDisk Ultra, Serial 4C530012345678) can be seized if located\n\n## Recommendations\n\n1. Civil litigation for trade secret theft\n2. Seize USB device (if in employee's possession)\n3. File criminal referral (computer fraud, theft of trade secrets)\n4. Implement DLP and USB blocking on corporate network\n```\n\n**Deliver your forensic report!**"
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "# Real-World Case: LNK Files Convict Insider Threat (2016)\n\n## Case Overview\n\n**Company**: Major pharmaceutical firm (Fortune 500)  \n**Suspect**: Senior researcher (10-year tenure)  \n**Allegation**: Stole proprietary drug formulas before joining competitor  \n**Evidence**: LNK files proved theft despite disk wiping  \n\n---\n\n## Investigation Timeline\n\n### Day 1: Resignation and Alert\n\n```\n2016-05-15: Suspect submits resignation\n2016-05-16: IT security notices:\n  - CCleaner executed on suspect's laptop (Prefetch evidence)\n  - Multiple files deleted from \\\\ResearchServer\\Formulas\\\n  - Suspect's laptop returned to IT \"for disposal\"\n```\n\n### Day 2: Forensic Acquisition\n\n```\n2016-05-17: Security team acquires laptop forensic image\n  - CCleaner had wiped:\n    âœ— Unallocated space (0x00 overwrite)\n    âœ— Browser history\n    âœ— Recycle Bin\n    âœ— Recent files list (attempted)\n  \n  - But LNK files SURVIVED in:\n    âœ“ C:\\Users\\researcher\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\\n    âœ“ Desktop shortcuts\n    âœ“ Office Jump Lists (AutomaticDestinations)\n```\n\n---\n\n## LNK File Analysis\n\n### Extraction\n\n```bash\n# Forensic analyst command\nLECmd.exe -d \"C:\\Users\\researcher\\AppData\\Roaming\\Microsoft\\Windows\\Recent\" --csv Evidence --csvf lnk_analysis.csv --all\n\nResults:\n  - 234 LNK files recovered\n  - 89 pointing to \\\\ResearchServer\\Formulas\\\n  - 45 pointing to USB drive E:\\ (volume serial: 2F4A-5D6C)\n```\n\n### Key Findings\n\n**Finding 1: Network Share Access**\n\n```csv\nTargetPath,TargetAccessed,FileSize,VolumeSerialNumber\n\\\\ResearchServer\\Formulas\\DrugX_Formula_Final.docx,2016-05-10 14:22,245KB,8A9B-1C2D\n\\\\ResearchServer\\Formulas\\DrugY_Clinical_Results.xlsx,2016-05-10 14:25,1.2MB,8A9B-1C2D\n\\\\ResearchServer\\Formulas\\DrugZ_Patent_Application.pdf,2016-05-10 14:30,567KB,8A9B-1C2D\n...\n(89 total files from \\\\ResearchServer\\Formulas\\ accessed May 10-14)\n```\n\n**Forensic Significance**:\n- 89 proprietary formulas accessed 1 week before resignation\n- All files from restricted \"Formulas\" share (requires elevated access)\n- Timestamps: May 10-14 (systematic access over 5 days)\n\n**Finding 2: USB Device Exfiltration**\n\n```csv\nTargetPath,TargetAccessed,DriveType,VolumeSerialNumber\nE:\\BACKUP\\DrugX_Formula_COPY.docx,2016-05-10 14:35,Removable,2F4A-5D6C\nE:\\BACKUP\\DrugY_Clinical_COPY.xlsx,2016-05-10 14:38,Removable,2F4A-5D6C\nE:\\BACKUP\\DrugZ_Patent_COPY.pdf,2016-05-10 14:42,Removable,2F4A-5D6C\n...\n(45 total files copied to USB drive E:\\)\n```\n\n**Forensic Significance**:\n- Same 45 files accessed from network, then immediately copied to USB\n- File naming: \"_COPY\" suffix (indicates manual duplication)\n- USB volume serial: 2F4A-5D6C (identifies specific device)\n\n**Finding 3: Timeline Correlation**\n\n```\nMay 10, 2016:\n  14:22-14:32: Accessed 89 files from \\\\ResearchServer\\Formulas\\ (10 minutes)\n  14:35-14:55: Copied 45 files to USB drive E:\\ (20 minutes)\n  14:58: USB device removed (USB registry timestamp)\n  \nMay 11-14, 2016:\n  Additional access to network share (viewing files)\n  No USB activity detected\n  \nMay 15, 2016:\n  Resignation submitted\n  \nMay 16, 2016:\n  CCleaner executed (anti-forensics)\n  Laptop returned to IT\n```\n\n---\n\n## Cross-Artifact Validation\n\n### LNK + USB Registry\n\n**USB Artifacts** (USBSTOR, MountedDevices, MountPoints2):\n\n```\nDevice: SanDisk Cruzer Glide 32GB\nDevice Serial: 4C531001123456\nVolume Serial: 2F4A-5D6C (MATCHES LNK!)\nFirst Insertion: 2016-05-10 14:33:00\nLast Removal: 2016-05-10 14:58:00\nDrive Letter: E:\\\nUser: researcher (SID: S-1-5-21-...-1001)\n```\n\n**Convergence**: LNK volume serial MATCHES USB registry â†’ Same physical device confirmed.\n\n### LNK + Prefetch\n\n**Prefetch Files**:\n\n```\nWORD.EXE-ABCD1234.pf:\n  Last Run: 2016-05-10 14:22\n  Run Count: 47\n  Files Loaded: DrugX_Formula_Final.docx (via \\\\ResearchServer\\)\n  \nEXCEL.EXE-EFGH5678.pf:\n  Last Run: 2016-05-10 14:25\n  Run Count: 34\n  Files Loaded: DrugY_Clinical_Results.xlsx (via \\\\ResearchServer\\)\n```\n\n**Convergence**: Prefetch execution times MATCH LNK access times â†’ Corroborates file opening.\n\n### LNK + Network Logs\n\n**SMB Access Logs** (from file server):\n\n```\n2016-05-10 14:22:15 | 10.10.1.50 | researcher | READ | \\\\ResearchServer\\Formulas\\DrugX_Formula_Final.docx\n2016-05-10 14:25:30 | 10.10.1.50 | researcher | READ | \\\\ResearchServer\\Formulas\\DrugY_Clinical_Results.xlsx\n2016-05-10 14:30:45 | 10.10.1.50 | researcher | READ | \\\\ResearchServer\\Formulas\\DrugZ_Patent_Application.pdf\n...\n```\n\n**Convergence**: Network logs confirm file access from suspect's IP (10.10.1.50) at EXACT timestamps from LNK files.\n\n---\n\n## Legal Proceedings\n\n### Civil Lawsuit (Trade Secret Theft)\n\n**Plaintiff Evidence Presentation**:\n\n**Exhibit A**: LNK file analysis report (234 LNK files, 89 network, 45 USB)  \n**Exhibit B**: USB device identification (SanDisk Cruzer, Serial 4C531001123456)  \n**Exhibit C**: Timeline correlation (network access â†’ USB copy â†’ resignation)  \n**Exhibit D**: Anti-forensics evidence (CCleaner execution after resignation)  \n\n**Defense Argument**:\n\n> \"The LNK files merely show that my client accessed files as part of his job duties. There's no proof he STOLE anything.\"\n\n**Plaintiff Rebuttal**:\n\n> \"The LNK files show 45 files copied to USB with '_COPY' suffix naming. The timeline shows systematic exfiltration over 5 days, followed by resignation and anti-forensics (CCleaner). The convergence of LNK + USB + Prefetch + network logs provides IRREFUTABLE PROOF of theft.\"\n\n**Court Ruling**:\n\n- **Finding**: Preponderance of evidence supports trade secret theft\n- **Reasoning**: LNK files + USB artifacts + timeline = consciousness of guilt\n- **Award**: $2.3 million in damages + injunction against competitor\n\n### Criminal Referral (Economic Espionage)\n\n**FBI Investigation**:\n\n```\nCriminal Statute: 18 U.S.C. Â§ 1831 (Economic Espionage Act)\n\nElements:\n  1. Trade secrets misappropriated âœ“ (LNK files prove access)\n  2. Intended to benefit foreign/domestic entity âœ“ (joined competitor)\n  3. Knowledge that offense would injure owner âœ“ (anti-forensics = consciousness)\n  \nEvidence:\n  - LNK files (234 recovered)\n  - USB device (seized from suspect's home)\n  - Network logs (corroborate access)\n  - Employment records (resigned 5 days after theft)\n```\n\n**Outcome**:\n- **Plea Deal**: Guilty plea to one count of trade secret theft\n- **Sentence**: 18 months federal prison + $500K restitution\n- **Forfeiture**: USB device seized and destroyed\n\n---\n\n## Forensic Lessons Learned\n\n### 1. LNK Files Survive Wiping\n\n**CCleaner Limitations**:\n- Wipes unallocated space âœ“\n- Wipes browser history âœ“\n- Attempts to wipe Recent folder... but:\n  - May miss subdirectories\n  - May miss locked files (in-use LNK files)\n  - May miss hidden/system folders\n\n**Result**: 234 LNK files SURVIVED despite CCleaner execution.\n\n**Forensic Principle**: Anti-forensics tools are NEVER 100% effective. Always check for surviving artifacts.\n\n### 2. Volume Serial Numbers are Device Fingerprints\n\n**LNK Volume Serial + USB Registry = Physical Device Identification**\n\n```\nLNK: Volume serial 2F4A-5D6C\n  â†“\nUSB Registry: Volume serial 2F4A-5D6C â†’ Device serial 4C531001123456\n  â†“\nPhysical Device: SanDisk Cruzer seized from suspect's home\n  â†“\nForensic Analysis: Files recovered from USB match LNK file list\n```\n\n**Forensic Gold**: Volume serial links LNK evidence to physical USB device.\n\n### 3. Timeline Correlation Defeats Defenses\n\n**Defense Claim**: \"I accessed files for legitimate work.\"\n\n**Prosecution Timeline**:\n\n```\nMay 10 14:22: Access 89 files (10 minutes - too fast for reading)\nMay 10 14:35: Copy 45 files to USB (immediately after access)\nMay 10 14:58: USB removed (no further use)\nMay 15: Resignation submitted (5 days later)\nMay 16: CCleaner executed (anti-forensics)\n```\n\n**Rebuttal**: Timeline proves SYSTEMATIC EXFILTRATION, not legitimate work.\n\n### 4. Convergence of Evidence is Irrefutable\n\n**Single Artifact**: Challengeable (\"LNK files could be wrong\")  \n**Multiple Artifacts**: Irrefutable (\"LNK + USB + Prefetch + Network logs ALL agree\")\n\n**Court Standard**: Preponderance of evidence (civil) = >50% likelihood  \n**This Case**: 4 independent artifacts converging = >99% likelihood\n\n---\n\n## Key Takeaway\n\n**LNK files are forensic breadcrumbs that CAN'T be fully erased**, even with anti-forensics tools. They provide:\n\n1. **File Access History**: What files were accessed\n2. **Timeline**: When files were accessed\n3. **Location**: Where files were located (network, USB, local)\n4. **Device Fingerprints**: Volume serials identify specific devices\n5. **Convergence**: Corroborate with USB, Prefetch, network logs\n\n**For DFIR professionals**: Always analyze LNK files in insider threat cases - they often survive when other artifacts are wiped."
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "# Memory Aids: LNK File Analysis\n\n## \"LNK = Link to the Past\"\n\nLNK files are shortcuts, but forensically they're **links to the past** (file access history).\n\n```\nLNK file = Time machine showing:\n  - What files existed\n  - When they were accessed\n  - Where they were located\n```\n\n---\n\n## \"Three T's of LNK Forensics\"\n\n```\nT1 = TARGET (what file was accessed)\nT2 = TIMESTAMP (when file was accessed)\nT3 = TRACKING (volume serial, MAC address - identifies where/who)\n```\n\n---\n\n## \"Volume Serial = USB Fingerprint\"\n\nVolume serial number in LNK file is like a fingerprint for USB devices.\n\n```\nLNK: Volume serial 1A2B-3C4D\n  â†“\nUSB Registry: Same serial â†’ Device identified\n  â†“\nPhysical Device: Seized and analyzed\n```\n\n---\n\n## \"Recent Folder = Surveillance Camera\"\n\n```\nC:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\\n\n= Automatic surveillance camera recording every file opened\n```\n\n**Memory Hook**: Windows is watching and recording in the Recent folder.\n\n---\n\n## \"MAC = Machine Address = Computer ID\"\n\nMAC address in LNK file identifies the COMPUTER where LNK was created.\n\n```\nMAC address AA:BB:CC:DD:EE:FF\n  = Fingerprint of specific computer\n  = Links LNK to suspect's machine\n```\n\n---\n\n## Quick Reference Card\n\n```\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\nâ•‘  LNK FILE FORENSICS CHEAT SHEET                           â•‘\nâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\nâ•‘  TOOL: LECmd.exe -d Recent\\ --csv output.csv              â•‘\nâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\nâ•‘  KEY METADATA:                                            â•‘\nâ•‘    âœ“ Target path (file location)                          â•‘\nâ•‘    âœ“ Timestamps (file created/modified/accessed)          â•‘\nâ•‘    âœ“ Volume serial (identifies drive/USB)                 â•‘\nâ•‘    âœ“ MAC address (identifies computer)                    â•‘\nâ•‘    âœ“ File size (validates file identity)                  â•‘\nâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\nâ•‘  LOCATIONS:                                               â•‘\nâ•‘    Recent: C:\\Users\\<user>\\AppData\\..\\Recent\\            â•‘\nâ•‘    Desktop: C:\\Users\\<user>\\Desktop\\                      â•‘\nâ•‘    Jump Lists: C:\\Users\\<user>\\AppData\\..\\Recent\\        â•‘\nâ•‘                AutomaticDestinations\\                      â•‘\nâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\nâ•‘  FORENSIC VALUE:                                          â•‘\nâ•‘    âœ“ Proves file access (even if file deleted)            â•‘\nâ•‘    âœ“ Network share tracking (UNC paths)                   â•‘\nâ•‘    âœ“ USB device identification (volume serial)            â•‘\nâ•‘    âœ“ Timeline reconstruction (access history)             â•‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n```"
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "# Reflection Questions\n\n## Question 1: LNK vs Other Artifacts\n\n**Scenario**: You're investigating file access. Which artifact provides MORE specific evidence: LNK files or Prefetch?\n\n**Reflect**:\n1. What does LNK tell you that Prefetch doesn't?\n2. What does Prefetch tell you that LNK doesn't?\n3. Why is using BOTH artifacts the best approach?\n\n---\n\n## Question 2: Privacy vs Security\n\n**LNK files reveal every document a user opened** (personal medical records, financial documents, private correspondence).\n\n**Reflect**:\n1. In a corporate investigation, should you analyze ALL LNK files or only work-related ones?\n2. What if you discover employee's job search activity (resume.docx) - do you report this?\n3. How do you balance thorough investigation with privacy rights?\n\n---\n\n## Question 3: Anti-Forensics Effectiveness\n\n**Scenario**: A sophisticated attacker knows about LNK files and manually deletes the Recent folder.\n\n**Reflect**:\n1. Can you still recover LNK evidence? (Hint: Unallocated space, VSS, $I30 slack)\n2. What OTHER artifacts track file access if LNK files are gone? (Prefetch, Jump Lists, Office MRU)\n3. As a red teamer, how would you COMPLETELY erase LNK evidence?\n\n---\n\n## Congratulations!\n\nYou've mastered LNK file analysis - a powerful technique for tracking user file access!\n\n**Next**: Lesson 35 - Jump Lists Forensics (application-specific file access history)"
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "# LNK File Forensics Complete! ğŸ”—âœ…\n\n## What You've Achieved\n\nâœ… **LNK file structure** - Headers, LinkInfo, TrackerData  \nâœ… **LECmd proficiency** - Automated LNK parsing  \nâœ… **Network share tracking** - UNC path analysis  \nâœ… **USB device identification** - Volume serial correlation  \nâœ… **Timeline reconstruction** - File access history  \nâœ… **Real-world application** - Insider threat conviction case  \n\n**LNK files are breadcrumbs users can't erase** - they survive wiping, deletion, and anti-forensics.\n\n---\n\n## Real-World Power\n\nYou can now:\n- Prove file access even when files are deleted\n- Track USB exfiltration via volume serials\n- Identify network share access patterns\n- Reconstruct timelines for insider threat cases\n- Testify in court about LNK evidence reliability\n\n---\n\n## Next Challenge\n\n**Lesson 35: Jump Lists Forensics** - Application-specific file access tracking (deeper than LNK files).\n\nYou'll learn:\n- AutomaticDestinations vs CustomDestinations\n- Application-specific file history (Word, Excel, browsers)\n- JLECmd parsing workflows\n\n**See you in the next lesson!** ğŸš€"
      }
    }
  ],
  "tags": [
    "Course: SANS-FOR500",
    "Career Path: DFIR Specialist",
    "Career Path: SOC Analyst"
  ]
}