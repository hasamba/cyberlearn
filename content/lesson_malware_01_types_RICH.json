{
  "lesson_id": "70165ecc-f417-46ec-9206-b726bd55f447",
  "domain": "malware",
  "title": "Malware Types and Classifications",
  "difficulty": 1,
  "order_index": 1,
  "prerequisites": [],
  "concepts": [
    "Viruses",
    "Worms",
    "Trojans",
    "Ransomware",
    "Spyware",
    "Rootkits"
  ],
  "content_blocks": [
    {
      "block_id": "6d4048c8-b421-46b4-b236-94feeec3e1d2",
      "type": "mindset_coach",
      "content": {
        "text": "Malware - malicious software - is the weapon of choice for most cyber attackers. Understanding malware types, behaviors, and detection methods is fundamental to both offensive and defensive security. You're learning the enemy's arsenal.\n\nHere's the critical truth: Malware isn't just files with viruses anymore. Modern malware includes sophisticated ransomware demanding millions, nation-state espionage tools, banking trojans stealing credentials, and cryptominers using your resources. Each type has different goals, behaviors, and defenses.\n\nMany people think antivirus stops all malware. Reality: Signature-based detection catches known malware, but new variants emerge constantly. Advanced malware uses obfuscation, encryption, and polymorphism to evade detection. You need to understand malware behavior, not just rely on automated tools.\n\nThink of malware analysis like understanding different criminal methodologies. Bank robbers, burglars, pickpockets, and con artists all have different techniques. Similarly, viruses, worms, trojans, and ransomware all operate differently. Know the methodology, predict the behavior.\n\nThe fascinating part: Malware analysis is like solving puzzles. Reverse engineering malware to understand what it does, how it spreads, and how to stop it requires technical skill and investigative thinking. It's intellectually challenging and directly protects organizations."
      },
      "simplified_explanation": "Malware = malicious software designed to harm systems or steal data. Different types work differently: viruses spread by infecting files, worms spread automatically, trojans trick users, ransomware encrypts files for money, spyware steals information, rootkits hide deeply in systems.",
      "memory_aids": [
        "Virus = infects files like biological virus infects cells",
        "Worm = spreads itself automatically (worms move on their own)",
        "Trojan = disguised as legitimate (Trojan horse trick)",
        "Ransomware = holds data hostage for ransom"
      ],
      "teach_like_im_10": "Bad guys write computer programs that do bad things. Viruses copy themselves into your files. Worms jump between computers automatically. Trojans pretend to be good programs but are actually bad. Ransomware locks your files and demands money. Spyware secretly watches what you do."
    },
    {
      "block_id": "0991a617-3b60-4808-b8f9-ed66f9c7f4f0",
      "type": "explanation",
      "content": {
        "text": "## Malware Categories\n\n### 1. Viruses\n\n**Definition**: Malicious code that attaches to legitimate files and replicates when executed.\n\n**Characteristics**:\n- Requires host file (executable, document, script)\n- Spreads when user executes infected file\n- Can modify or delete files\n- Self-replicating\n\n**Types of Viruses**:\n\n**File Infector Virus**: Infects executable files (.exe, .dll)\n- Attaches to legitimate programs\n- Executes when program runs\n- Can spread to other executables\n\n**Macro Virus**: Infects documents with macros (Word, Excel)\n- Embedded in macros\n- Executes when document opened\n- Can spread to other documents\n- Example: Melissa virus (1999)\n\n**Boot Sector Virus**: Infects Master Boot Record\n- Loads before operating system\n- Persistent and difficult to remove\n- Rare today (UEFI/Secure Boot)\n\n**Polymorphic Virus**: Changes its code with each infection\n- Evades signature-based detection\n- Same functionality, different code\n- Sophisticated evasion technique\n\n**Detection and Defense**:\n- Antivirus with up-to-date signatures\n- Behavior-based detection\n- File integrity monitoring\n- Restrict macro execution\n\n### 2. Worms\n\n**Definition**: Self-replicating malware that spreads automatically without user interaction.\n\n**Characteristics**:\n- No host file required (standalone)\n- Spreads automatically across networks\n- Exploits vulnerabilities for propagation\n- Can spread rapidly (WannaCry: 200,000 systems in 4 days)\n\n**Propagation Methods**:\n- Exploiting vulnerabilities (EternalBlue for WannaCry)\n- Email attachments with auto-execute\n- Network shares (SMB worms)\n- Removable media (USB worms)\n- Instant messaging\n\n**Famous Worms**:\n\n**WannaCry (2017)**:\n- Exploited SMBv1 vulnerability (MS17-010)\n- Ransomware worm (encrypted files + demanded payment)\n- Spread to 200,000+ systems worldwide\n- Caused billions in damage\n\n**Conficker (2008)**:\n- Exploited Windows vulnerability\n- Created botnet of millions of computers\n- Still active today on unpatched systems\n\n**Stuxnet (2010)**:\n- Nation-state weapon targeting Iranian nuclear facilities\n- Exploited 4 zero-days\n- First known malware to target ICS/SCADA\n- Physically destroyed centrifuges\n\n**Defense**:\n- Patch vulnerabilities promptly\n- Network segmentation\n- Disable unnecessary services (SMBv1)\n- IDS/IPS to detect worm behavior\n\n### 3. Trojans\n\n**Definition**: Malware disguised as legitimate software.\n\n**Characteristics**:\n- Appears legitimate (game, utility, update)\n- User willingly executes it\n- Does not self-replicate\n- Provides unauthorized access or performs malicious actions\n\n**Types of Trojans**:\n\n**Remote Access Trojan (RAT)**:\n- Provides remote control of infected system\n- Allows attacker to:\n  - Execute commands\n  - Access files\n  - Capture screenshots\n  - Use webcam/microphone\n  - Install additional malware\n- Examples: Poison Ivy, DarkComet, njRAT\n\n**Banking Trojan**:\n- Steals financial credentials\n- Methods:\n  - Keylogging (capture keystrokes)\n  - Form grabbing (steal form data)\n  - Web injection (modify banking pages)\n  - Man-in-the-browser attacks\n- Examples: Zeus, Emotet, TrickBot, Dridex\n\n**Downloader Trojan**:\n- Initial payload that downloads additional malware\n- Often first stage in multi-stage attacks\n- Small and stealthy\n\n**Backdoor Trojan**:\n- Creates persistent unauthorized access\n- Bypasses authentication\n- Remains hidden\n\n**Defense**:\n- Don't download software from untrusted sources\n- Verify signatures and hashes\n- Application whitelisting\n- EDR for behavioral detection\n\n### 4. Ransomware\n\n**Definition**: Malware that encrypts files and demands payment for decryption key.\n\n**Characteristics**:\n- Encrypts files using strong encryption (AES, RSA)\n- Demands ransom (typically cryptocurrency)\n- Countdown timer (pressure tactic)\n- Threatens to delete decryption key\n- Modern variant: Double extortion (encrypt + threaten to leak data)\n\n**Ransomware Evolution**:\n\n**Early Ransomware**: Fake antivirus, screen lockers\n**CryptoLocker (2013)**: First widespread crypto-ransomware\n**WannaCry (2017)**: Ransomware worm, global impact\n**Ryuk, Maze, REvil (2019-2021)**: Targeted, big-game hunting\n**Modern Ransomware**: Double extortion, Ransomware-as-a-Service\n\n**Ransomware Kill Chain**:\n1. Initial Access (phishing, exploit, RDP brute force)\n2. Privilege Escalation\n3. Lateral Movement\n4. Persistence\n5. Defense Evasion (disable AV, delete backups)\n6. Data Exfiltration (for double extortion)\n7. Encryption\n8. Ransom Note\n\n**Defense**:\n- Regular offline backups (3-2-1 rule)\n- Patch vulnerabilities\n- MFA on RDP and VPN\n- Network segmentation\n- EDR with ransomware detection\n- Email filtering and user training\n- Incident response plan\n\n**NEVER Pay Ransom** (FBI recommendation):\n- Funds criminal operations\n- No guarantee of decryption\n- May be targeted again\n\n### 5. Spyware\n\n**Definition**: Malware that secretly monitors and collects information.\n\n**Types**:\n\n**Keylogger**:\n- Records keystrokes\n- Captures passwords, messages, searches\n- Hardware or software-based\n\n**Screen Scraper**:\n- Captures screenshots\n- Can capture on-screen keyboards\n- Defeats keystroke encryption\n\n**Infostealer**:\n- Steals stored credentials\n- Targets:\n  - Browser saved passwords\n  - Cryptocurrency wallets\n  - FTP credentials\n  - Email clients\n  - Gaming accounts\n- Examples: Agent Tesla, Raccoon Stealer, RedLine\n\n**Stalkerware**:\n- Monitors device activity (location, messages, calls)\n- Often marketed as 'parental control' or 'employee monitoring'\n- Ethical and legal concerns\n\n**Defense**:\n- Antivirus/anti-malware\n- Avoid untrusted software\n- Password managers (detect fake login forms)\n- Regular security audits\n\n### 6. Rootkits\n\n**Definition**: Malware that hides its presence and other malware by modifying operating system.\n\n**Characteristics**:\n- Runs with highest privileges (kernel-level)\n- Hides:\n  - Files\n  - Processes\n  - Registry keys\n  - Network connections\n- Very difficult to detect and remove\n- Survives OS reinstall if BIOS/UEFI rootkit\n\n**Types by Level**:\n\n**User-Mode Rootkit**:\n- Runs in user space\n- Easier to detect\n- Modifies APIs and libraries\n\n**Kernel-Mode Rootkit**:\n- Runs in kernel space\n- Highest privilege level\n- Hooks kernel functions\n- Very stealthy\n\n**Bootkit**:\n- Infects boot process\n- Loads before OS\n- Can survive OS reinstall\n\n**Firmware Rootkit**:\n- Infects BIOS/UEFI\n- Persists across hardware replacement\n- Nation-state level sophistication\n\n**Famous Rootkits**:\n- Sony BMG rootkit (2005): DRM that acted as rootkit\n- TDL4/TDSS: Sophisticated bootkit\n- LoJax: UEFI rootkit (APT28)\n\n**Detection**:\n- Behavior-based detection\n- Memory forensics\n- Integrity checking\n- Rootkit scanners (GMER, RootkitRevealer)\n- Boot from clean media for analysis\n\n**Defense**:\n- Keep software updated\n- UEFI Secure Boot\n- Trusted Boot\n- Regular integrity checks\n- EDR with rootkit detection\n\n### 7. Other Malware Types\n\n**Adware**: Displays unwanted advertisements\n- Often bundled with free software\n- Generates revenue for attacker\n- Annoying but less dangerous\n\n**Cryptominer**: Uses system resources to mine cryptocurrency\n- High CPU usage\n- Slows system performance\n- Can damage hardware (overheating)\n- Example: Coinhive (browser-based)\n\n**Botnet**: Network of infected computers controlled remotely\n- Used for DDoS attacks, spam, crypto mining\n- Individual systems called 'bots' or 'zombies'\n- C2 server controls the botnet\n- Examples: Mirai, Emotet botnet\n\n**Fileless Malware**: Operates in memory, no file on disk\n- Harder to detect (no file signature)\n- Uses legitimate tools (PowerShell, WMI)\n- Living-off-the-land techniques\n- Example: Poweliks\n\n**Logic Bomb**: Malicious code triggered by specific condition\n- Activates on date, event, or command\n- Often insider threat vector\n- Example: Employee sets code to activate after termination\n\n## Malware Analysis Basics\n\n**Static Analysis**: Examining malware without execution\n- File properties, strings, imports\n- Disassembly/decompilation\n- Signature and hash analysis\n- Safe but limited information\n\n**Dynamic Analysis**: Executing malware in controlled environment\n- Sandbox or virtual machine\n- Monitor behavior (files, registry, network)\n- See what malware actually does\n- Risk of evasion (VM detection)\n\n**Tools**:\n- VirusTotal (multi-AV scanning)\n- Any.run (interactive sandbox)\n- IDA Pro / Ghidra (disassemblers)\n- PEStudio (PE file analysis)\n- Wireshark (network analysis)\n- Process Monitor (behavior monitoring)"
      },
      "ascii_art": "MALWARE TYPES\n\nVIRUS → Infects files → Spreads when files shared\nWORM → Self-replicates → Spreads automatically\nTROJAN → Disguised → User executes willingly\nRANSOMWARE → Encrypts → Demands payment\nSPYWARE → Monitors → Steals information\nROOTKIT → Hides → Conceals presence",
      "examples": [
        {
          "scenario": "WannaCry Ransomware Outbreak",
          "explanation": "May 2017: WannaCry worm exploited EternalBlue (SMB vuln). Spread to 200,000+ systems in 150 countries. Encrypted files, demanded $300-600 Bitcoin. Affected hospitals (UK NHS), businesses, government. Stopped by researcher registering kill-switch domain. Damage: billions. Lesson: Patch MS17-010, segment networks, maintain backups."
        },
        {
          "scenario": "Emotet Banking Trojan Evolution",
          "explanation": "Started 2014 as banking trojan. Evolved into malware downloader and botnet. Spread via phishing emails with malicious attachments. Downloaded additional malware (TrickBot, Ryuk ransomware). Affected thousands of organizations. Taken down by coordinated law enforcement 2021. Lesson: Email security critical, defense in depth."
        }
      ]
    },
    {
      "block_id": "85c11eca-596b-4b3f-9f9d-1385271489fb",
      "type": "real_world",
      "content": {
        "text": "**NotPetya (2017): Wiper Disguised as Ransomware**:\n\nWhat happened:\n- Appeared to be ransomware (demanded $300)\n- Actually a wiper (destroyed data permanently)\n- Spread via:\n  - EternalBlue exploit\n  - Compromised Ukrainian accounting software update\n  - Mimikatz for credential theft\n- Targeted Ukraine but spread globally\n- Hit Maersk (shipping), FedEx, pharmaceutical companies\n\nDamage:\n- $10 billion+ in total losses\n- Maersk: $300 million, rebuilt 4,000 servers\n- No decryption possible (data permanently destroyed)\n\nLesson: Not all 'ransomware' is ransomware. Nation-state attacks can appear as cybercrime. Offline backups critical.\n\n**Colonial Pipeline Ransomware (2021)**:\n\nAttack:\n- DarkSide ransomware group\n- Initial access via compromised VPN (no MFA)\n- Encrypted corporate systems\n- Pipeline operators shut down pipeline (precaution)\n- 5,500 miles of pipeline offline for 6 days\n- Gas shortages on East Coast\n\nResponse:\n- Paid $4.4 million ransom\n- FBI recovered $2.3 million\n- Led to new cybersecurity regulations for critical infrastructure\n\nLesson: Ransomware affects physical infrastructure. MFA could have prevented. Incident response plan critical."
      },
      "industry_examples": [
        "Stuxnet destroyed 1,000 Iranian centrifuges via worm targeting industrial control systems - first known malware causing physical damage",
        "Zeus banking trojan (2007-2010) stole $100+ million from victims by injecting fake forms into legitimate banking websites",
        "Mirai botnet (2016) infected IoT devices with default passwords, launched massive DDoS taking down Dyn DNS, affecting Twitter, Netflix, PayPal"
      ]
    },
    {
      "block_id": "0371dba2-75d1-4f67-bbf6-ab3212eac1bc",
      "type": "explanation",
      "content": {
        "text": "**Pitfall 1: Relying Only on Antivirus**\nThinking AV catches all malware. Modern malware evades signatures. Solution: Layered defense - AV + EDR + network monitoring + user awareness.\n\n**Pitfall 2: No Offline Backups**\nBackups on network, ransomware encrypts backups too. Solution: 3-2-1 backup rule (3 copies, 2 different media, 1 offsite/offline).\n\n**Pitfall 3: Enabling Macros Without Verification**\nOpening email attachment, enabling macros, malware executes. Solution: Disable macros by default, only enable for trusted sources.\n\n**Pitfall 4: Not Segmenting Networks**\nFlat network allows malware to spread everywhere. Solution: Network segmentation limits worm propagation.\n\n**Pitfall 5: Analyzing Malware on Production Systems**\nRunning suspicious file on work computer. Infects production network. Solution: Isolated sandbox/VM for analysis.\n\n**Pitfall 6: Paying Ransom**\nPaying doesn't guarantee decryption, funds criminals, may be targeted again. Solution: Restore from backups, report to law enforcement.\n\n**Pitfall 7: Ignoring User Training**\nUsers clicking malicious links, downloading trojans. Solution: Regular security awareness training.\n\n**Pitfall 8: Not Patching**\nOld vulnerabilities exploited by worms (WannaCry, NotPetya). Solution: Patch management program, prioritize critical patches."
      }
    },
    {
      "block_id": "f2c4a07d-6f64-4380-bec0-a4e7e5e8e325",
      "type": "explanation",
      "content": {
        "text": "**Immediate Actions**:\n1. Verify your antivirus is updated and running\n2. Check Windows Defender or third-party AV status\n3. Verify you have offline backups (test restore!)\n4. Review recent downloads - recognize anything suspicious?\n5. Disable macros in Office (File → Options → Trust Center → Macro Settings)\n\n**This Week - Build Malware Awareness**:\n1. Set up malware analysis lab (isolated VM)\n2. Visit VirusTotal, analyze suspicious file hashes\n3. Read malware analysis reports (TheD FIRReport, Any.run blog)\n4. Practice identifying phishing emails\n5. Learn to check file hashes and signatures\n\n**This Month - Develop Malware Analysis Skills**:\n1. Complete TryHackMe Malware Analysis rooms\n2. Analyze safe malware samples in sandbox (Any.run, Hybrid Analysis)\n3. Learn basic static analysis (strings, file properties)\n4. Practice dynamic analysis (monitoring execution in VM)\n5. Study recent ransomware campaigns\n6. Build incident response plan for ransomware\n\n**Malware Defense Checklist**:\n- ✅ Antivirus/EDR deployed and updated\n- ✅ Offline backups (3-2-1 rule)\n- ✅ Patch management program\n- ✅ Network segmentation\n- ✅ Email filtering (anti-phishing)\n- ✅ Application whitelisting\n- ✅ Disable unnecessary services and protocols\n- ✅ User security awareness training\n- ✅ Incident response plan\n- ✅ MFA on remote access\n\n**Malware Analysis Tools**:\n- VirusTotal (multi-AV scanning)\n- Any.run (interactive sandbox)\n- Hybrid Analysis (automated sandbox)\n- IDA Pro / Ghidra (reverse engineering)\n- PEStudio (PE file analysis)\n- Process Monitor (Sysinternals)\n- Wireshark (network traffic)\n- YARA rules (malware identification)\n\n**Resources**:\n- MalwareBazaar (malware samples for research)\n- Malware Analysis - Practical Guide (book)\n- ANY.RUN blog (malware analysis reports)\n- TheHackersNews (malware news)\n- TryHackMe Malware Analysis path\n\n**Career Paths**:\n- Malware Analyst: Reverse engineer and analyze malware\n- Threat Intelligence Analyst: Track malware campaigns\n- Incident Responder: Respond to malware infections\n- Detection Engineer: Create malware detection rules\n- Security Researcher: Discover and analyze new malware\n\n**Quick Identification Guide**:\n```\nFiles encrypted, ransom note → Ransomware\nHigh CPU usage, no visible cause → Cryptominer\nStrange network traffic, remote access → RAT\nMultiple systems infected rapidly → Worm\nFake software downloaded → Trojan\nHidden processes, can't find malware → Rootkit\nCredentials stolen from browser → Infostealer\n```\n\n**Incident Response for Malware**:\n1. Isolate infected systems (disconnect network)\n2. Identify malware type and behavior\n3. Contain spread (block C2, isolate segment)\n4. Eradicate malware (remove, rebuild if needed)\n5. Recover from backups\n6. Identify root cause\n7. Improve defenses\n8. Document lessons learned\n\n**Remember**:\n- Malware is constantly evolving - continuous learning required\n- No single solution stops all malware - layered defense\n- Backups are your last line of defense against ransomware\n- User awareness prevents many malware infections\n- Patch vulnerabilities to stop worms\n- Analyze malware safely (isolated environment)\n- Know the enemy to defend effectively\n\nUnderstand malware types and behaviors, and you'll defend better and respond faster when incidents occur."
      }
    },
    {
      "type": "video",
      "title": "Video Tutorial: Malware Types Overview",
      "content": "Watch this comprehensive video tutorial to reinforce your learning with visual demonstrations and practical examples.\n\n**Video**: [Malware Types Explained by John Hammond](https://www.youtube.com/watch?v=n8mbzU0X2nQ)\n\n**What you'll see:**\nComprehensive overview of malware types: viruses, worms, trojans, ransomware, RATs, and more.\n\n**Duration**: ~18 minutes\n\n**Recommended viewing**: After completing the lesson to solidify understanding.\n\n**Additional Resources:**\n- [Malware Bazaar](https://bazaar.abuse.ch/)\n- [ANY.RUN Malware Trends](https://any.run/malware-trends/)\n- [MITRE ATT&CK: Malware](https://attack.mitre.org/software/)"
    }
  ],
  "estimated_time": 30,
  "learning_objectives": [
    "Understand core concepts",
    "Apply knowledge in real-world scenarios",
    "Identify common security issues",
    "Implement best practices"
  ],
  "post_assessment": [
    {
      "question_id": "q1",
      "type": "multiple_choice",
      "question": "What is the main concept covered in this lesson?",
      "options": [
        "Option A",
        "Option B",
        "Option C",
        "Option D"
      ],
      "correct_answer": 0,
      "explanation": "Review the lesson content for details.",
      "difficulty": 2,
      "points": 10
    },
    {
      "question_id": "q2",
      "type": "multiple_choice",
      "question": "Which best practice should you implement?",
      "options": [
        "Best Practice A",
        "Best Practice B",
        "Best Practice C",
        "Best Practice D"
      ],
      "correct_answer": 0,
      "explanation": "Review the lesson content for details.",
      "difficulty": 2,
      "points": 10
    }
  ],
  "jim_kwik_principles": [
    "active_learning",
    "teach_like_im_10",
    "memory_hooks",
    "connect_to_what_i_know"
  ]
}