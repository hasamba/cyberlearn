{
  "lesson_id": "208f11b8-6c46-4bff-bd09-169b2177ef3d",
  "domain": "dfir",
  "title": "DFIR Incident Response Mastery Part 1: Doctrine and Readiness",
  "subtitle": "Build the muscle memory that anchors every major incident",
  "difficulty": 3,
  "estimated_time": 60,
  "order_index": 200,
  "prerequisites": [
    "df000000-0000-0000-0000-000000000002",
    "4de1fefc-2ab2-4859-97b0-993d6f96e6c6"
  ],
  "concepts": [
    "Incident response lifecycle integration",
    "Threat modeling and scenario coverage",
    "Evidence preservation discipline",
    "Command, control, and communications",
    "Continuous readiness operations"
  ],
  "learning_objectives": [
    "Translate organizational risk intelligence into DFIR-ready incident response doctrine and playbook structure.",
    "Operationalize intake, triage, and evidence preservation workflows that scale across ransomware, BEC, malware, and insider threats.",
    "Establish command, control, and communications rituals that align technical, legal, and executive stakeholders during crises.",
    "Measure and iterate readiness through tabletop exercises, automation sprints, and post-incident retrospectives."
  ],
  "post_assessment": [
    {
      "question": "Which pairing best reinforces DFIR readiness during the preparation phase?",
      "options": [
        "Documenting playbooks but skipping evidence handling drills to save time.",
        "Aligning threat models with intake criteria and quarterly collection rehearsals.",
        "Centralizing communications but leaving containment authorities undefined.",
        "Outsourcing detection tuning without linking outputs to investigation workflows."
      ],
      "correct_answer": 1,
      "difficulty": 3,
      "type": "multiple_choice",
      "question_id": "08b3e8f9-d405-4eb6-89d1-791f0f788fb8",
      "explanation": "Readiness improves when threat modeling drives intake criteria and hands-on evidence collection drills confirm the team can execute."
    },
    {
      "question": "During the first briefing of a critical incident, what should the DFIR lead emphasize to establish command and control?",
      "options": [
        "List every suspicious host observed in historical hunts.",
        "Clarify incident objectives, operational cadence, and decision thresholds.",
        "Request legal review before assigning investigation tasks.",
        "Delay containment planning until after full malware reverse engineering."
      ],
      "correct_answer": 1,
      "difficulty": 2,
      "type": "multiple_choice",
      "question_id": "50f4e63a-fe7e-4903-ac63-bb1d123b7aff",
      "explanation": "Early clarity on objectives, cadence, and decision thresholds keeps the response coordinated across stakeholders."
    },
    {
      "question": "Which metric best demonstrates continuous incident response readiness?",
      "options": [
        "Number of alerts closed per week regardless of quality.",
        "Percentage of tabletop improvement actions closed on schedule.",
        "Count of meetings held between security leadership and legal.",
        "Volume of malware samples stored in the lab archive."
      ],
      "correct_answer": 1,
      "difficulty": 2,
      "type": "multiple_choice",
      "question_id": "d4272c8e-b027-45f0-b9a6-b5c62ea6242f",
      "explanation": "Tracking completion of tabletop-driven improvements shows that lessons learned are reinforcing readiness."
    }
  ],
  "jim_kwik_principles": [
    "teach_like_im_10",
    "memory_hooks",
    "connect_to_what_i_know",
    "active_learning",
    "meta_learning",
    "minimum_effective_dose",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint",
    "multiple_memory_pathways"
  ],
  "content_blocks": [
    {
      "block_id": "264c7ba9-ccf1-4d0f-8d5e-85786175d57a",
      "type": "mindset_coach",
      "content": {
        "title": "Anchor DFIR doctrine in lived experience",
        "message": "Great responders pair technical instincts with disciplined preparation. Treat every incident like a rehearsal for the next one—capture assumptions, verify authorities, and challenge your muscle memory before it is tested by an adversary."
      }
    },
    {
      "block_id": "75954f47-f2a2-4d25-bf30-e5207ec89b20",
      "type": "video",
      "content": {
        "title": "Incident Command Fundamentals",
        "url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
        "description": "Walk through the structures and communication rhythms that keep DFIR teams aligned during fast-moving crises. Take notes on how each role contributes to evidence preservation."
      }
    },
    {
      "block_id": "4c6a4878-3942-45a6-8905-e454ddaea66a",
      "type": "explanation",
      "content": {
        "title": "Why doctrine matters when pressure spikes",
        "text": "\nIncident response mastery starts with a relentless focus on fundamentals that can be executed under pressure. In the digital forensics and incident response (DFIR) domain, doctrine is more than a binder on a shelf—it is the set of rhythms, artifacts, and decision frameworks that the team uses when adrenaline spikes and minutes matter. This lesson takes you through the practical foundations of building and sustaining an enterprise-scale incident response capability. You will see how preparation feeds analysis, how cross-functional command structures keep chaos manageable, and how continuous improvement transforms isolated lessons learned into durable muscle memory. Throughout the lesson you will trace each phase of the response lifecycle, unpacking the telemetry, tooling, and human coordination that keep data defensible and stakeholders aligned. By the end you will be ready to lead with calm confidence from the first alert to the final hotwash.\n\nThe guidance here draws on breach investigations across ransomware, business email compromise, supply-chain poisoning, insider theft, cloud misconfiguration, and nation-state intrusion campaigns. It blends policy requirements with the gritty details of time-stamped evidence, volatile memory captures, and executive briefings. Every section reinforces how to reason like an investigator: what to look for, who to call, which logs to lock down, and how to articulate risk in language your organization understands. Expect to diagram command centers, script collection automations, rehearse communication protocols, and translate regulatory obligations into response checklists. Incident response readiness is a craft honed over repetitions, and this lesson is your blueprint for the repetitions that matter most.\n\n\nTo ground doctrine in practice, this lesson dissects the cadence of a full incident day. From the moment a pager vibrates, responders must switch into structured thinking: identify the incident commander, authenticate into secure workspaces, and document assumptions. Every ten-minute interval counts. You will learn how to build an initial incident fact sheet that captures discovery source, affected business units, potential regulatory implications, and current containment status. Templates are provided for briefing executives in language calibrated to their concerns: business continuity, customer trust, and legal exposure. We will also explore how to adapt doctrine for remote-first teams, where responders span time zones and rely on virtual evidence lockers, zero trust access brokers, and asynchronous updates. The lesson includes annotated chat transcripts showing how leaders keep discussions focused on hypotheses, decision requests, and next actions without stifling creative analysis.\n\nDoctrine is also about people. You will meet the core roles—incident commander, lead forensic analyst, threat intel liaison, communications officer, legal partner, and business relationship manager—and understand their responsibilities during each lifecycle phase. Expect stories that illuminate the human factors: the junior analyst whose curiosity surfaced lateral movement the tooling missed, the legal counsel who balanced breach notification triggers with law enforcement coordination, and the infrastructure lead who translated containment steps into safe operational changes. We emphasize psychological safety, fatigue management, and the importance of explicit handoffs when shifts rotate. By adopting these practices you prevent burnout, reduce mistakes, and maintain investigative momentum across multi-day operations.\n\nThe lesson provides a full walkthrough of building a readiness roadmap. Starting with a maturity assessment, you will prioritize investments across governance, people, process, and technology. Learn how to justify funding for forensic lab upgrades by linking them to regulatory obligations and historical dwell time metrics. See examples of quarterly objective and key result (OKR) frameworks tailored for DFIR teams, including lead measures like tabletop completion rates, detection tuning throughput, and backlog burn-down for automation tasks. We also cover how to integrate incident response with enterprise risk management: mapping crown-jewel systems to board-level risk appetite statements, aligning with business continuity planning, and ensuring that cyber insurance conditions are satisfied ahead of time.\n\nTo ensure retention, each section closes with mini-scenarios that require you to apply doctrine decisions: choosing between isolating a domain controller or implementing conditional access policies, deciding when to trigger customer notifications, or evaluating if external counsel must be engaged. These decision points build intuition for ambiguous situations where playbooks do not provide binary answers. You will also practice crafting after-action review narratives that resonate with engineers and executives alike, translating technical root causes into business-aligned remediation programs."
      }
    },
    {
      "block_id": "63aaa363-ac1e-4275-9d0a-6fd9c767263b",
      "type": "explanation",
      "content": {
        "title": "Lifecycle integration in practice",
        "text": "\nPreparation sets the trajectory for every other phase. Build inventories of crown-jewel assets, critical business processes, third-party dependencies, and data sovereignty constraints. Maintain a threat model library that maps likely adversaries, their intrusion playbooks, and the telemetry gaps they exploit. Align detection engineering with those threat models: if human-operated ransomware is a top risk, invest in behavior-based controls that surface anomalous credential use, lateral movement, and mass file encryption attempts. Preparation also means pre-negotiated contracts with digital forensics partners, clear legal authorities for containment actions, and stocked evidence collection kits positioned in every major region where your organization operates.\n\nDetection and analysis begin when an alert, call, or gut feeling signals that something is wrong. Triaging responders must validate the signal, determine scope, and capture volatile evidence before it evaporates. That requires baselined log retention policies, ability to acquire memory from endpoints, and resilient collaboration platforms that withstand crisis load. Analysts correlate telemetry across SIEM, EDR, network sensors, and SaaS audit logs to build hypotheses. They apply the Five C's—Confirm, Contain, Comprehend, Communicate, Continue—to orient themselves and avoid tunnel vision. Deep analysis relies on repeatable workflows: label artifacts, record time zones, preserve original hashes, and document every pivot to maintain evidentiary integrity.\n\nContainment, eradication, and recovery blend technical problem solving with organizational diplomacy. Decide whether to isolate hosts, revoke tokens, disable user accounts, or block network segments based on impact, legal considerations, and business tolerances. Develop containment ladders that pair quick temporary actions with strategic remediation. For ransomware, you may isolate domain controllers, disable Kerberos delegation, and rotate privileged credentials. For BEC, the emphasis shifts to revoking OAuth grants, resetting passwords, and contacting financial partners. Eradication validates that persistence mechanisms, backdoors, and malicious tooling are removed; recovery ensures systems are restored safely using trusted golden images, validated backups, and staged reintroductions to production traffic.\n\nPost-incident activity closes the loop. Conduct a hotwash within 48 hours to capture raw observations, then run a structured after-action review that links root causes to prioritized improvements. Feed findings into backlog items for automation, detection tuning, runbook updates, and tabletop scenarios. Communicate outcomes to executives, regulators, and customers as required. Measure readiness with leading indicators: time to assemble the incident command bridge, percentage of playbooks tested in the last quarter, and velocity of closing improvement actions. Institutionalize knowledge by updating training curricula, maintaining a living incident response wiki, and pairing new responders with mentors during the next major event.\n\n\nPreparation must be iterative. Conduct quarterly purple team exercises where offensive operators and detection engineers collaborate to test containment ladders, validate log sources, and harden playbooks. Maintain a readiness backlog that is visible to leadership, showing which initiatives increase mean time to detect, reduce false positives, or automate containment triggers. Incorporate lessons from industry reports and intelligence feeds by updating threat models and rehearsing new adversary techniques within controlled lab environments. Preparation also extends to legal readiness: pre-draft notification templates, understand cross-border data transfer constraints, and maintain relationships with law enforcement cyber task forces.\n\nDuring detection and analysis, disciplined documentation is non-negotiable. Use a standardized incident timeline template that records event timestamps in UTC, the source system, analyst notes, and evidentiary references. Capture decision logs explaining why hypotheses were accepted or rejected, and maintain a visual workspace (like a Miro or draw.io board) to map adversary movements. Share sanitized updates with executives focusing on business impact rather than technical jargon. Analysts should pair up to cross-review key findings, catching confirmation bias and ensuring chain-of-custody records are complete.\n\nContainment plans should align with business continuity. Build playbooks that map containment actions to potential collateral impact. For example, isolating a payment processing cluster may halt revenue, so have compensating controls ready such as rerouting traffic to hot standby environments. For remote workforces, design containment workflows that leverage zero trust access gateways, device management platforms, and secure orchestration scripts to quarantine devices without physical access. Document fallback options when automated scripts fail, ensuring manual runbooks exist.\n\nRecovery is not merely restoring services; it is verifying that systems rejoin production without residual compromise. Establish validation checklists that include integrity scans, configuration comparisons against golden baselines, and user acceptance testing coordinated with business owners. Schedule staged ramp-ups where limited user groups access restored services while monitoring for anomalies. The post-incident phase should culminate in a strategic retrospective that categorizes findings into quick wins, mid-term projects, and structural reforms. Assign executive sponsors for each major recommendation and track progress through governance forums such as cyber risk councils or board committees."
      }
    },
    {
      "block_id": "e7e045aa-3b11-4481-8db7-73061b5e0f67",
      "type": "explanation",
      "content": {
        "title": "Doctrine application field manual",
        "text": "\n**Doctrine Application Field Manual**\n\n1. **Intake triage**\n   - Establish severity quickly by examining scope indicators: number of affected assets, data sensitivity, regulatory exposure, and operational impact. Use severity matrices aligned to business criticality tiers.\n   - Scrutinize alert fidelity by correlating across telemetry sources. If EDR, firewall, identity provider, and SaaS logs all signal compromise, escalate immediately.\n   - Preserve evidence by triggering automated collection scripts, assigning collection owners, and logging actions in real time.\n   - Communicate initial incident summary using the format *\"Incident [Name], discovered [Date/Time], impact [Systems/Data], containment [Status], next briefing [Time].\"*\n\n2. **Operational period planning**\n   - Break the incident into operational periods (typically 4-6 hours) with explicit objectives, tasks, and resources. Use ICS forms adapted for cyber operations to document plans.\n   - Assign task leads with backups, ensuring coverage across time zones. Clarify decision authority thresholds and escalation paths.\n   - Identify critical assumptions and plan to validate them quickly. For example, if you assume backups are uncompromised, schedule verification tasks immediately.\n   - Establish metrics for the period: number of hosts imaged, percentage of containment actions completed, and stakeholder satisfaction feedback.\n\n3. **Evidence handling discipline**\n   - Implement digital chain-of-custody forms capturing asset identifiers, time of collection, collector name, and hash values. Store forms in immutable repositories and reference them in investigative notes.\n   - Utilize forensic sound tools for disk imaging (FTK Imager, Velociraptor, Magnet AXIOM) and memory acquisition (WinPmem, Lime, AVML) with documented parameters.\n   - Segment evidence storage logically: raw acquisitions, working copies, and derived artifacts. Enforce access controls and audit logging.\n   - Regularly verify evidence integrity through scheduled hash comparisons between stored copies and originals.\n\n4. **Command communications**\n   - Maintain a rolling executive summary updating key stakeholders on incident trajectory. Include sections for \"What we know\", \"What we are doing\", \"What we need\", and \"What decisions are pending\".\n   - Schedule cadence meetings with clear agendas: operational syncs for technical updates, executive briefings for strategic decisions, and legal/compliance huddles for regulatory alignment.\n   - Integrate public relations early to prepare holding statements, Q&A documents, and customer notifications if needed. Provide them with technical context to avoid speculation.\n   - Use decision matrices to evaluate high-impact choices (e.g., paying ransom, shutting down environments). Document criteria, options, risks, and recommended actions.\n\n5. **Continuous improvement loop**\n   - After containment stabilizes, capture lessons in a structured template categorizing root causes, contributing factors, and mitigation plans. Prioritize actions by risk reduction impact and implementation effort.\n   - Update playbooks, threat models, and detection content immediately, even before the final report, to prevent recurrence during the same campaign.\n   - Implement learning sprints that dedicate focused weeks to closing high-priority remediation items. Track sprint outcomes and celebrate wins publicly to reinforce learning culture.\n   - Integrate findings into onboarding programs for new responders, ensuring institutional knowledge persists even as teams change.\n\n6. **Human factors and resilience**\n   - Rotate responders before fatigue degrades judgment. Use buddy systems for critical tasks to catch mistakes and share tacit knowledge.\n   - Provide access to mental health resources, enforce no-blame retrospective norms, and recognize outstanding performance to maintain morale.\n   - Encourage responders to document heuristics developed during the incident—checklists, pivot tables, or quick scripts—and add them to the team knowledge base.\n   - Align with HR and leadership to formalize compensation or time-off recovery for responders who work extended hours during major incidents.\n\n7. **Governance integration**\n   - Brief the board or risk committee with metrics that show readiness trajectory: dwell time trends, tabletop participation rates, and investment impact.\n   - Align DFIR governance with enterprise crisis management, ensuring cross-membership between cyber and business continuity steering groups.\n   - Maintain compliance with frameworks such as ISO 27035, NIST 800-61, and regional regulatory requirements by mapping doctrine controls to specific clauses.\n   - Use scenario-based reporting to regulators, demonstrating that you can articulate incident timeline, containment strategy, and remediation steps transparently.\n\nBy internalizing this field manual, responders can adapt doctrine to emerging threats while maintaining the rigor demanded by legal, regulatory, and executive stakeholders."
      }
    },
    {
      "block_id": "5225c29d-297d-4cde-a004-8ee1080413e0",
      "type": "diagram",
      "content": {
        "title": "Incident command structure",
        "ascii": "\n+----------------------+        +-------------------------+\n| Incident Commander   |<------>| Executive Sponsor       |\n+----------+-----------+        +-----------+-------------+\n           |                                 |\n           v                                 v\n+----------+-----------+        +-----------+-------------+\n| Operations Section   |        | Communications Section  |\n| (Forensics, Contain) |        | (Legal, PR, Customer)   |\n+----------+-----------+        +-----------+-------------+\n           |                                 |\n           v                                 v\n+----------+-----------+        +-----------+-------------+\n| Logistics Section    |        | Intelligence Section    |\n| (Access, Tooling)    |        | (Threat Intel, Hunting) |\n+----------------------+        +-------------------------+\n",
        "explanation": "This ASCII diagram visualizes how command flows during a major incident. The incident commander connects tactical operations with executive direction while logistics and intelligence teams maintain evidence pipelines and situational awareness."
      }
    },
    {
      "block_id": "25c05084-a3ee-4b96-af9b-7195161b1ab3",
      "type": "simulation",
      "content": {
        "title": "45-minute ransomware triage sprint",
        "instructions": "\nYou are on-call for the global DFIR team when the SOC escalates a suspected human-operated ransomware intrusion. The EDR console shows credential dumping and suspicious use of PsExec across finance servers. You have 45 minutes before executive leadership expects a briefing. Step through the simulation to rehearse decision-making under pressure.\n\n1. Confirm the incident by validating that the alerts are not false positives. Pull correlated telemetry from SIEM, collect volatile memory from one compromised server, and capture screenshots of suspicious processes. Document every action in the incident log with timestamps and analyst initials.\n2. Establish incident command. Launch the secure bridge, designate yourself as incident commander for the first operational period, and assign leads for forensics, containment, communications, and legal liaison. Announce cadence: 30-minute operations syncs, hourly executive updates, and persistent chat channel for tactical coordination.\n3. Execute containment ladder. Initiate network segmentation rules to block SMB traffic from compromised hosts, disable compromised accounts through privileged access management tooling, and coordinate with infrastructure teams to snapshot affected virtual machines before powering them down for forensic imaging.\n4. Preserve evidence while containing spread. Ensure that disk images, memory captures, and log exports are written to tamper-evident storage with hash verification. Instruct containment teams to use scripted actions that log automatically to avoid undocumented changes.\n5. Prepare executive briefing. Summarize confirmed facts, hypotheses under investigation, immediate containment actions, business impact, and next decision points (e.g., notifying regulators, engaging ransomware negotiators). Highlight risks and resource needs transparently. Close the simulation by capturing lessons learned and backlog items for automation or documentation updates.\n\n\n6. Revisit threat intelligence inputs. Cross-check ongoing adversary infrastructure with threat intelligence portals, sinkhole data, and industry sharing communities to anticipate additional tooling or targets. Document enrichment findings directly in the incident workspace so future analysts understand adversary motivations.\n7. Design the next operational period. Decide which tasks transition to follow-the-sun responders and which require overnight monitoring. Update the objectives board, note resource constraints, and schedule relief coverage to maintain decision quality.\n8. Capture improvement items while memory is fresh. During the cooldown phase, record automation ideas, documentation gaps, and relationship actions (e.g., onboarding finance partners to phishing simulations). Tag each item with owners and due dates so that they enter the readiness backlog without delay.\n\nAfter completing the simulation, compare your actions against the gold-standard rubric provided in the lesson resources. Identify where you deviated, what assumptions influenced your choices, and how you will adjust playbooks or training. Repeat the simulation quarterly with rotating incident commanders to build collective confidence.",
        "success_criteria": [
          "Incident confirmed with corroborated telemetry and preserved volatile evidence",
          "Command roles assigned with documented cadence and bridge location",
          "Containment actions executed without compromising forensic integrity",
          "Executive briefing outlines facts, impact, and pending decisions"
        ]
      }
    },
    {
      "block_id": "d6e299eb-a55f-47fd-900b-d2d2116c15c2",
      "type": "memory_aid",
      "content": {
        "text": "Use the acronym PIVOT to remember the foundations of DFIR readiness:\n\n- **P**repare playbooks mapped to the top adversary scenarios your organization faces.\n- **I**nstrument telemetry so that critical logs, memory captures, and SaaS audits are preserved automatically.\n- **V**alidate authorities and communication plans through quarterly tabletops and red team exercises.\n- **O**perate with clear command structures that scale from local incidents to global crises.\n- **T**ransform every investigation into improvements by closing the loop with automation and documentation updates.\n\nPIVOT readiness mnemonic"
      }
    },
    {
      "block_id": "8300f485-cec8-4ac7-ab5f-e143f0a72983",
      "type": "real_world",
      "content": {
        "text": "**Scenario:** In 2023, a multinational manufacturer suffered a double-extortion ransomware attack during a holiday weekend. Adversaries gained access through a legacy VPN appliance, escalated to domain admin, deployed ransomware across 1,200 endpoints, and exfiltrated sensitive CAD files.\n\n**Response Breakdown:**\n- **Preparation gaps:** The organization lacked an updated asset inventory for OT environments and had not rehearsed coordinated containment between IT and plant operations. Evidence collection kits were centralized at headquarters, causing a 10-hour delay in acquiring forensic images from impacted plants.\n- **Detection and analysis:** The SOC received EDR alerts for credential dumping but closed them as duplicates because triage queues were overloaded. Once encryption began, on-call responders had to rebuild the incident timeline retroactively by piecing together Windows event logs and firewall telemetry.\n- **Command and communications:** Executive leadership initially directed teams to prioritize restoring production lines, inadvertently wiping volatile evidence. Legal counsel engaged late, complicating regulatory reporting obligations in the EU and APAC regions.\n\n**Lessons Learned:** Establish cross-functional incident command in under 15 minutes, deploy regional evidence kits, and rehearse OT/IT containment joint operations. The company now runs semiannual ransomware war games, maintains a DFIR jump team roster, and has automated EDR alert deduplication with context enrichment to prevent missed detections.\n\nDissect how preparation gaps cascaded into delayed containment and regulatory complications. Note how each lesson learned maps back to the incident response lifecycle and influences future tabletop design.\n\n\n**Extended Analysis:** Investigators discovered that the adversaries rehearsed the intrusion weeks in advance by probing remote desktop gateways and mapping service accounts with unconstrained delegation. The absence of multi-factor authentication on privileged VPN access allowed credential replay. During the crisis, plant operators faced safety concerns because encryptors targeted HMIs controlling assembly line robotics. Without a predefined decision tree, operations attempted improvised fixes that risked physical damage. After the incident, the company instituted a joint cyber-physical response council, established an industrial control system (ICS) forensic lab, and invested in behavioral analytics tuned for OT networks. They also adopted a zero-trust network access (ZTNA) solution, forcing continuous authentication and device posture checks for administrators. Insurance negotiations highlighted the need for precise documentation, prompting the DFIR team to standardize chain-of-custody packets and maintain a single source of truth for recovery milestones.\n\n**Lessons Learned**\n\n- Distribute evidence kits and trained staff across regions to avoid travel delays\n- Institute alert enrichment that prevents triage fatigue from hiding critical signals\n- Mandate an incident command bridge before operational teams touch affected systems"
      }
    },
    {
      "block_id": "abef9b8c-23a3-49d6-b708-0ff312c27b73",
      "type": "code_exercise",
      "content": {
        "text": "Practice building an evidence preservation script that can be run during the first hour of an incident. Using PowerShell, create a module that collects critical artifacts while maintaining chain-of-custody integrity. Execute the commands in a lab environment and store the outputs in a write-once repository for review.\n\n```powershell\n# Collect running processes with signatures and hashes\nGet-Process | Select-Object Name, Id, StartTime | Export-Csv -Path \"C:\\IR\\processes.csv\" -NoTypeInformation\nGet-ChildItem -Path \"C:\\Windows\\System32\" -Filter \"*.exe\" -Recurse -ErrorAction SilentlyContinue |\n  Get-FileHash | Export-Csv -Path \"C:\\IR\\system32_hashes.csv\" -NoTypeInformation\n\n# Capture network connections and listening ports\nGet-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State |\n  Export-Csv -Path \"C:\\IR\\net_connections.csv\" -NoTypeInformation\n\n# Export relevant Windows event logs\n$logs = @('Security','System','Application','Microsoft-Windows-Sysmon/Operational')\nforeach ($log in $logs) {\n  wevtutil epl $log \"C:\\IR\\${log}_$(Get-Date -Format 'yyyyMMddHHmmss').evtx\"\n}\n\n# Record execution metadata\n(Get-Date).ToString('o') | Out-File -FilePath \"C:\\IR\\collection_timestamp.txt\"\nGet-Content \"C:\\IR\\collection_timestamp.txt\" | Get-FileHash | Out-File \"C:\\IR\\collection_hash.txt\"\n```\n\nAfter running the script, create a chain-of-custody entry documenting who executed the collection, the systems involved, file hashes, and transfer methods to secured storage.\n\n**Objective:** Automate the capture of volatile data, logs, and integrity hashes during initial response.\n\n**Validation:** Demonstrate that generated artifacts have matching hashes between the collection host and the secured evidence repository. Document chain-of-custody details in the incident record."
      }
    },
    {
      "block_id": "9a8f15ad-fb03-4581-b54e-8280effb0d5f",
      "type": "quiz",
      "content": {
        "title": "Checkpoint: Command cadence",
        "questions": [
          {
            "question": "When establishing incident command, what is the first communication you should send to the response team?",
            "options": [
              "A comprehensive list of all affected hosts",
              "A concise message naming the incident, initial objectives, and communication channels",
              "Detailed containment procedures for every scenario",
              "A reminder to log billable hours"
            ],
            "correct_answer": 1,
            "explanation": "Leads need clarity on the incident name, immediate objectives, and where coordination happens before diving into details."
          },
          {
            "question": "Which artifact should be prioritized for volatile evidence preservation during ransomware triage?",
            "options": [
              "Daily backup logs",
              "Memory captures from actively compromised systems",
              "Archived firewall logs from last year",
              "Printer spooler files"
            ],
            "correct_answer": 1,
            "explanation": "Memory reveals in-flight credentials, command history, and encryption keys that disappear if hosts reboot."
          }
        ]
      }
    },
    {
      "block_id": "fd27b069-3847-49ab-a29e-24e4dbeb6aee",
      "type": "reflection",
      "content": {
        "title": "Personal readiness review",
        "prompts": [
          "How quickly can you spin up your organization's incident bridge, and who joins automatically?",
          "Which telemetry sources regularly fall out of retention before investigations conclude?",
          "What is your plan for validating evidence integrity when collection is delegated to distributed teams?"
        ]
      }
    }
  ]
}