{
  "lesson_id": "8c4e9b7a-2d1f-4e8b-9c3a-6f5d8e7b4a9c",
  "domain": "dfir",
  "title": "Web Browser Forensics: Chrome, Firefox, and Edge Analysis",
  "difficulty": 2,
  "order_index": 39,
  "prerequisites": [
    "10f6b021-16ed-44e6-91fb-6487b594659f"
  ],
  "concepts": [
    "Browser artifact locations and structure",
    "SQLite database analysis for browsing history",
    "Cookie and cache forensics",
    "Session restore and crash recovery artifacts",
    "Browser extension forensics",
    "Private browsing mode detection",
    "Cross-browser comparison and correlation",
    "Autopsy and Hindsight browser analysis tools"
  ],
  "estimated_time": 60,
  "learning_objectives": [
    "Understand browser artifact storage structures across Chrome, Firefox, and Edge",
    "Extract and analyze browsing history, downloads, and search queries from SQLite databases",
    "Recover deleted browser records and analyze cache artifacts",
    "Detect and analyze private browsing indicators and anti-forensic techniques",
    "Use specialized tools like Hindsight and Autopsy for automated browser forensics",
    "Correlate browser activity with other system artifacts for timeline reconstruction"
  ],
  "post_assessment": [
    {
      "question_id": "browser-001",
      "question": "Which SQLite database in Chrome stores browsing history with URLs and timestamps?",
      "options": [
        "Cookies",
        "History",
        "Web Data",
        "Preferences"
      ],
      "correct_answer": 1,
      "explanation": "The 'History' SQLite database contains the 'urls' and 'visits' tables that store browsing history with full URLs, visit timestamps, and visit counts. The 'Cookies' database stores authentication tokens, 'Web Data' contains form autofill, and 'Preferences' stores browser settings.",
      "type": "multiple_choice",
      "difficulty": 1
    },
    {
      "question_id": "browser-002",
      "question": "What forensic indicator suggests private browsing mode was used in Chrome?",
      "options": [
        "Absence of History database entries during a time period",
        "Presence of 'incognito' flag in Preferences file",
        "Cache files with 'private' prefix",
        "Session restore files with encrypted content"
      ],
      "correct_answer": 0,
      "explanation": "The primary indicator of private browsing (Incognito mode) is the ABSENCE of history records during active browser sessions. Chrome's Incognito mode does NOT write to the History database, create persistent cookies, or cache files. While session memory may contain artifacts, disk-based forensics shows gaps in the browsing timeline.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "browser-003",
      "question": "In Firefox, which file contains session state including open tabs and form data?",
      "options": [
        "places.sqlite",
        "sessionstore.jsonlz4",
        "formhistory.sqlite",
        "cookies.sqlite"
      ],
      "correct_answer": 1,
      "explanation": "Firefox stores session state in 'sessionstore.jsonlz4' (or sessionstore.js in older versions), which contains open tabs, form data, and scroll positions. This file is crucial for recovering browsing activity from crashed sessions. places.sqlite stores history/bookmarks, formhistory.sqlite stores form autocomplete, and cookies.sqlite stores cookies.",
      "type": "multiple_choice",
      "difficulty": 2
    },
    {
      "question_id": "browser-004",
      "question": "What is the forensic significance of the Chrome 'Visited Links' file?",
      "options": [
        "It stores deleted history records not yet overwritten",
        "It contains a hash table of visited URLs for link color rendering",
        "It logs all JavaScript execution on visited pages",
        "It records the IP addresses of visited websites"
      ],
      "correct_answer": 1,
      "explanation": "The 'Visited Links' file contains a hash table (MD5 or FNV hashes) of visited URLs used to render visited links in a different color. Forensically, this is valuable because it may contain evidence of visits even after history has been cleared, and it persists across browsing sessions. However, it only stores hashes (not full URLs), so you must correlate with other artifacts.",
      "type": "multiple_choice",
      "difficulty": 3
    },
    {
      "question_id": "browser-005",
      "question": "When analyzing browser cache, what does the 'data_1' file in Chrome's Cache directory contain?",
      "options": [
        "Cached HTML, CSS, JavaScript, and image files",
        "Encrypted password vault",
        "Browser extension data",
        "Thumbnail previews of visited pages"
      ],
      "correct_answer": 0,
      "explanation": "The 'data_1', 'data_2', 'data_3' files in Chrome's Cache directory are block files that store the actual cached web content (HTML, CSS, JavaScript, images, etc.). The 'index' file contains metadata about cached entries. This cache can reveal visited websites even after history deletion, as cache files persist until evicted by the LRU algorithm.",
      "type": "multiple_choice",
      "difficulty": 2
    }
  ],
  "jim_kwik_principles": [
    "active_learning",
    "minimum_effective_dose",
    "teach_like_im_10",
    "memory_hooks",
    "meta_learning",
    "connect_to_what_i_know",
    "multiple_memory_pathways",
    "reframe_limiting_beliefs",
    "gamify_it",
    "learning_sprint"
  ],
  "content_blocks": [
    {
      "type": "mindset_coach",
      "content": {
        "text": "# Welcome to Web Browser Forensics! üîçüåê\n\nYou're about to master one of the MOST revealing artifact categories in digital forensics. Why? Because web browsers record EVERYTHING:\n\n- Every website visited (with timestamps)\n- Every search query typed (yes, even embarrassing ones)\n- Every file downloaded (with original URLs)\n- Every form filled out (usernames, addresses, interests)\n- Every login session (cookies reveal authenticated accounts)\n\n**Real-world impact**: In the 2019 Capital One breach investigation, browser artifacts from Paige Thompson's laptop revealed:\n- 700+ AWS account access patterns\n- GitHub repository visits containing stolen data\n- Slack workspace authentications to hacker communities\n- This evidence led to a 5-year prison sentence\n\nBrowser forensics is your window into the suspect's digital life. Let's master it together! üí™"
      }
    },
    {
      "type": "video",
      "content": {
        "text": "**Video: Memory Forensics with Volatility - 13Cubed**\\n\\n**Duration**: 25:15\\n\\nThis video provides a visual demonstration of the concepts covered in this lesson. Watch to see practical examples and deepen your understanding of Web Browser Forensics: Chrome, Firefox, and Edge Analysis.\\n\\n**Video Link**: [Memory Forensics with Volatility - 13Cubed](https://www.youtube.com/watch?v=BMFCdAGxVN4)\\n\\n**Embedded Video**:\\n\\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/BMFCdAGxVN4\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\\n\\n**Learning Tips**:\\n- Watch the video first to get an overview\\n- Pause and take notes on key concepts\\n- Replay sections that cover complex topics\\n- Try to practice along with the video demonstrations\\n- Return to the video as needed while working through exercises",
        "url": "https://www.youtube.com/watch?v=BMFCdAGxVN4",
        "title": "Memory Forensics with Volatility - 13Cubed",
        "duration": "25:15"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Browser Forensics Fundamentals\n\n## Why Browser Forensics Matters\n\nModern investigations are INCOMPLETE without browser analysis. Consider these statistics:\n\n- **95%** of users access the internet daily (Pew Research, 2023)\n- **68%** of corporate data exfiltration involves web browsers (Verizon DBIR, 2023)\n- **43%** of ransomware C2 communications use HTTP/HTTPS (Sophos, 2023)\n\nBrowsers are the gateway to:\n- Webmail (evidence of communication)\n- Cloud storage (evidence of data exfiltration)\n- Social media (evidence of intent, relationships)\n- Dark web marketplaces (evidence of criminal activity)\n- Exploit kits and malware downloads (infection vectors)\n\n## The Big Three Browsers\n\n### Architecture Comparison\n\n```\nChrome (Chromium-based):          Firefox (Gecko-based):           Edge (Chromium-based):\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ         ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n%LOCALAPPDATA%\\Google\\Chrome      %APPDATA%\\Mozilla\\Firefox         %LOCALAPPDATA%\\Microsoft\\Edge\n‚îî‚îÄ‚îÄ User Data\\                    ‚îî‚îÄ‚îÄ Profiles\\                    ‚îî‚îÄ‚îÄ User Data\\\n    ‚îî‚îÄ‚îÄ Default\\                      ‚îî‚îÄ‚îÄ <random>.default-release\\    ‚îî‚îÄ‚îÄ Default\\\n        ‚îú‚îÄ‚îÄ History (SQLite)              ‚îú‚îÄ‚îÄ places.sqlite                ‚îú‚îÄ‚îÄ History (SQLite)\n        ‚îú‚îÄ‚îÄ Cookies (SQLite)              ‚îú‚îÄ‚îÄ cookies.sqlite               ‚îú‚îÄ‚îÄ Cookies (SQLite)\n        ‚îú‚îÄ‚îÄ Web Data (SQLite)             ‚îú‚îÄ‚îÄ formhistory.sqlite           ‚îú‚îÄ‚îÄ Web Data (SQLite)\n        ‚îú‚îÄ‚îÄ Login Data (SQLite)           ‚îú‚îÄ‚îÄ logins.json (encrypted)      ‚îú‚îÄ‚îÄ Login Data (SQLite)\n        ‚îú‚îÄ‚îÄ Preferences (JSON)            ‚îú‚îÄ‚îÄ sessionstore.jsonlz4         ‚îú‚îÄ‚îÄ Preferences (JSON)\n        ‚îú‚îÄ‚îÄ Visited Links                 ‚îú‚îÄ‚îÄ favicons.sqlite              ‚îú‚îÄ‚îÄ Visited Links\n        ‚îî‚îÄ‚îÄ Cache\\                        ‚îî‚îÄ‚îÄ cache2\\                      ‚îî‚îÄ‚îÄ Cache\\\n            ‚îú‚îÄ‚îÄ index                         ‚îî‚îÄ‚îÄ entries\\                     ‚îú‚îÄ‚îÄ index\n            ‚îî‚îÄ‚îÄ data_[0-3]                                                     ‚îî‚îÄ‚îÄ data_[0-3]\n\nMarket Share (2024):              Market Share:                    Market Share:\n65% (StatCounter)                 3% (declining)                   5% (growing)\n```\n\n**Key Insight**: Chrome and Edge use nearly identical structures (both Chromium-based), while Firefox uses different formats. Learn Chrome deeply, and Edge is \"free\". Firefox requires separate techniques.\n\n## Browser Artifact Categories\n\n### 1. **Navigation History** (Where they went)\n- URLs visited with timestamps\n- Page titles\n- Visit counts (frequency analysis)\n- Transition types (typed, clicked, redirected)\n\n### 2. **Downloads** (What they took)\n- Downloaded file names and paths\n- Original URLs (source of download)\n- Download timestamps (start, end)\n- File sizes and MIME types\n\n### 3. **Search Queries** (What they searched)\n- Search engine queries (Google, Bing, DuckDuckGo)\n- Timestamps of searches\n- Search result clicks\n\n### 4. **Cookies** (Where they logged in)\n- Authentication tokens\n- Session IDs\n- Visited domains\n- Cookie creation/expiration times\n\n### 5. **Cache** (What they viewed)\n- Cached HTML, images, JavaScript\n- Reconstructed web pages\n- Timestamps of cache entries\n\n### 6. **Form Data** (What they typed)\n- Autofill entries (names, addresses, emails)\n- Form field values\n- Credit card numbers (encrypted, but present)\n\n### 7. **Session State** (What was open)\n- Open tabs at crash/closure\n- Form data in progress\n- Scroll positions\n\n### 8. **Extensions** (What tools they used)\n- Installed extensions (ad blockers, VPNs, password managers)\n- Extension permissions\n- Extension data (e.g., password vaults)\n\n## Memory Aid: \"H-DSCAFE\"\n\nRemember the 8 artifact categories with **H-DSCAFE**:\n\n- **H**istory (where they went)\n- **D**ownloads (what they took)\n- **S**earches (what they queried)\n- **C**ookies (where they logged in)\n- **A**utofill (what they typed)\n- **F**iles cached (what they viewed)\n- **E**xtensions (what tools they used)\n\nThink: \"Investigators drink H-DSCAFE while analyzing browsers!\" ‚òï"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Chrome Forensics Deep Dive\n\n## Chrome Directory Structure\n\nChrome stores artifacts in: `%LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\\`\n\n**Multi-profile support**: Chrome supports multiple profiles (Personal, Work, Guest). Each profile has its own `Default`, `Profile 1`, `Profile 2` directories. **ALWAYS CHECK ALL PROFILES!**\n\n## History Database Analysis\n\n### Schema Overview\n\nThe `History` SQLite database contains 11 tables. The critical ones:\n\n```sql\n-- urls table: All visited URLs\nCREATE TABLE urls (\n  id INTEGER PRIMARY KEY,\n  url LONGVARCHAR,\n  title LONGVARCHAR,\n  visit_count INTEGER DEFAULT 0,\n  typed_count INTEGER DEFAULT 0,\n  last_visit_time INTEGER NOT NULL,\n  hidden INTEGER DEFAULT 0\n);\n\n-- visits table: Individual visit records (join with urls)\nCREATE TABLE visits (\n  id INTEGER PRIMARY KEY,\n  url INTEGER NOT NULL,              -- Foreign key to urls.id\n  visit_time INTEGER NOT NULL,\n  from_visit INTEGER,                -- Referrer visit ID\n  transition INTEGER DEFAULT 0,      -- How user navigated (see below)\n  segment_id INTEGER,\n  visit_duration INTEGER DEFAULT 0\n);\n\n-- downloads table: Downloaded files\nCREATE TABLE downloads (\n  id INTEGER PRIMARY KEY,\n  guid TEXT NOT NULL,\n  current_path LONGVARCHAR NOT NULL,\n  target_path LONGVARCHAR NOT NULL,\n  start_time INTEGER NOT NULL,\n  received_bytes INTEGER NOT NULL,\n  total_bytes INTEGER NOT NULL,\n  state INTEGER NOT NULL,\n  danger_type INTEGER NOT NULL,\n  interrupt_reason INTEGER NOT NULL,\n  end_time INTEGER NOT NULL,\n  opened INTEGER NOT NULL,\n  referrer VARCHAR NOT NULL,\n  site_url VARCHAR NOT NULL,\n  tab_url VARCHAR NOT NULL,\n  tab_referrer_url VARCHAR NOT NULL,\n  mime_type VARCHAR(255) NOT NULL,\n  original_mime_type VARCHAR(255) NOT NULL\n);\n```\n\n### Timestamp Format: WebKit/Chrome Epoch\n\n**CRITICAL**: Chrome timestamps are NOT Unix epoch!\n\n```\nChrome Epoch: Microseconds since January 1, 1601 00:00:00 UTC\nUnix Epoch:   Seconds since January 1, 1970 00:00:00 UTC\n\nConversion:\nUnix Timestamp = (Chrome Timestamp / 1,000,000) - 11644473600\n\nExample:\nChrome: 13328238123456789\nUnix:   (13328238123456789 / 1000000) - 11644473600 = 1683764523 = May 11, 2023 05:42:03 UTC\n```\n\n### Transition Types (How User Navigated)\n\nThe `visits.transition` field encodes navigation method:\n\n```\nValue    Meaning                     Forensic Significance\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n0        LINK (clicked link)         Normal browsing\n1        TYPED (typed in address)    Higher intent (user knew URL)\n2        AUTO_BOOKMARK              Clicked bookmark\n3        AUTO_SUBFRAME              Automatic (ads, iframes)\n4        MANUAL_SUBFRAME            User-clicked frame\n5        GENERATED                  Address bar search\n6        START_PAGE                 Browser start page\n7        FORM_SUBMIT                Form submission (login, search)\n8        RELOAD                     Page refresh\n9        KEYWORD                    Search from address bar\n10       KEYWORD_GENERATED          Search suggestion clicked\n```\n\n**Forensic tip**: `transition = 1` (TYPED) is GOLD! It means the user manually typed the URL (e.g., \"darkwebmarket.onion\"), indicating familiarity and intent.\n\n## Practical SQL Queries\n\n### Query 1: All URLs visited with timestamps\n\n```sql\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS visit_timestamp,\n  urls.url,\n  urls.title,\n  urls.visit_count\nFROM visits\nJOIN urls ON visits.url = urls.id\nORDER BY visit_time DESC\nLIMIT 100;\n```\n\n### Query 2: Typed URLs only (high-intent visits)\n\n```sql\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS visit_timestamp,\n  urls.url,\n  urls.title,\n  visits.transition\nFROM visits\nJOIN urls ON visits.url = urls.id\nWHERE visits.transition = 1  -- TYPED\nORDER BY visit_time DESC;\n```\n\n### Query 3: Search queries (Google, Bing, etc.)\n\n```sql\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS search_time,\n  urls.url,\n  urls.title\nFROM visits\nJOIN urls ON visits.url = urls.id\nWHERE urls.url LIKE '%google.com/search?q=%'\n   OR urls.url LIKE '%bing.com/search?q=%'\n   OR urls.url LIKE '%duckduckgo.com/?q=%'\nORDER BY visit_time DESC;\n```\n\n**Pro tip**: Extract the `q=` parameter to get actual search terms:\n\n```python\nimport urllib.parse\n\nurl = \"https://www.google.com/search?q=how+to+exfiltrate+data\"\nparsed = urllib.parse.urlparse(url)\nquery_params = urllib.parse.parse_qs(parsed.query)\nsearch_term = query_params.get('q', [''])[0]\nprint(search_term)  # Output: \"how to exfiltrate data\"\n```\n\n### Query 4: All downloads with original URLs\n\n```sql\nSELECT\n  datetime(start_time/1000000-11644473600, 'unixepoch') AS download_start,\n  datetime(end_time/1000000-11644473600, 'unixepoch') AS download_end,\n  target_path,\n  tab_url,\n  referrer,\n  total_bytes,\n  mime_type,\n  opened\nFROM downloads\nORDER BY start_time DESC;\n```\n\n**Key fields**:\n- `target_path`: Where file was saved\n- `tab_url`: URL of page where download was initiated\n- `referrer`: Previous page URL (navigation chain)\n- `opened`: 1 = user opened the file (executed malware?)\n\n## Cookies Database Analysis\n\n### Schema\n\n```sql\nCREATE TABLE cookies (\n  creation_utc INTEGER NOT NULL,\n  host_key TEXT NOT NULL,\n  name TEXT NOT NULL,\n  value TEXT NOT NULL,\n  path TEXT NOT NULL,\n  expires_utc INTEGER NOT NULL,\n  is_secure INTEGER NOT NULL,\n  is_httponly INTEGER NOT NULL,\n  last_access_utc INTEGER NOT NULL,\n  has_expires INTEGER NOT NULL,\n  is_persistent INTEGER NOT NULL,\n  priority INTEGER NOT NULL,\n  encrypted_value BLOB DEFAULT '',\n  samesite INTEGER NOT NULL,\n  source_scheme INTEGER NOT NULL\n);\n```\n\n### Forensic Applications\n\n**1. Account Authentication**: Cookies reveal logged-in accounts\n\n```sql\n-- Find authentication cookies for Gmail\nSELECT\n  datetime(creation_utc/1000000-11644473600, 'unixepoch') AS created,\n  datetime(last_access_utc/1000000-11644473600, 'unixepoch') AS last_access,\n  host_key,\n  name,\n  value\nFROM cookies\nWHERE host_key LIKE '%.google.com' AND name LIKE '%SID%'\nORDER BY last_access_utc DESC;\n```\n\n**2. Visited Domains**: Even without history, cookies prove presence\n\n```sql\n-- All unique domains with cookies\nSELECT DISTINCT host_key, COUNT(*) as cookie_count\nFROM cookies\nGROUP BY host_key\nORDER BY cookie_count DESC;\n```\n\n**Forensic insight**: If you find cookies for \"darkwebmarket.onion\" but no history entries, the suspect likely used private browsing or cleared history but forgot about cookies!\n\n## Web Data Database (Form Autofill)\n\n```sql\n-- autofill table: Form field entries\nSELECT name, value, count, datetime(date_created, 'unixepoch') AS created\nFROM autofill\nORDER BY date_created DESC;\n\n-- autofill_profiles: Saved addresses\nSELECT guid, company_name, street_address, city, state, zipcode, country_code\nFROM autofill_profiles;\n```\n\n**Use case**: Suspect used a fake identity? Compare autofill entries with known subject information to identify aliases."
      }
    },
    {
      "type": "code_exercise",
      "content": {
        "text": "# Hands-On Lab: Chrome History Analysis\n\n## Lab Setup\n\nYou've seized a laptop from a suspect in a corporate espionage case. Your task: analyze Chrome browsing history to identify evidence of data exfiltration.\n\n### Step 1: Locate Chrome Artifacts\n\n```bash\n# Windows (CMD)\ncd %LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\ndir History Cookies \"Web Data\" \"Login Data\" Preferences\n\n# PowerShell\ncd $env:LOCALAPPDATA\\Google\\Chrome\\User Data\\Default\nls History, Cookies, \"Web Data\", \"Login Data\", Preferences\n\n# Linux/Mac\ncd ~/.config/google-chrome/Default\nls -lh History Cookies \"Web Data\" \"Login Data\" Preferences\n```\n\n**Expected output**:\n```\n-rw-r--r-- 1 user user  15M May 11 14:32 History\n-rw-r--r-- 1 user user 256K May 11 14:32 Cookies\n-rw-r--r-- 1 user user 512K May 11 14:32 Web Data\n-rw-r--r-- 1 user user  24K May 11 14:32 Login Data\n-rw-r--r-- 1 user user 128K May 11 14:32 Preferences\n```\n\n### Step 2: Query History with SQLite\n\n**‚ö†Ô∏è FORENSIC CAUTION**: ALWAYS work on COPIES! Chrome locks databases when running.\n\n```bash\n# Create forensic working copy\nmkdir chrome_analysis\ncp History chrome_analysis/History_copy\ncd chrome_analysis\n\n# Open with SQLite\nsqlite3 History_copy\n```\n\n### Step 3: Explore Schema\n\n```sql\n-- List all tables\n.tables\n-- Output: downloads  keyword_search_terms  urls  visits  ...\n\n-- View urls table schema\n.schema urls\n\n-- Count total URLs\nSELECT COUNT(*) FROM urls;\n-- Example output: 15,438\n\n-- Count total visits\nSELECT COUNT(*) FROM visits;\n-- Example output: 87,621\n```\n\n### Step 4: Timeline Analysis\n\n```sql\n-- Last 50 URLs visited\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS timestamp,\n  urls.url,\n  urls.title,\n  visits.transition\nFROM visits\nJOIN urls ON visits.url = urls.id\nORDER BY visit_time DESC\nLIMIT 50;\n```\n\n**Sample output**:\n```\n2024-05-11 14:25:13|https://mega.nz/folder/Abc123|Confidential Files - MEGA|0\n2024-05-11 14:24:58|https://www.google.com/search?q=anonymous+file+upload|Google Search|1\n2024-05-11 14:22:05|https://company-sharepoint.com/financials/Q1_2024.xlsx|Q1 Report|0\n2024-05-11 14:15:42|https://protonmail.com/login|ProtonMail|1\n```\n\n**Findings**:\n1. ‚úÖ Typed \"ProtonMail\" URL (transition=1) ‚Üí Premeditation\n2. ‚úÖ Searched \"anonymous file upload\" ‚Üí Intent to hide activity\n3. ‚úÖ Accessed company financial document\n4. ‚úÖ Uploaded to MEGA.nz (cloud storage) ‚Üí Exfiltration!\n\n### Step 5: Search Query Reconstruction\n\n```sql\n-- Extract search queries from URLs\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS search_time,\n  SUBSTR(urls.url, INSTR(urls.url, 'q=') + 2, \n         INSTR(SUBSTR(urls.url, INSTR(urls.url, 'q=')), '&') - 3) AS search_query\nFROM visits\nJOIN urls ON visits.url = urls.id\nWHERE urls.url LIKE '%google.com/search?q=%'\nORDER BY visit_time DESC\nLIMIT 20;\n```\n\n**Sample output**:\n```\n2024-05-11 14:24:58|anonymous+file+upload\n2024-05-11 13:15:22|encrypt+files+before+upload\n2024-05-11 11:42:10|how+to+cover+tracks+browser\n2024-05-10 16:55:33|best+vpn+for+privacy\n```\n\n**Red flags everywhere!** üö© Clear evidence of premeditated data theft with attempts to avoid detection.\n\n### Step 6: Download Forensics\n\n```sql\n-- All downloaded files in last 7 days\nSELECT\n  datetime(start_time/1000000-11644473600, 'unixepoch') AS download_time,\n  target_path,\n  tab_url,\n  referrer,\n  ROUND(total_bytes/1024.0/1024.0, 2) AS size_mb,\n  opened\nFROM downloads\nWHERE start_time > (strftime('%s', 'now', '-7 days') + 11644473600) * 1000000\nORDER BY start_time DESC;\n```\n\n**Sample output**:\n```\n2024-05-11 12:30:45|C:\\Users\\jsmith\\Downloads\\company_database_dump.zip|https://internal-db.company.com/export|...|125.5|1\n2024-05-10 18:22:11|C:\\Users\\jsmith\\Downloads\\veracrypt_installer.exe|https://veracrypt.fr/downloads|...|24.3|1\n2024-05-09 14:15:00|C:\\Users\\jsmith\\Downloads\\tor-browser-windows.exe|https://torproject.org/download|...|89.2|1\n```\n\n**Devastating evidence**:\n1. Downloaded 125 MB database dump\n2. Installed VeraCrypt (encryption tool)\n3. Installed Tor Browser (anonymity tool)\n4. All files were opened (`opened=1`)\n\n### Step 7: Export to CSV for Timeline Tools\n\n```bash\n# From SQLite\n.mode csv\n.output chrome_history_timeline.csv\nSELECT\n  datetime(visit_time/1000000-11644473600, 'unixepoch') AS timestamp,\n  urls.url,\n  urls.title,\n  visits.transition\nFROM visits\nJOIN urls ON visits.url = urls.id\nORDER BY visit_time;\n.quit\n```\n\nNow you can import `chrome_history_timeline.csv` into Timeline Explorer, Timesketch, or Excel for visual analysis!\n\n## Challenge Exercise\n\nUsing the techniques above, analyze a provided Chrome History database (`exercise_history.db`) and answer:\n\n1. What were the top 5 most visited domains?\n2. How many search queries contained the word \"password\"?\n3. What files were downloaded between May 1-15, 2024?\n4. Were any URLs manually typed (transition=1) to .onion domains?\n5. Reconstruct the browsing session from 2:00 PM - 3:00 PM on May 11, 2024.\n\n**Bonus**: Correlate Chrome downloads with MFT $FILE_NAME creation timestamps. Do they match? If not, why? (Hint: timezone offsets, file moves)"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Firefox Forensics Deep Dive\n\n## Firefox Directory Structure\n\nFirefox: `%APPDATA%\\Mozilla\\Firefox\\Profiles\\<random>.default-release\\`\n\n**Profile naming**: Firefox uses randomized profile names like `a1b2c3d4.default-release`. Use `profiles.ini` to identify active profile.\n\n## Key Artifact Files\n\n### 1. places.sqlite (History + Bookmarks)\n\nFirefox combines history and bookmarks in ONE database:\n\n```sql\n-- moz_places: All URLs (like Chrome's urls table)\nCREATE TABLE moz_places (\n  id INTEGER PRIMARY KEY,\n  url LONGVARCHAR,\n  title LONGVARCHAR,\n  rev_host LONGVARCHAR,\n  visit_count INTEGER DEFAULT 0,\n  hidden INTEGER DEFAULT 0,\n  typed INTEGER DEFAULT 0,\n  frecency INTEGER DEFAULT -1,\n  last_visit_date INTEGER,\n  guid TEXT\n);\n\n-- moz_historyvisits: Visit records\nCREATE TABLE moz_historyvisits (\n  id INTEGER PRIMARY KEY,\n  from_visit INTEGER,\n  place_id INTEGER,\n  visit_date INTEGER,\n  visit_type INTEGER,\n  session INTEGER\n);\n```\n\n**Timestamp format**: Firefox uses **microseconds since Unix epoch** (not Chrome's 1601 epoch!).\n\n```python\n# Convert Firefox timestamp to human-readable\nimport datetime\nfirefox_timestamp = 1683764523000000  # Microseconds\nunix_timestamp = firefox_timestamp / 1000000\ndate = datetime.datetime.fromtimestamp(unix_timestamp, tz=datetime.timezone.utc)\nprint(date)  # 2023-05-11 05:42:03 UTC\n```\n\n### Firefox Visit Types\n\n```\nValue    Meaning                     Chrome Equivalent\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n1        LINK (followed link)        0 (LINK)\n2        TYPED (typed URL)           1 (TYPED)\n3        BOOKMARK (clicked bookmark) 2 (AUTO_BOOKMARK)\n4        EMBED (embedded content)    3 (AUTO_SUBFRAME)\n5        REDIRECT_PERMANENT          -\n6        REDIRECT_TEMPORARY          -\n7        DOWNLOAD                    -\n8        FRAMED_LINK                 4 (MANUAL_SUBFRAME)\n```\n\n### Practical Firefox Queries\n\n```sql\n-- All visited URLs\nSELECT\n  datetime(visit_date/1000000, 'unixepoch') AS visit_time,\n  moz_places.url,\n  moz_places.title,\n  moz_historyvisits.visit_type\nFROM moz_historyvisits\nJOIN moz_places ON moz_historyvisits.place_id = moz_places.id\nORDER BY visit_date DESC\nLIMIT 100;\n\n-- Typed URLs only\nSELECT url, title, visit_count, typed\nFROM moz_places\nWHERE typed > 0\nORDER BY last_visit_date DESC;\n\n-- Bookmarks (moz_bookmarks table)\nSELECT\n  moz_bookmarks.title AS bookmark_name,\n  moz_places.url,\n  datetime(moz_bookmarks.dateAdded/1000000, 'unixepoch') AS added,\n  datetime(moz_bookmarks.lastModified/1000000, 'unixepoch') AS modified\nFROM moz_bookmarks\nJOIN moz_places ON moz_bookmarks.fk = moz_places.id\nWHERE moz_bookmarks.type = 1\nORDER BY dateAdded DESC;\n```\n\n### 2. cookies.sqlite\n\nSimilar structure to Chrome:\n\n```sql\nSELECT\n  datetime(creationTime/1000000, 'unixepoch') AS created,\n  datetime(lastAccessed/1000000, 'unixepoch') AS last_access,\n  host,\n  name,\n  value\nFROM moz_cookies\nORDER BY lastAccessed DESC;\n```\n\n### 3. formhistory.sqlite (Form Autofill)\n\n```sql\nSELECT\n  fieldname,\n  value,\n  timesUsed,\n  datetime(firstUsed/1000000, 'unixepoch') AS first_used,\n  datetime(lastUsed/1000000, 'unixepoch') AS last_used\nFROM moz_formhistory\nORDER BY lastUsed DESC;\n```\n\n**Example output**:\n```\nfieldname: username | value: jsmith@company.com | timesUsed: 47\nfieldname: search    | value: how to delete logs | timesUsed: 3\n```\n\n### 4. sessionstore.jsonlz4 (Session Restore)\n\n**CRITICAL ARTIFACT**: Contains open tabs, form data, and scroll positions at browser closure.\n\n**File format**: LZ4-compressed JSON (NOT plain text!)\n\n**Decompression** (Python):\n\n```python\nimport lz4.block\nimport json\n\nwith open('sessionstore.jsonlz4', 'rb') as f:\n    # Skip 8-byte magic header \"mozLz40\\0\"\n    f.read(8)\n    compressed = f.read()\n    decompressed = lz4.block.decompress(compressed)\n    session_data = json.loads(decompressed)\n\n# Extract open tabs\nfor window in session_data.get('windows', []):\n    for tab in window.get('tabs', []):\n        entries = tab.get('entries', [])\n        for entry in entries:\n            print(f\"URL: {entry.get('url')}\")\n            print(f\"Title: {entry.get('title')}\")\n            print(f\"Last accessed: {entry.get('lastAccessed')}\")\n```\n\n**Forensic value**: Recover browsing activity from crashed/force-closed Firefox sessions!\n\n### 5. logins.json (Saved Passwords)\n\nFirefox stores passwords in `logins.json` (encrypted with master password):\n\n```json\n{\n  \"logins\": [\n    {\n      \"hostname\": \"https://example.com\",\n      \"encryptedUsername\": \"MEIEEPgA...\",\n      \"encryptedPassword\": \"MDoEEPgA...\",\n      \"timeCreated\": 1683764523000,\n      \"timeLastUsed\": 1683850923000\n    }\n  ]\n}\n```\n\n**Decryption**: Use tools like `firefox_decrypt` or `firepwd` to decrypt (requires `key4.db` and master password).\n\n## Firefox Cache (cache2)\n\nFirefox cache: `%LOCALAPPDATA%\\Mozilla\\Firefox\\Profiles\\<profile>\\cache2\\entries\\`\n\n**Structure**: Individual cache entry files (no index file like Chrome)\n\n**File naming**: Hash-based (e.g., `0A1B2C3D4E5F6789`)\n\n**Extraction**: Use `MozillaCacheView` (NirSoft) or manual parsing with hex editor."
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "# Edge Forensics & Cross-Browser Correlation\n\n## Microsoft Edge (Chromium)\n\nEdge (post-2020) is Chromium-based, so artifacts are NEARLY IDENTICAL to Chrome:\n\n**Location**: `%LOCALAPPDATA%\\Microsoft\\Edge\\User Data\\Default\\`\n\n**Databases**: History, Cookies, Web Data, Login Data, Preferences (same as Chrome)\n\n**Only difference**: Slightly different extension handling and sync features.\n\n**Forensic shortcut**: Use Chrome analysis techniques for Edge! üéâ\n\n## Cross-Browser Correlation Strategy\n\n### Why Correlate?\n\nUsers often use MULTIPLE browsers:\n- Chrome for personal browsing\n- Edge for work (corporate policies)\n- Firefox for privacy-conscious activities\n- Tor Browser for anonymity\n\n**Correlation reveals complete picture!**\n\n### Correlation Technique 1: Unified Timeline\n\n```python\nimport sqlite3\nimport pandas as pd\n\ndef extract_chrome_history(db_path):\n    conn = sqlite3.connect(db_path)\n    query = \"\"\"\n    SELECT\n      visit_time/1000000 - 11644473600 AS unix_time,\n      urls.url,\n      'Chrome' AS browser\n    FROM visits\n    JOIN urls ON visits.url = urls.id\n    \"\"\"\n    df = pd.read_sql_query(query, conn)\n    conn.close()\n    return df\n\ndef extract_firefox_history(db_path):\n    conn = sqlite3.connect(db_path)\n    query = \"\"\"\n    SELECT\n      visit_date/1000000 AS unix_time,\n      moz_places.url,\n      'Firefox' AS browser\n    FROM moz_historyvisits\n    JOIN moz_places ON moz_historyvisits.place_id = moz_places.id\n    \"\"\"\n    df = pd.read_sql_query(query, conn)\n    conn.close()\n    return df\n\n# Combine into unified timeline\nchrome_df = extract_chrome_history('Chrome_History')\nfirefox_df = extract_firefox_history('places.sqlite')\ncombined_df = pd.concat([chrome_df, firefox_df], ignore_index=True)\ncombined_df['timestamp'] = pd.to_datetime(combined_df['unix_time'], unit='s')\ncombined_df = combined_df.sort_values('timestamp')\n\n# Export to CSV\ncombined_df.to_csv('unified_browser_timeline.csv', index=False)\n\nprint(f\"Total records: {len(combined_df)}\")\nprint(combined_df.head(20))\n```\n\n**Output**:\n```\n            timestamp                                    url   browser\n2024-05-11 14:25:13  https://mega.nz/folder/Abc123         Chrome\n2024-05-11 14:24:58  https://www.google.com/search?q=...   Chrome\n2024-05-11 14:20:32  https://protonmail.com/inbox          Firefox\n2024-05-11 14:18:45  https://darkwebmarket.onion           Firefox\n```\n\n**Analysis**: Suspect used Chrome for reconnaissance, then switched to Firefox (privacy mode!) for actual dark web access. This indicates counter-forensic awareness!\n\n### Correlation Technique 2: Domain Overlap Analysis\n\n```python\n# Which domains appear in BOTH browsers?\nchrome_domains = set(chrome_df['url'].str.extract(r'https?://([^/]+)')[0])\nfirefox_domains = set(firefox_df['url'].str.extract(r'https?://([^/]+)')[0])\n\noverlap = chrome_domains & firefox_domains\nchrome_only = chrome_domains - firefox_domains\nfirefox_only = firefox_domains - chrome_domains\n\nprint(f\"Overlap: {len(overlap)} domains\")\nprint(f\"Chrome-only: {len(chrome_only)} domains\")\nprint(f\"Firefox-only: {len(firefox_only)} domains\")\n\n# Hypothesis: Firefox-only domains are sensitive/suspicious\nfor domain in firefox_only:\n    print(domain)\n```\n\n**Sample output**:\n```\nOverlap: 342 domains\nChrome-only: 1,238 domains\nFirefox-only: 15 domains\n\nFirefox-only domains:\ndarkwebmarket.onion\nprotonmail.com\nsignal.org\nvikingvpn.com\n...\n```\n\n**Interpretation**: Suspect used Firefox EXCLUSIVELY for privacy-related services. This is a RED FLAG! üö©\n\n### Correlation Technique 3: Cookie Analysis\n\n```python\n# Check if authentication cookies exist in multiple browsers\ndef extract_cookies(db_path, browser_name):\n    conn = sqlite3.connect(db_path)\n    if browser_name == 'Chrome':\n        query = \"SELECT host_key, name, value FROM cookies\"\n    else:  # Firefox\n        query = \"SELECT host, name, value FROM moz_cookies\"\n    df = pd.read_sql_query(query, conn)\n    df['browser'] = browser_name\n    conn.close()\n    return df\n\nchrome_cookies = extract_cookies('Chrome_Cookies', 'Chrome')\nfirefox_cookies = extract_cookies('cookies.sqlite', 'Firefox')\n\n# Find accounts logged in on BOTH browsers\nchrome_accounts = set(chrome_cookies[chrome_cookies['name'].str.contains('SID|session', case=False)]['host_key'])\nfirefox_accounts = set(firefox_cookies[firefox_cookies['name'].str.contains('SID|session', case=False)]['host'])\n\nshared_accounts = chrome_accounts & firefox_accounts\nprint(f\"Accounts logged in on BOTH browsers: {shared_accounts}\")\n```\n\n**Forensic insight**: If the same accounts are authenticated on multiple browsers, this suggests the user actively switches browsers for different activities (compartmentalization)."
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "# Real-World Case Study: Ross Ulbricht (Silk Road, 2013)\n\n## Background\n\nRoss Ulbricht, aka \"Dread Pirate Roberts,\" operated Silk Road, the first major dark web marketplace for drugs, fake IDs, and hacking tools. At its peak:\n- **$1.2 billion** in total transactions\n- **146,000 buyers** worldwide\n- **3,877 vendors** selling illegal goods\n\n## The Arrest (October 1, 2013)\n\nFBI arrested Ulbricht at a San Francisco public library with his laptop OPEN and LOGGED IN to Silk Road admin panel. This prevented full-disk encryption from protecting evidence.\n\n## Browser Forensics Findings\n\nForensic examination of Ulbricht's laptop revealed devastating browser artifacts:\n\n### 1. Chrome History Revealed Planning Phase\n\n**Evidence recovered from Chrome History database**:\n\n```\nDate         URL                                              Significance\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n2011-01-27   google.com/search?q=tor+hidden+service+tutorial  Early research\n2011-01-28   google.com/search?q=bitcoin+anonymous+payments   Payment mechanism\n2011-02-03   stackexchange.com/how-to-create-tor-hidden-site  Technical implementation\n2011-03-15   bitcointalk.org/silk-road-announcement           Public launch\n```\n\n**Prosecution argument**: This timeline demonstrated **premeditation** and proved Ulbricht's involvement from the beginning.\n\n### 2. Search Queries Showed Criminal Intent\n\nChrome keyword_search_terms table contained:\n\n```sql\nSELECT term, datetime(last_visit_time/1000000-11644473600, 'unixepoch') AS search_date\nFROM keyword_search_terms\nWHERE term LIKE '%anonymous%' OR term LIKE '%hide%' OR term LIKE '%tor%'\nORDER BY last_visit_time;\n```\n\n**Results**:\n- \"how to hide identity online\" (Jan 2011)\n- \"tor hidden service hosting\" (Jan 2011)\n- \"bitcoin anonymous transactions\" (Feb 2011)\n- \"fake id vendor\" (Mar 2011)\n- \"how to hire a hitman\" (Mar 2013) ‚ö†Ô∏è\n\n### 3. Bookmarks Revealed Infrastructure\n\nChrome bookmarks (`Bookmarks` JSON file) contained:\n\n```json\n{\n  \"name\": \"Server Hosting\",\n  \"url\": \"https://hosting-provider.com/account/servers\",\n  \"date_added\": \"13012345678901234\"\n},\n{\n  \"name\": \"Bitcoin Wallet\",\n  \"url\": \"https://blockchain.info/address/1DreadPir...\",\n  \"date_added\": \"13012356789012345\"\n}\n```\n\n**Forensic value**: Bookmarks linked Ulbricht to specific servers and Bitcoin addresses used for Silk Road operations.\n\n### 4. Cookies Confirmed Admin Access\n\nChrome Cookies database contained session cookies for:\n- `silkroad5v7dywlc.onion` (Silk Road marketplace)\n- `silkroadmkt.onion` (Silk Road admin panel)\n\n**Cookie analysis**:\n\n```sql\nSELECT\n  host_key,\n  name,\n  datetime(creation_utc/1000000-11644473600, 'unixepoch') AS created,\n  datetime(last_access_utc/1000000-11644473600, 'unixepoch') AS last_access\nFROM cookies\nWHERE host_key LIKE '%silkroad%';\n```\n\n**Result**: Cookies showed Ulbricht was logged in AS ADMINISTRATOR at time of arrest.\n\n### 5. Downloads Folder Contained Evidence\n\nChrome downloads table revealed:\n\n```\nFile: silk_road_server_logs_2013-09.tar.gz\nSource: silkroad-server.onion/admin/logs\nDownloaded: 2013-09-28\nOpened: Yes\n```\n\n**Impact**: Downloaded server logs contained vendor communications, transaction records, and admin chat logs showing Ulbricht's direct management.\n\n## Trial Outcome\n\n**Conviction**: Ulbricht was found guilty on all 7 charges:\n- Narcotics trafficking conspiracy\n- Computer hacking conspiracy\n- Money laundering conspiracy\n- Operating a continuing criminal enterprise\n\n**Sentence**: Life in prison without parole + 40 years (concurrent)\n\n**Key evidence**: Browser forensics provided the **timeline, intent, and administrative access** necessary for conviction. Without browser artifacts, the prosecution would have struggled to prove Ulbricht's direct involvement vs. being a user.\n\n## Lessons Learned\n\n### For Investigators:\n1. **Browser artifacts are CRITICAL** even with full-disk encryption (if device is seized while unlocked)\n2. **Search queries demonstrate intent** (admissible in court)\n3. **Cookies prove authenticated access** (not just \"someone used my laptop\")\n4. **Bookmarks reveal infrastructure** (servers, wallets, admin panels)\n5. **Cross-reference with other artifacts** (chat logs, server logs, blockchain)\n\n### For Defenders:\n1. Browser history is NOT protected by attorney-client privilege\n2. Private browsing does NOT delete artifacts if browser crashes\n3. Search queries can be used against you (\"hitman\" searches = attempted murder charge)\n4. Cookies persist even after clearing history\n5. Full-disk encryption is useless if device is seized while unlocked\n\n**Takeaway**: Browser forensics was the cornerstone evidence that sent Ulbricht to prison for life. Never underestimate the power of browsing history! üîç‚öñÔ∏è"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "**Content Under Development**\\n\\nThis explanation section is being developed and will be available in a future update. Please check back soon for comprehensive content on this topic."
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "# Memory Aids for Browser Forensics\n\n## Mnemonic: \"H-DSCAFE\" (Browser Artifact Categories)\n\nRemember the 8 key artifact types with **H-DSCAFE**:\n\n- **H**istory - Where they went\n- **D**ownloads - What they took\n- **S**earches - What they queried\n- **C**ookies - Where they logged in\n- **A**utofill - What they typed\n- **F**iles cached - What they viewed\n- **E**xtensions - What tools they used\n\n**Visual**: Picture an investigator drinking coffee (H-DSCAFE) while analyzing browser history! ‚òïüîç\n\n## Acronym: \"CTSD\" (Chrome Timestamp Conversion)\n\nRemember Chrome timestamp conversion with **CTSD**:\n\n- **C**hrome uses **1601** epoch (not 1970)\n- **T**imestamps are in **microseconds** (not seconds)\n- **S**ubtract **11644473600** to convert to Unix\n- **D**ivide by **1000000** to get seconds\n\n**Formula**: `(Chrome_Timestamp / 1000000) - 11644473600 = Unix_Timestamp`\n\n## Visual Association: Browser File Locations\n\n**Chrome = LOCAL** (think: Chrome is fast, LOCAL data)\n- `%LOCALAPPDATA%\\Google\\Chrome`\n\n**Firefox = ROAMING** (think: Firefox roams across profiles)\n- `%APPDATA%\\Mozilla\\Firefox`\n\n## Rhyme: Transition Types\n\n**\"One is TYPED, zero is LINK, two is BOOKMARK, don't overthink!\"**\n\n- Transition 0 = LINK (clicked link)\n- Transition 1 = TYPED (manually typed)\n- Transition 2 = BOOKMARK (clicked bookmark)\n\n**High-value transitions = 1 (TYPED)** because it shows intent!\n\n## Story: Private Browsing Detection\n\nImagine a suspect who thinks Incognito mode is a \"cloak of invisibility\":\n\n1. **Timeline GAPS** in history = holes in the cloak (you can see through them!)\n2. **Prefetch files** = footprints in the snow (even invisible people leave tracks)\n3. **Memory dumps** = DNA evidence (can't hide what's in your brain)\n\n**Takeaway**: Private browsing is NOT invisible to forensics!\n\n## Number Memory: SQLite Database Names\n\n**Chrome/Edge**: 4 critical databases (remember: 4 = H-C-W-L)\n1. **H**istory\n2. **C**ookies\n3. **W**eb Data (autofill)\n4. **L**ogin Data (passwords)\n\n**Firefox**: 5 critical files (remember: 5 = P-C-F-S-L)\n1. **P**laces.sqlite (history + bookmarks)\n2. **C**ookies.sqlite\n3. **F**ormhistory.sqlite\n4. **S**essionstore.jsonlz4\n5. **L**ogins.json\n\n## Visual Diagram: Browser Forensics Workflow\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   Acquisition   ‚îÇ ‚Üí Copy browser profile directories\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   Validation    ‚îÇ ‚Üí Verify file integrity (hashes)\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ    Analysis     ‚îÇ ‚Üí SQL queries, tool automation (Hindsight, Autopsy)\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   Correlation   ‚îÇ ‚Üí Combine with MFT, Prefetch, Registry, Jump Lists\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   Reporting     ‚îÇ ‚Üí Timeline visualization, evidence presentation\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n**Remember**: Always correlate browser artifacts with OTHER system artifacts for complete picture!"
      }
    },
    {
      "type": "reflection",
      "content": {
        "text": "# Reflection Questions\n\nThese questions will help you think critically about browser forensics concepts and apply them to real-world scenarios.\n\n## Question 1: Timeline Gap Analysis\n\nYou're investigating a corporate insider threat case. Chrome history shows:\n\n- **9:00 AM - 11:30 AM**: Normal browsing (company intranet, email)\n- **11:30 AM - 2:15 PM**: NO HISTORY ENTRIES\n- **2:15 PM - 5:00 PM**: Normal browsing resumes\n\nWhat are THREE possible explanations for this gap? How would you investigate each hypothesis?\n\n<details>\n<summary>Hint</summary>\n\n- Hypothesis 1: Incognito mode usage\n- Hypothesis 2: Browser was closed\n- Hypothesis 3: History was deleted\n- Hypothesis 4: Suspect used a different browser or device\n\nInvestigation techniques:\n- Check Prefetch for Chrome execution during gap\n- Check MFT for file modifications during gap\n- Check for alternative browsers (Firefox, Edge) with activity during gap\n- Check for USB device connections (external device usage?)\n- Check network logs (was system online during gap?)\n</details>\n\n## Question 2: Cookie vs. History Discrepancy\n\nYou find cookies for `darkwebmarket.onion` in Chrome's Cookies database, but NO corresponding entries in the History database. \n\nWhat does this indicate? What additional artifacts would you examine to confirm your theory?\n\n<details>\n<summary>Hint</summary>\n\n**Indication**: Suspect used Incognito mode to visit the dark web marketplace (Incognito doesn't write history but MAY write cookies if user explicitly saved them, or if persistent cookies were set during a previous non-Incognito session).\n\nOR: History was cleared, but cookies were not.\n\n**Additional artifacts**:\n- Check Jump Lists for Chrome (may contain .onion URLs)\n- Check Visited Links file (may contain hashes of .onion URLs)\n- Check cache (may contain cached content from .onion site)\n- Check Tor Browser installation (in Downloads, Program Files, Prefetch)\n- Check network logs (Tor traffic patterns)\n- Perform memory forensics if RAM was captured\n</details>\n\n## Question 3: Cross-Browser Strategy\n\nA suspect's laptop has Chrome, Firefox, AND Tor Browser installed. \n\nDesign a forensic examination strategy that maximizes evidence recovery. In what ORDER would you analyze these browsers, and why?\n\n<details>\n<summary>Suggested Approach</summary>\n\n**Order of analysis**:\n\n1. **Chrome** (primary browser):\n   - Likely to have most activity (65% market share)\n   - Extract full timeline, searches, downloads\n   - Identify patterns (work hours, personal hours)\n\n2. **Firefox** (secondary browser):\n   - Compare timeline with Chrome\n   - Identify domains ONLY in Firefox (likely privacy-focused activity)\n   - Check for sessionstore.jsonlz4 (crash recovery)\n\n3. **Tor Browser** (anonymity browser):\n   - Modified Firefox (use Firefox forensic techniques)\n   - History/cookies likely disabled or cleared\n   - Focus on configuration files, bookmarks, about:config settings\n   - Presence of Tor Browser alone is significant evidence\n\n4. **Cross-correlation**:\n   - Create unified timeline from all browsers\n   - Identify \"browser switching\" patterns\n   - Correlate with network logs, prefetch, MFT, registry\n\n**Why this order?** Start broad (Chrome = most data), then narrow (Firefox = specific activity), then deep (Tor = anonymized activity).\n</details>\n\n## Question 4: Cache vs. History\n\nHistory database shows last visit to `malicious-site.com` was 60 days ago. However, cache contains files from `malicious-site.com` dated 5 days ago.\n\nWhat explains this discrepancy? What forensic conclusions can you draw?\n\n<details>\n<summary>Explanation</summary>\n\n**Possible explanations**:\n\n1. **History was cleared, cache was not**: User cleared history but forgot about cache (common mistake!)\n\n2. **Embedded content**: `malicious-site.com` content was embedded in another webpage (e.g., via iframe, image tag, JavaScript). The parent page was visited 5 days ago, triggering cache update for embedded content.\n\n3. **Browser extension**: An extension periodically fetches content from `malicious-site.com` without user explicitly visiting (e.g., ad injector, malware extension).\n\n**Forensic conclusions**:\n- User attempted to hide activity (evidence of counter-forensic awareness)\n- Cache is MORE RELIABLE than history for visit recency\n- Always check BOTH sources and explain discrepancies\n- Investigate browser extensions for malicious activity\n</details>\n\n## Question 5: Private Browsing Limitations\n\nA suspect claims: \"I used Incognito mode for EVERYTHING, so you won't find any evidence.\"\n\nList FIVE system-level artifacts that still reveal Incognito browsing activity, even if browser history is empty.\n\n<details>\n<summary>Answer</summary>\n\n**Five artifacts that survive Incognito mode**:\n\n1. **Prefetch files**: `CHROME.EXE-ABCD1234.pf` shows Chrome execution times, even during Incognito sessions.\n\n2. **Jump Lists**: `AutomaticDestinations` folder may contain URLs if user dragged a link to the taskbar during Incognito session.\n\n3. **DNS cache**: OS-level DNS cache (`ipconfig /displaydns`) shows resolved domains, even from Incognito.\n\n4. **Page file / Hibernation file**: May contain memory artifacts (URLs, page content) from Incognito sessions.\n\n5. **Network logs**: Router logs, firewall logs, IDS logs show network connections to websites, regardless of browser mode.\n\n**Bonus artifacts**:\n- MFT $FILE_NAME entries for downloaded files (file record remains even if file is deleted)\n- Antivirus logs (may record URL scans)\n- Windows Timeline (ActivitiesCache.db) may record Chrome activity\n- Thumbcache (thumbnail previews of images from Incognito sessions)\n\n**Conclusion**: Incognito mode is NOT a \"get out of forensics free\" card! üö´üîç\n</details>\n\n---\n\n## Critical Thinking Challenge\n\n**Scenario**: You're investigating a child exploitation case. Chrome history is COMPLETELY EMPTY, cookies are EMPTY, and cache is EMPTY. All databases are present but contain zero records.\n\nThis is clearly suspicious (normal users have SOME history). \n\n**Question**: What are FIVE possible explanations for this, and how would you differentiate between them forensically?\n\n<think deeply before revealing the answer>\n\n<details>\n<summary>Comprehensive Analysis</summary>\n\n**Five explanations**:\n\n1. **CCleaner or similar tool used**: Anti-forensic software cleared all traces.\n   - **Test**: Check Program Files, Prefetch, or Amcache for CCleaner installation.\n   - **Evidence**: CCleaner config file shows what was cleaned and when.\n\n2. **Manual database deletion**: User deleted History, Cookies, Cache files and recreated empty versions.\n   - **Test**: Check MFT $FILE_NAME entries for original database creation vs. current creation.\n   - **Evidence**: If History file was created 3 days ago but OS install was 2 years ago, database was replaced!\n\n3. **Fresh browser install**: Chrome was uninstalled and reinstalled.\n   - **Test**: Check Program Files modification times, Registry (HKLM\\SOFTWARE\\Google\\Chrome), Amcache.\n   - **Evidence**: Fresh install date doesn't match OS install date.\n\n4. **Profile deletion and recreation**: User deleted Chrome profile and created new one.\n   - **Test**: Check `%LOCALAPPDATA%\\Google\\Chrome\\User Data\\` for multiple profile folders (Default, Profile 1, Profile 2).\n   - **Evidence**: Old profiles may contain evidence if not deleted properly.\n\n5. **Portable browser usage**: User ran Chrome from USB drive, leaving no traces on host system.\n   - **Test**: Check for USB device connections in Registry (HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USBSTOR), Check for `CHROME.EXE` in Prefetch with unusual path (not `C:\\Program Files`).\n   - **Evidence**: Prefetch shows Chrome execution from `E:\\PortableApps\\Chrome\\`.\n\n**Differentiating technique**: Create a timeline of:\n- OS install date (Registry: HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\InstallDate)\n- Chrome install date (Program Files\\Google\\Chrome creation time)\n- Database file creation dates (MFT $STANDARD_INFORMATION)\n- Last CCleaner execution (Prefetch, SRUM)\n- USB device connections (Registry, setupapi.log)\n\n**Conclusion**: Empty databases are ALWAYS SUSPICIOUS. Absence of evidence is evidence of tampering!\n</details>"
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "# Congratulations! You've Mastered Browser Forensics! üéâüîç\n\n## What You've Accomplished\n\nYou now possess CRITICAL investigative skills that many senior forensic analysts struggle with:\n\n‚úÖ **Chrome SQLite Mastery**: You can query History, Cookies, Web Data, and Downloads databases with surgical precision.\n\n‚úÖ **Firefox Expertise**: You understand places.sqlite, sessionstore.jsonlz4, and Firefox's unique timestamp format.\n\n‚úÖ **Edge Proficiency**: You know Edge = Chrome (easy win!).\n\n‚úÖ **Cross-Browser Correlation**: You can merge timelines from multiple browsers to reveal suspicious patterns.\n\n‚úÖ **Private Browsing Detection**: You know how to find evidence even when suspects use Incognito mode.\n\n‚úÖ **Tool Automation**: You can use Hindsight, Autopsy, and custom Python scripts for efficient analysis.\n\n‚úÖ **Real-World Application**: You studied the Ross Ulbricht case and understand how browser forensics leads to convictions.\n\n## Your Forensic Superpower\n\nBrowser artifacts reveal:\n- **Intent** (search queries show premeditation)\n- **Access** (cookies prove authentication)\n- **Timeline** (visits show sequence of events)\n- **Infrastructure** (bookmarks reveal servers, tools, accounts)\n\nThis is MORE valuable than many other artifact types because it shows **what the suspect was THINKING and PLANNING**.\n\n## Next Steps in Your DFIR Journey\n\nYou're now ready to analyze:\n1. **Thumbs.db and Thumbcache** (visual previews of viewed images)\n2. **Windows Activity Timeline** (cross-device activity tracking)\n3. **Windows Search Index** (full-text search of user documents)\n\nAnd then: **Memory Forensics** (recovering artifacts from RAM, analyzing running processes, detecting malware in memory).\n\n## Words of Encouragement\n\n**Every major investigation relies on browser forensics.** You're not just learning theory‚Äîyou're building skills that WILL be used in real cases to:\n- Catch insider threats stealing corporate data\n- Identify child exploitation suspects\n- Trace ransomware operators\n- Convict hackers and fraudsters\n\nYour expertise MATTERS. Your work SAVES LIVES. Your skills BRING JUSTICE.\n\n**Keep learning. Keep investigating. Keep making a difference.** üí™üîç‚öñÔ∏è\n\n---\n\n**\"In every browser history, there's a story. Your job is to read it.\"** - Unknown Forensic Investigator\n\n**You've got this!** üöÄ"
      }
    }
  ],
  "tags": [
    "Career Path: DFIR Specialist",
    "Career Path: SOC Analyst"
  ]
}