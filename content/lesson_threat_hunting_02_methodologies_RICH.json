{
  "lesson_id": "th-002-methodologies",
  "domain": "threat_hunting",
  "title": "Threat Hunting Methodologies",
  "difficulty": 2,
  "order_index": 2,
  "prerequisites": ["th-001-fundamentals"],
  "concepts": [
    "Crown Jewels Analysis",
    "TTP-based hunting",
    "Indicator-based vs behavior-based hunting",
    "Hunt loop methodology",
    "Structured vs unstructured hunting",
    "Hunt playbook development"
  ],
  "estimated_time": 50,
  "learning_objectives": [
    "Master Crown Jewels Analysis for prioritizing hunt targets",
    "Understand TTP-based hunting methodology",
    "Differentiate indicator-based from behavior-based hunting",
    "Apply the hunt loop framework to investigations",
    "Create structured hunt playbooks",
    "Execute both structured and unstructured hunts effectively"
  ],
  "post_assessment": [
    {
      "question": "What is Crown Jewels Analysis?",
      "options": [
        "Identifying the most valuable assets in your organization",
        "Finding stolen data",
        "Analyzing malware samples",
        "Reviewing firewall logs"
      ],
      "correct_answer": 0,
      "difficulty": 1,
      "type": "multiple_choice"
    },
    {
      "question": "What is the key difference between indicator-based and behavior-based hunting?",
      "options": [
        "Indicator-based hunts for known IOCs, behavior-based hunts for suspicious patterns",
        "They are the same thing",
        "Behavior-based is faster",
        "Indicator-based doesn't use logs"
      ],
      "correct_answer": 0,
      "difficulty": 2,
      "type": "multiple_choice"
    },
    {
      "question": "In a structured hunt, what guides your investigation?",
      "options": [
        "Random log searches",
        "A predefined playbook with specific steps",
        "Gut instinct only",
        "Automated alerts"
      ],
      "correct_answer": 1,
      "difficulty": 2,
      "type": "multiple_choice"
    }
  ],
  "jim_kwik_principles": [
    "active_recall",
    "spaced_learning",
    "memory_hooks"
  ],
  "content_blocks": [
    {
      "type": "explanation",
      "content": {
        "text": "# Threat Hunting Methodologies\n\nIn the previous lesson, you learned the **fundamentals** of threat hunting. Now, we'll dive into **specific methodologies** you can apply to find adversaries in your environment.\n\nThink of methodologies as your **hunting playbook** - proven approaches that guide your investigations and increase your chances of success.\n\n## Crown Jewels Analysis: Know What to Protect\n\n### What Are Your Crown Jewels?\n\n**Crown Jewels** are your organization's most valuable assets - the data, systems, or resources that, if compromised, would cause the most damage.\n\nExamples:\n- **Financial Services**: Customer financial data, trading algorithms\n- **Healthcare**: Patient health records (PHI/PII)\n- **Manufacturing**: Intellectual property, CAD designs\n- **Tech Companies**: Source code, customer databases\n- **Government**: Classified information, citizen data\n\n### Why Crown Jewels Matter for Hunting\n\n**Attackers target your crown jewels**. They don't care about your guest WiFi - they want:\n- Data they can sell\n- Systems they can ransom\n- Credentials for high-value access\n- Intellectual property to steal\n\n**Threat hunters prioritize hunt efforts around crown jewels**.\n\n### Conducting Crown Jewels Analysis\n\n**Step 1: Identify Assets**\n\nList your organization's most critical:\n- **Data**: Customer data, financial records, IP\n- **Systems**: Domain controllers, databases, payment systems\n- **People**: Executives, admins, developers\n- **Services**: Email, VPN, cloud infrastructure\n\n**Step 2: Assess Impact**\n\nFor each asset, ask:\n- What happens if this is compromised?\n- How much would it cost (financially, reputationally)?\n- Would we survive a breach of this asset?\n\n**Impact Rating**:\n- **Critical**: Organization-ending threat (e.g., ransomware on production DB)\n- **High**: Severe damage, regulatory fines (e.g., PII breach)\n- **Medium**: Business disruption (e.g., email outage)\n- **Low**: Minimal impact (e.g., guest WiFi compromise)\n\n**Step 3: Map Attack Paths**\n\nHow would an attacker reach your crown jewels?\n\n```\n[Initial Access] ‚Üí [Lateral Movement] ‚Üí [Crown Jewel]\n\nExample:\n[Phished User] ‚Üí [Pivot to File Server] ‚Üí [Steal IP]\n[Compromised VPN] ‚Üí [Privilege Escalation] ‚Üí [Domain Admin] ‚Üí [Entire Network]\n```\n\n**Step 4: Prioritize Hunts**\n\nFocus hunt efforts on:\n1. **Direct Crown Jewel Access**: Monitor crown jewels themselves\n2. **Attack Paths**: Watch systems on the path to crown jewels\n3. **High-Value Targets**: Users with privileged access\n\n### Real-World Example: Crown Jewels Hunt\n\n**Scenario**: Healthcare organization\n\n**Crown Jewel**: Electronic Health Records (EHR) database\n\n**Hunt Hypothesis**: \"If an attacker is targeting our EHR database, they would need to:\n1. Compromise a user with database access\n2. Establish persistence on a jump box\n3. Exfiltrate data via SQL queries\"\n\n**Hunt Actions**:\n- Monitor database admin account usage\n- Hunt for persistence mechanisms on database servers\n- Search for large SQL query outputs\n- Look for unusual data exfiltration patterns\n\n**Result**: Proactively defending what matters most."
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## TTP-Based Hunting\n\n### Understanding TTPs\n\nRemember **TAP** from the previous lesson:\n- **Tactics**: Adversary goals (what they want)\n- **Techniques**: Methods to achieve goals (how they do it)\n- **Procedures**: Specific implementations (actual tools/commands)\n\n**TTP-based hunting** means hunting for adversary behaviors rather than specific indicators.\n\n### Why Hunt by TTPs?\n\n**Indicators change constantly**:\n- Adversaries change IP addresses, domains, file hashes\n- Signature-based detection is a losing game\n\n**TTPs are more consistent**:\n- Adversaries need persistence (tactic)\n- They use scheduled tasks, registry keys, startup items (techniques)\n- These behaviors are harder to change\n\n### TTP Hunt Example 1: Credential Dumping\n\n**Tactic**: Credential Access (TA0006)\n**Technique**: OS Credential Dumping (T1003)\n**Sub-Techniques**:\n- T1003.001 - LSASS Memory (Mimikatz)\n- T1003.002 - Security Account Manager (SAM)\n- T1003.003 - NTDS.dit (Active Directory database)\n\n**Hunt Hypothesis**: \"If an attacker is dumping credentials, they would access LSASS memory or SAM registry keys.\"\n\n**Hunt Query (Sysmon)**:\n```\nindex=windows EventCode=10 TargetImage=\"*lsass.exe\"\n| where SourceImage NOT IN (\"C:\\\\Windows\\\\System32\\\\wbem\\\\wmiprvse.exe\", known_good_processes)\n| stats count by SourceImage, SourceUser\n```\n\n**What This Finds**:\n- Processes accessing LSASS (potential Mimikatz)\n- Excludes known-good Windows processes\n- Groups by source process and user\n\n### TTP Hunt Example 2: Lateral Movement via RDP\n\n**Tactic**: Lateral Movement (TA0008)\n**Technique**: Remote Services - Remote Desktop Protocol (T1021.001)\n\n**Hunt Hypothesis**: \"If an attacker is moving laterally, they would use RDP from unexpected systems.\"\n\n**Hunt Query (Windows Event Logs)**:\n```\nindex=windows EventCode=4624 LogonType=10\n| eval is_server=if(match(ComputerName, \"SERVER|DC\"), \"yes\", \"no\")\n| where is_server=\"no\"\n| stats count by SourceNetworkAddress, TargetUserName, ComputerName\n| where count > 5\n```\n\n**What This Finds**:\n- RDP logins (LogonType=10)\n- To non-server systems (workstation-to-workstation RDP is suspicious)\n- Multiple attempts from same source\n\n### TTP Hunt Example 3: PowerShell Execution\n\n**Tactic**: Execution (TA0002)\n**Technique**: Command and Scripting Interpreter - PowerShell (T1059.001)\n\n**Hunt Hypothesis**: \"If an attacker is using PowerShell for execution, they would run encoded or obfuscated commands.\"\n\n**Hunt Query (PowerShell Logs)**:\n```\nindex=windows EventCode=4104\n| where ScriptBlockText contains \"IEX\" OR ScriptBlockText contains \"-EncodedCommand\" OR ScriptBlockText contains \"DownloadString\"\n| stats count by Computer, UserName, ScriptBlockText\n```\n\n**What This Finds**:\n- Invoke-Expression (IEX) - commonly used to run downloaded scripts\n- Encoded commands (obfuscation)\n- DownloadString (downloading and executing remote scripts)\n\n### Building a TTP Hunt Library\n\nCreate a hunt for each common TTP:\n\n**Persistence** (TA0003):\n- T1053 - Scheduled Tasks\n- T1547 - Boot/Logon Autostart\n- T1546 - Event Triggered Execution\n\n**Defense Evasion** (TA0005):\n- T1070 - Indicator Removal\n- T1027 - Obfuscated Files or Information\n- T1562 - Impair Defenses (disable AV)\n\n**Collection** (TA0009):\n- T1560 - Archive Collected Data\n- T1113 - Screen Capture\n- T1005 - Data from Local System\n\n**Memory Aid**: **PTD-CED** for common hunt tactics:\n- **P**ersistence\n- **T**otal (Credential Access)\n- **D**efense Evasion\n- **C**ollection\n- **E**xfiltration\n- **D**iscovery"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## Indicator-Based vs Behavior-Based Hunting\n\n### Indicator-Based Hunting\n\n**Definition**: Hunting for known **Indicators of Compromise (IOCs)**.\n\n**IOCs Include**:\n- IP addresses\n- Domain names\n- File hashes (MD5, SHA256)\n- Email addresses\n- URLs\n- Registry keys\n- Filenames\n\n**Example Hunt**: \"Search for all connections to known Cobalt Strike C2 IPs from threat intel feed.\"\n\n**Strengths**:\n- ‚úÖ Fast to execute (simple log queries)\n- ‚úÖ High confidence (known-bad indicators)\n- ‚úÖ Easy to automate\n\n**Weaknesses**:\n- ‚ùå Only finds known threats\n- ‚ùå Adversaries change IOCs frequently\n- ‚ùå Doesn't detect novel attacks\n\n**When to Use**:\n- New threat intelligence arrives\n- Known APT group targeting your industry\n- Post-incident sweep for related IOCs\n\n### Behavior-Based Hunting\n\n**Definition**: Hunting for **suspicious patterns** and **anomalies** rather than specific indicators.\n\n**Behaviors to Hunt**:\n- Unusual process execution patterns\n- Anomalous network traffic\n- Privilege escalation attempts\n- Lateral movement indicators\n- Data staging and exfiltration patterns\n\n**Example Hunt**: \"Search for processes creating scheduled tasks on multiple systems (potential worm behavior).\"\n\n**Strengths**:\n- ‚úÖ Finds unknown threats (zero-days, custom malware)\n- ‚úÖ More resilient to adversary changes\n- ‚úÖ Detects advanced persistent threats (APTs)\n\n**Weaknesses**:\n- ‚ùå Slower to execute (complex queries)\n- ‚ùå Higher false positive rate\n- ‚ùå Requires deeper analysis skills\n\n**When to Use**:\n- Hunting for advanced adversaries\n- Post-breach investigation\n- Proactive threat discovery\n\n### Combining Both Approaches\n\n**Best Practice**: Use both methodologies together.\n\n**Layered Hunting Strategy**:\n\n**Layer 1 - Indicator Sweep** (Fast, Automated):\n- Run daily IOC searches from threat intel\n- Automate with SOAR/SIEM\n- Low effort, catches known threats\n\n**Layer 2 - Behavior Analysis** (Weekly, Manual):\n- Hunt for suspicious patterns\n- Hypothesis-driven investigations\n- High effort, finds advanced threats\n\n**Layer 3 - Anomaly Detection** (Continuous, ML):\n- Statistical outliers\n- Machine learning models\n- Baseline normal behavior\n\n### Real-World Hybrid Hunt: Ransomware\n\n**Indicator-Based Component**:\n- Search for known ransomware hashes (Conti, REvil, LockBit)\n- Hunt for known ransomware C2 domains\n- Look for file extensions associated with ransomware (e.g., .lockbit)\n\n**Behavior-Based Component**:\n- Hunt for mass file encryption patterns (rapid file modifications)\n- Search for backup service deletions (`wbadmin delete catalog`)\n- Look for shadow copy deletion (`vssadmin delete shadows`)\n- Find unusual PowerShell/cmd.exe activity\n- Detect lateral movement via SMB/RDP\n\n**Combined Result**: Detect both known ransomware variants AND novel custom ransomware."
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## The Hunt Loop: A Systematic Framework\n\nThe **Hunt Loop** is a repeatable process for conducting threat hunts. It ensures consistency and continuous improvement.\n\n### Hunt Loop Phases\n\n```\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ  1. HYPOTHESIS GENERATION     ‚îÇ\n     ‚îÇ  \"Adversaries use WMI for...\" ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ  2. DATA COLLECTION           ‚îÇ\n     ‚îÇ  Sysmon, NetFlow, EDR logs    ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ  3. ANALYSIS & INVESTIGATION  ‚îÇ\n     ‚îÇ  Query, visualize, correlate  ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ  4. DETECTION ENGINEERING     ‚îÇ\n     ‚îÇ  Create automated rules       ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ  5. DOCUMENTATION & LESSONS   ‚îÇ\n     ‚îÇ  Update playbooks, share      ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n                [REPEAT]\n```\n\n### Phase 1: Hypothesis Generation\n\n**Sources of Hypotheses**:\n\n1. **Threat Intelligence**\n   - \"APT29 uses SUNBURST backdoor via SolarWinds\"\n   - Hunt hypothesis: \"If SUNBURST is present, we'd see unusual Orion process behavior\"\n\n2. **Environmental Knowledge**\n   - \"Our finance department uses Excel heavily\"\n   - Hunt hypothesis: \"If attackers target finance, they'd use malicious macros\"\n\n3. **Past Incidents**\n   - \"We were hit by phishing last quarter\"\n   - Hunt hypothesis: \"Attackers may still have persistence from that breach\"\n\n4. **Adversary Behaviors**\n   - \"Ransomware operators disable backups\"\n   - Hunt hypothesis: \"If ransomware is preparing, we'd see backup service tampering\"\n\n**Good Hypothesis Characteristics** (SMART):\n- **Specific**: Not \"find bad stuff\" but \"find WMI lateral movement\"\n- **Measurable**: Can be tested with data\n- **Actionable**: You can query for it\n- **Relevant**: Matters to your organization\n- **Time-bound**: Scoped to a specific timeframe\n\n### Phase 2: Data Collection\n\n**Identify Required Data Sources**:\n\nFor WMI lateral movement hunt:\n- ‚úÖ Sysmon Event ID 19, 20, 21 (WMI events)\n- ‚úÖ Windows Event ID 4648 (Explicit credential use)\n- ‚úÖ Network traffic logs (connections to port 135/RPC)\n- ‚úÖ EDR process creation logs\n\n**Data Collection Tips**:\n- Ensure logs are available (check retention)\n- Verify log quality (are fields populated?)\n- Collect from representative sample (not just one server)\n- Consider time range (past 30 days? 90 days?)\n\n### Phase 3: Analysis & Investigation\n\n**Analysis Workflow**:\n\n1. **Initial Query**: Run your search\n2. **Filter Noise**: Remove known-good results\n3. **Visualize**: Timeline, graphs, network maps\n4. **Correlate**: Connect related events\n5. **Pivot**: Expand scope if something looks suspicious\n6. **Validate**: True positive or false positive?\n\n**Example Analysis Session**:\n\n```\n# Initial query: WMI event subscriptions\nindex=sysmon EventCode=19\n| stats count by CommandLineEventConsumer\n\n# Found suspicious entry: PowerShell one-liner\n# Pivot: Who created it?\nindex=sysmon EventCode=19 CommandLineEventConsumer=\"*powershell*\"\n| table _time, Computer, User, CommandLineEventConsumer\n\n# Found: Created by \"admin_svc\" account\n# Expand: What else has this account done?\nindex=windows User=\"admin_svc\"\n| stats count by EventCode, ComputerName\n\n# Result: Lateral movement detected across 12 systems\n```\n\n### Phase 4: Detection Engineering\n\nConvert hunt findings into **automated detection rules**.\n\n**If you found a threat manually, automate detection so you never miss it again.**\n\n**Example**: WMI Persistence Detection Rule\n\n```yaml\ntitle: Suspicious WMI Event Consumer\nstatus: stable\ndescription: Detects WMI event consumers with PowerShell execution\nreferences:\n  - https://attack.mitre.org/techniques/T1546/003/\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: 20\n    Destination:\n      - '*powershell*'\n      - '*cmd.exe*'\n  condition: selection\nfalsepositives:\n  - Legitimate admin scripts\nlevel: high\n```\n\n### Phase 5: Documentation\n\n**Document Everything**:\n\n1. **Hunt Report**:\n   - Hypothesis tested\n   - Data sources used\n   - Findings (threats or benign)\n   - Detections created\n   - Lessons learned\n\n2. **Playbook Update**:\n   - Add queries to hunt playbook\n   - Document false positives to exclude\n   - Note time required\n\n3. **Knowledge Sharing**:\n   - Brief SOC team on new detections\n   - Share with security community (anonymized)\n   - Update threat model\n\n### Iterating the Loop\n\n**Each hunt generates new hypotheses**:\n\n- Found WMI lateral movement? ‚Üí Hunt for other lateral movement techniques (RDP, PSExec)\n- Found persistence? ‚Üí Hunt for privilege escalation\n- Found data staging? ‚Üí Hunt for exfiltration\n\n**The hunt loop never ends - it's continuous improvement.**"
      }
    },
    {
      "type": "explanation",
      "content": {
        "text": "## Structured vs Unstructured Hunting\n\n### Structured Hunting\n\n**Definition**: Following a predefined **playbook** with specific steps, queries, and expected outcomes.\n\n**Characteristics**:\n- Step-by-step procedures\n- Pre-written queries\n- Known data sources\n- Predictable time investment\n- Repeatable and teachable\n\n**Example: Ransomware Hunt Playbook**\n\n```\n===================================\nRANSOMWARE THREAT HUNT PLAYBOOK\n===================================\n\nOBJECTIVE: Detect ransomware preparation and execution\nTIME REQUIRED: 60-90 minutes\nFREQUENCY: Weekly\n\nSTEP 1: Check for backup service tampering\nQuery: index=windows (\"vssadmin delete shadows\" OR \"wbadmin delete catalog\")\nExpected: 0 results\nIf found: Escalate to IR immediately\n\nSTEP 2: Hunt for mass file encryption\nQuery: index=windows EventCode=4663 | stats count by ObjectName, SubjectUserName | where count > 1000\nExpected: < 5 high-volume users (known file servers)\nIf found: Investigate user context and file types\n\nSTEP 3: Search for known ransomware IOCs\nQuery: index=av_logs OR index=edr | lookup ransomware_iocs.csv hash, domain, filename\nExpected: 0 matches\nIf found: Isolate affected systems\n\nSTEP 4: Check for lateral movement via RDP/SMB\nQuery: index=windows (EventCode=4624 LogonType=10 OR EventCode=5140)\nExpected: Normal admin activity patterns\nIf found: Validate source/destination pairs\n\nSTEP 5: Document findings\nCreate hunt report with findings, false positives, recommendations\n```\n\n**Benefits of Structured Hunting**:\n- ‚úÖ Consistent coverage\n- ‚úÖ Easy to train new hunters\n- ‚úÖ Measurable time investment\n- ‚úÖ Audit trail for compliance\n\n**Drawbacks**:\n- ‚ùå Limited to playbook scope\n- ‚ùå May miss novel attacks\n- ‚ùå Can become routine/autopilot\n\n### Unstructured Hunting\n\n**Definition**: Open-ended, exploratory investigation driven by **intuition, curiosity, and anomaly discovery**.\n\n**Characteristics**:\n- No predefined playbook\n- Follow where data leads\n- Intuition-driven\n- Variable time investment\n- Creative and adaptive\n\n**Example: Unstructured Hunt Session**\n\n```\n[Hunter's thought process]\n\n\"I'm curious about authentication patterns...\"\n‚Üí Query: index=windows EventCode=4624 | stats count by TargetUserName\n\n\"Hmm, 'svc_backup' account logged in 50,000 times this week. That seems high.\"\n‚Üí Pivot: index=windows User=\"svc_backup\" | stats count by SourceNetworkAddress\n\n\"All logins from 192.168.1.50. Is that a legitimate server?\"\n‚Üí Check: CMDB shows 192.168.1.50 is a decommissioned server!\n\n\"Wait, how is a decommissioned server authenticating with a service account?\"\n‚Üí Investigate: Network logs show 192.168.1.50 is accessing file servers\n\n\"This is an unauthorized system using stolen service account credentials!\"\n‚Üí Escalate: Found rogue device on network\n```\n\n**Benefits of Unstructured Hunting**:\n- ‚úÖ Finds unexpected threats\n- ‚úÖ Exercises hunter creativity\n- ‚úÖ Discovers new attack patterns\n- ‚úÖ Identifies blind spots\n\n**Drawbacks**:\n- ‚ùå Unpredictable time investment\n- ‚ùå Harder to measure success\n- ‚ùå Requires experienced hunters\n- ‚ùå Can be inefficient\n\n### Balancing Both Approaches\n\n**Recommended Hunt Schedule**:\n\n| Frequency | Type | Focus |\n|-----------|------|-------|\n| **Daily** | Structured | IOC sweeps, high-priority playbooks |\n| **Weekly** | Structured | Crown Jewels monitoring, TTP hunts |\n| **Bi-Weekly** | Unstructured | Exploratory anomaly hunting |\n| **Monthly** | Unstructured | Deep-dive investigations |\n\n**Rule of Thumb**:\n- **70% structured**: Ensures consistent coverage\n- **30% unstructured**: Finds novel threats and keeps skills sharp\n\n### Converting Unstructured Findings to Structured Playbooks\n\n**When an unstructured hunt finds something valuable, document it as a structured playbook.**\n\nExample: Unstructured hunt found rogue device via service account anomaly.\n\n**New Playbook**:\n```\n===================================\nROGUE DEVICE DETECTION PLAYBOOK\n===================================\n\nSTEP 1: Identify high-volume service accounts\nQuery: index=windows EventCode=4624 | stats count by TargetUserName | sort -count | head 20\n\nSTEP 2: Check source IPs for anomalies\nQuery: index=windows TargetUserName=\"svc_*\" | stats dc(SourceNetworkAddress) by TargetUserName\n\nSTEP 3: Cross-reference with CMDB\nValidate: Are source IPs legitimate systems?\n\nSTEP 4: Investigate unauthorized sources\nQuery: index=network src_ip=<unauthorized_ip> | stats count by dest_ip, dest_port\n```\n\n**This is how hunt programs mature**: Unstructured discoveries become structured playbooks."
      }
    },
    {
      "type": "real_world",
      "content": {
        "text": "## Real-World Hunt Methodology: Ransomware Playbook\n\n### Background\n\nA **Fortune 500 financial services company** implemented a weekly ransomware hunt playbook after several industry peers were hit by Conti ransomware.\n\n### The Playbook\n\n**Hypothesis**: \"If ransomware operators are preparing an attack, they will:\n1. Disable backups\n2. Establish persistence\n3. Stage data for exfiltration\n4. Spread laterally via RDP/SMB\"\n\n**Hunt Steps**:\n\n**Step 1: Backup Tampering Detection**\n```\nindex=windows (\"vssadmin\" OR \"wbadmin\" OR \"bcdedit\" OR \"wevtutil\")\n| search \"delete\" OR \"clear\" OR \"set\" OR \"disable\"\n| stats count by ComputerName, User, CommandLine\n```\n\n**Step 2: Persistence Mechanisms**\n```\nindex=windows (EventCode=4698 OR EventCode=4699) OR (EventCode=4688 CommandLine=\"*schtasks*\")\n| where TaskName NOT IN (known_scheduled_tasks.csv)\n| stats count by ComputerName, TaskName, TaskContent\n```\n\n**Step 3: Data Staging**\n```\nindex=windows EventCode=4663\n| where ObjectName=\"*\\\\Temp\\\\*\" OR ObjectName=\"*\\\\ProgramData\\\\*\"\n| stats sum(FileSize) as total_size by SubjectUserName, ComputerName\n| where total_size > 10GB\n```\n\n**Step 4: Lateral Movement**\n```\nindex=windows (EventCode=4624 LogonType=10) OR (EventCode=5140 ShareName=\"\\\\\\\\*\\\\C$\")\n| where SourceNetworkAddress NOT IN (admin_workstations.csv)\n| stats count by SourceNetworkAddress, TargetUserName, ComputerName\n```\n\n### The Discovery\n\n**Week 3 of implementing the playbook**:\n\n**Step 1 Alert**: Found `vssadmin delete shadows /all /quiet` executed on 3 servers\n- **Source**: Service account `svc_deploy`\n- **Time**: 2:00 AM (off-hours)\n- **Servers**: File servers in finance department\n\n**Immediate Response**:\n1. Isolated 3 servers from network\n2. Escalated to incident response\n3. Expanded hunt to all systems accessed by `svc_deploy`\n\n**Expanded Investigation**:\n- Found `svc_deploy` credentials compromised via phishing 2 weeks prior\n- Attackers used compromised account to deploy Conti ransomware toolkit\n- **Hunt caught them in the preparation phase** - before encryption started\n\n### Outcome\n\n**Ransomware attack prevented**:\n- No data encrypted\n- No ransom paid\n- Compromised account disabled\n- Attacker infrastructure blocked\n\n**Financial Impact**:\n- Average ransomware attack cost: **$4.5 million** (2023)\n- Cost of hunt program: **$200K/year**\n- **ROI: 22.5x in first year**\n\n**Lesson**: Structured, repeatable hunt playbooks can prevent catastrophic breaches."
      }
    },
    {
      "type": "memory_aid",
      "content": {
        "text": "## Memory Aids for Hunt Methodologies\n\n### CROWN - Crown Jewels Analysis\n\n**C** - **Critical Assets**: Identify what matters most\n**R** - **Risk Assessment**: What's the impact if compromised?\n**O** - **Observe Attack Paths**: Map how attackers reach jewels\n**W** - **Watch Closely**: Prioritize hunts around jewels\n**N** - **Never Assume**: Always validate security\n\n### HILDA - The Hunt Loop\n\n**H** - **Hypothesis**: Form testable assumption\n**I** - **Investigate**: Collect and analyze data\n**L** - **Learn**: Document findings\n**D** - **Detect**: Create automated rules\n**A** - **Again**: Repeat the loop\n\n### TTP - Tactics, Techniques, Procedures\n\n**Tactics**: The \"Why\" (goals like persistence)\n**Techniques**: The \"How\" (methods like scheduled tasks)\n**Procedures**: The \"What\" (specific tools like Mimikatz)\n\n### IVB - Indicator vs Behavior Hunting\n\n**I** - **Indicator-Based**: Hunt for known IOCs (fast, narrow)\n**V** - **Versus**\n**B** - **Behavior-Based**: Hunt for patterns (slow, broad)\n\n**Use Both**: Combine for complete coverage\n\n### SUN - Structured vs Unstructured\n\n**S** - **Structured**: Playbook-driven, repeatable\n**U** - **Unstructured**: Curiosity-driven, exploratory\n**N** - **Need Both**: 70% structured, 30% unstructured\n\n### Visual: Hunt Priority Pyramid\n\n```\n         /\\\n        /  \\\n       / CJ \\ ‚Üê Crown Jewels (Top Priority)\n      /______\\\n     /        \\\n    / Attack  \\ ‚Üê Attack Paths to CJ\n   /  Paths   \\\n  /____________\\\n /              \\\n/   Everything  \\ ‚Üê General Infrastructure\n/    Else       \\\n/______________\\\n```"
      }
    },
    {
      "type": "mindset_coach",
      "content": {
        "text": "## Building Your Hunt Methodology Arsenal\n\n### You're Leveling Up\n\nYou now have **multiple methodologies** in your toolkit:\n- ‚úÖ Crown Jewels Analysis (know what to protect)\n- ‚úÖ TTP-Based Hunting (hunt behaviors, not just indicators)\n- ‚úÖ Indicator vs Behavior hunting (use both)\n- ‚úÖ Hunt Loop (systematic, repeatable process)\n- ‚úÖ Structured & Unstructured hunting (balance both)\n\n**You're not just hunting randomly - you have proven frameworks to guide you.**\n\n### The Hunter's Toolkit\n\n**Think of methodologies as tools in a toolbox**:\n- **Crown Jewels**: Your compass (points to what matters)\n- **TTPs**: Your map (shows adversary behavior patterns)\n- **Hunt Loop**: Your process (ensures consistency)\n- **Structured Hunts**: Your daily routine (steady progress)\n- **Unstructured Hunts**: Your intuition (finds the unexpected)\n\n**Master hunters know which tool to use when.**\n\n### Your Next Steps\n\n**Practice Exercises**:\n\n1. **Crown Jewels Exercise** (30 min):\n   - List your organization's top 5 crown jewels\n   - Map 3 attack paths to reach each jewel\n   - Prioritize which hunts to run first\n\n2. **Build Your First Hunt Playbook** (60 min):\n   - Pick a technique from MITRE ATT&CK (e.g., T1053 - Scheduled Tasks)\n   - Write hypothesis, data sources, queries\n   - Document expected results and false positives\n   - Run the playbook in your environment\n\n3. **Unstructured Hunt Challenge** (60 min):\n   - Pick any data source (Windows Event Logs, NetFlow, etc.)\n   - Start with a simple query (e.g., \"Who logged in today?\")\n   - Follow your curiosity - pivot, expand, investigate\n   - Document what you found (even if it's benign)\n\n### Recommended Resources\n\n**Hunt Playbooks**:\n- **MITRE Cyber Analytics Repository (CAR)**: https://car.mitre.org/\n- **Sigma Rules**: https://github.com/SigmaHQ/sigma\n- **SANS Hunt Evil Poster**: Free hunting cheat sheet\n\n**Real-World Hunt Reports**:\n- **CrowdStrike Blog**: Threat hunting case studies\n- **Red Canary Threat Detection Report**: Annual adversary tactics\n- **Mandiant APT Reports**: Detailed adversary profiles\n\n**Communities**:\n- **ThreatHunting Subreddit**: r/blueteamsec\n- **Threat Hunting Discord**: Join threat hunter communities\n- **SANS Threat Hunting Summit**: Free talks and workshops\n\n### Remember\n\n**Every hunt teaches you something**:\n- Found a threat? You're a hero.\n- Found nothing? You validated your defenses.\n- Found false positives? You improved detection accuracy.\n\n**There are no wasted hunts.**\n\n### You're Ready\n\nYou've mastered the **methodologies** that guide successful threat hunts. Next, we'll dive into **Windows Event Log Analysis** - where you'll learn to read the digital breadcrumbs attackers leave behind.\n\n**Keep hunting. Stay curious. Trust the process.** üéØ"
      }
    }
  ]
}
